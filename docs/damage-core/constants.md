# 损害计算 - 常量定义

> `src/core/damage.ts` 中的常量定义

---

## 📋 概览

| 常量 | 说明 |
|------|------|
| `POPULATION_DENSITY` | 人口密度参考（人/平方公里） |
| `BUILDING_DENSITY` | 建筑密度参考（建筑数/平方公里） |
| `GEOGRAPHIC_SCALES` | 地理尺度参考 |
| `CELESTIAL_DATA` | 天体数据 |

---

## 👥 POPULATION_DENSITY

人口密度参考表，用于估算单步伤亡人数。

### 数据结构

```typescript
export const POPULATION_DENSITY: Record<string, number> = {
  // 场景名: 人口密度（人/平方公里）
};
```

### 户外场景

| 场景 | 密度 (人/km²) | 说明 |
|------|--------------|------|
| 荒野 | 1 | 无人区、沙漠、深山老林 |
| 乡村 | 50 | 农村、小村庄、田野 |
| 郊区 | 500 | 城市边缘居住区 |
| 小城市 | 3,000 | 小型城镇、县城 |
| 中等城市 | 5,000 | 普通地级市 |
| 大城市 | 10,000 | 省会城市、大型城市一般区域 |
| 超大城市中心 | 25,000 | 北上广深、纽约曼哈顿核心区 |
| 东京市中心 | 15,000 | 东京都心等极高密度区域 |
| 香港 | 27,000 | 香港般的超高密度城市 |
| 马尼拉 | 43,000 | 世界上人口最密集的城市区域之一 |

### 室内场景

室内场景的密度单位转换说明：
- 表中数值是 **人/平方公里**
- 实际含义是 **人/平方米 × 1,000,000**

| 场景 | 密度 (人/km²) | 实际密度 (人/m²) | 说明 |
|------|--------------|-----------------|------|
| 住宅内 | 40,000 | 0.04 | 约 100 平米住宅 4 人 |
| 公寓楼内 | 80,000 | 0.08 | 密集住宅、学生宿舍 |
| 办公楼内 | 100,000 | 0.1 | 工作时间的办公室 |
| 体育馆内 | 500,000 | 0.5 | 演唱会、体育比赛等密集场合 |

### 特殊场景

| 场景 | 密度 | 说明 |
|------|------|------|
| 巨大娘体内 | 0 | 体内探索场景，不计算外部伤亡 |

### 使用示例

```typescript
import { POPULATION_DENSITY } from '@/core';

// 获取场景密度
const density = POPULATION_DENSITY['大城市']; // 10000

// 计算单步伤亡（简化示例）
const footprintKm2 = 0.01; // 足迹面积（平方公里）
const casualties = footprintKm2 * density; // 100 人
```

---

## 🏢 BUILDING_DENSITY

建筑密度参考表，用于估算建筑损毁数量。

### 户外场景

| 场景 | 密度 (栋/km²) | 说明 |
|------|--------------|------|
| 荒野 | 0 | 无建筑 |
| 乡村 | 20 | 稀疏民房 |
| 郊区 | 200 | 低密度住宅区 |
| 小城市 | 500 | 小型城镇 |
| 中等城市 | 800 | 普通城市 |
| 大城市 | 1,200 | 大型城市 |
| 超大城市中心 | 2,000 | 高层建筑密集区 |

### 室内场景

所有室内场景的建筑密度都是 **0**，因为角色已经在建筑内部，不计算建筑损毁。

| 场景 | 密度 |
|------|------|
| 住宅内 | 0 |
| 公寓楼内 | 0 |
| 办公楼内 | 0 |
| 体育馆内 | 0 |
| 巨大娘体内 | 0 |

---

## 🗺️ GEOGRAPHIC_SCALES

地理尺度参考表，用于描述宏观破坏范围。

### 数据结构

```typescript
export const GEOGRAPHIC_SCALES: Record<string, {
  size: number;        // 面积（平方公里）
  description: string; // 描述
}> = { ... };
```

### 街道级别

| 名称 | 面积 (km²) | 描述 |
|------|-----------|------|
| 街道 | 0.01 | 一条普通街道 |
| 街区 | 0.05 | 一个居民街区 |

### 城区级别

| 名称 | 面积 (km²) | 描述 |
|------|-----------|------|
| 小型城区 | 1 | 约 1 平方公里的城区 |
| 中型城区 | 5 | 约 5 平方公里的城区 |
| 大型城区 | 20 | 约 20 平方公里的城区 |

### 城市级别

| 名称 | 面积 (km²) | 描述 |
|------|-----------|------|
| 小城市 | 50 | 小型城市 |
| 中等城市 | 200 | 中等城市 |
| 大城市 | 600 | 大型城市 |
| 超大城市 | 2,000 | 超大城市（如东京都市圈） |

### 国家级别

| 名称 | 面积 (km²) | 描述 |
|------|-----------|------|
| 小国 | 1,000 | 小型国家 |
| 中等国家 | 100,000 | 中等国家 |
| 大国 | 1,000,000 | 大型国家 |

### 大陆级别

| 名称 | 面积 (km²) | 描述 |
|------|-----------|------|
| 小型大陆 | 10,000,000 | 如澳大利亚 |
| 大型大陆 | 50,000,000 | 如亚欧大陆 |

### 星球级别

| 名称 | 面积 (km²) | 描述 |
|------|-----------|------|
| 地球表面积 | 510,000,000 | 地球总表面积 |
| 地球陆地 | 150,000,000 | 地球陆地面积 |

---

## 🌌 CELESTIAL_DATA

天体数据，用于宏观破坏力计算。

### 数据结构

```typescript
export const CELESTIAL_DATA = {
  地球: {
    直径: number;      // 米
    人口: number;      // 人
    城市数量: number;  // 个
  },
  太阳系: {
    行星数量: number;
    矮行星数量: number;
    卫星数量: number;
  },
  银河系: {
    直径: number;       // 米
    恒星数量: number;
    行星估计: number;
  },
  可观测宇宙: {
    直径: number;       // 米
    星系数量: number;
  },
};
```

### 地球

| 属性 | 值 | 说明 |
|------|-----|------|
| 直径 | 12,742,000 米 | 地球直径 |
| 人口 | 8,000,000,000 | 80 亿人 |
| 城市数量 | 10,000 | 约 1 万座城市 |

### 太阳系

| 属性 | 值 |
|------|-----|
| 行星数量 | 8 |
| 矮行星数量 | 5 |
| 卫星数量 | 200 |

### 银河系

| 属性 | 值 | 说明 |
|------|-----|------|
| 直径 | 约 10 万光年 | 9.461e20 米 |
| 恒星数量 | 2,000 亿 | 2e11 |
| 行星估计 | 1,000 亿 | 1e11 |

### 可观测宇宙

| 属性 | 值 | 说明 |
|------|-----|------|
| 直径 | 约 930 亿光年 | 8.8e26 米 |
| 星系数量 | 2 万亿 | 2e12 |

### 使用示例

```typescript
import { CELESTIAL_DATA, REFERENCE_OBJECTS } from '@/core';

// 判断是否达到行星级破坏
const height = 1e8; // 1 亿米
if (height >= REFERENCE_OBJECTS.地球直径 * 0.1) {
  console.log('达到行星级破坏力');
}

// 估算可毁灭的恒星数量
const galaxyDiameter = CELESTIAL_DATA.银河系.直径;
const ratio = height / galaxyDiameter;
const starsAffected = CELESTIAL_DATA.银河系.恒星数量 * Math.pow(ratio, 3);
```

---

## 💡 场景选择指南

### 根据剧情选择场景

| 剧情场景 | 推荐场景设置 |
|----------|-------------|
| 荒郊野外、无人区 | 荒野 |
| 农村、田野 | 乡村 |
| 住宅区边缘 | 郊区 |
| 小镇、县城 | 小城市 |
| 普通城市 | 中等城市 |
| 省会、直辖市 | 大城市 |
| 纽约、东京市中心 | 超大城市中心 |
| 香港、澳门 | 香港 |
| 家中、室内 | 住宅内 |
| 办公室、写字楼 | 办公楼内 |
| 演唱会、体育场 | 体育馆内 |
| 被吞入体内 | 巨大娘体内 |

### LLM 自动设置

可以让 LLM 在剧情中自动设置场景：

```javascript
// 角色来到不同地点时自动更新
_.set('巨大娘._场景.当前场景', '大城市');
_.set('巨大娘._场景.场景原因', '络络来到了东京市中心');
```
