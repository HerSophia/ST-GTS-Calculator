import'https://testingcf.jsdelivr.net/gh/MagicalAstrogy/MagVarUpdate@beta/artifact/bundle.js';import{createPinia as e,defineStore as n,storeToRefs as a}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';import{klona as t}from'https://testingcf.jsdelivr.net/npm/klona/+esm';var i={9(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-worldview-content[data-v-3554c17a]{display:flex;flex-direction:column;gap:16px}.gc-worldview-selector[data-v-3554c17a]{margin-bottom:8px}.gc-worldview-current[data-v-3554c17a]{padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;margin-bottom:12px}.gc-worldview-current-info[data-v-3554c17a]{display:flex;align-items:center;gap:12px}.gc-worldview-icon[data-v-3554c17a]{font-size:1.5em;width:40px;height:40px;display:flex;align-items:center;justify-content:center;background:rgba(244,114,182,0.2);border-radius:8px;color:var(--gc-primary,#f472b6)}.gc-worldview-name[data-v-3554c17a]{font-weight:600;font-size:0.95em;margin-bottom:2px}.gc-worldview-desc[data-v-3554c17a]{font-size:0.8em;color:var(--gc-text-muted,#94a3b8)}.gc-worldview-list[data-v-3554c17a]{display:flex;flex-direction:column;gap:6px;max-height:180px;overflow-y:auto}.gc-worldview-item[data-v-3554c17a]{display:flex;align-items:center;gap:10px;padding:8px 12px;background:rgba(0,0,0,0.15);border-radius:6px;cursor:pointer;transition:all 0.2s}.gc-worldview-item[data-v-3554c17a]:hover{background:rgba(0,0,0,0.25)}.gc-worldview-item.active[data-v-3554c17a]{background:rgba(244,114,182,0.15);border:1px solid rgba(244,114,182,0.3)}.gc-worldview-item-icon[data-v-3554c17a]{font-size:1.1em;width:28px;text-align:center;color:var(--gc-text-muted,#94a3b8)}.gc-worldview-item.active .gc-worldview-item-icon[data-v-3554c17a]{color:var(--gc-primary,#f472b6)}.gc-worldview-item-info[data-v-3554c17a]{flex:1;display:flex;align-items:center;gap:8px}.gc-worldview-item-name[data-v-3554c17a]{font-size:0.9em}.gc-worldview-check[data-v-3554c17a]{color:var(--gc-primary,#f472b6);font-size:0.9em}.gc-worldview-details[data-v-3554c17a]{display:flex;flex-direction:column;gap:12px}.gc-worldview-section[data-v-3554c17a]{padding:10px;background:rgba(0,0,0,0.1);border-radius:6px}.gc-worldview-section h4[data-v-3554c17a]{display:flex;align-items:center;gap:8px;font-size:0.85em;font-weight:600;margin-bottom:8px;color:var(--gc-text,#f1f5f9)}.gc-worldview-section h4 i[data-v-3554c17a]{color:var(--gc-primary,#f472b6)}.gc-worldview-text[data-v-3554c17a]{font-size:0.85em;color:var(--gc-text-muted,#94a3b8);line-height:1.5}.gc-worldview-list-items[data-v-3554c17a]{margin:0;padding-left:20px;font-size:0.85em;color:var(--gc-text-muted,#94a3b8)}.gc-worldview-list-items li[data-v-3554c17a]{margin-bottom:4px}.gc-worldview-options[data-v-3554c17a]{border-top:1px dashed var(--gc-border,rgba(255,255,255,0.1));padding-top:12px}.gc-setting-toggle[data-v-3554c17a]{display:flex;justify-content:space-between;align-items:flex-start;padding:8px 0;border-bottom:1px solid var(--gc-border,rgba(255,255,255,0.1))}.gc-setting-toggle[data-v-3554c17a]:last-child{border-bottom:none}.gc-setting-toggle label[data-v-3554c17a]{display:flex;flex-direction:column;gap:2px}.gc-setting-toggle label span[data-v-3554c17a]{font-size:0.85em;font-weight:500}.gc-setting-toggle label small[data-v-3554c17a]{font-size:0.75em;color:var(--gc-text-muted,#94a3b8)}.gc-worldview-actions[data-v-3554c17a]{display:flex;gap:8px;margin-top:8px}.gc-worldview-editor[data-v-3554c17a]{display:flex;flex-direction:column;gap:12px}.gc-editor-header[data-v-3554c17a]{display:flex;align-items:center;gap:12px}.gc-editor-title[data-v-3554c17a]{font-weight:600;font-size:0.95em}.gc-editor-form[data-v-3554c17a]{display:flex;flex-direction:column;gap:12px}.gc-setting-item[data-v-3554c17a]{display:flex;flex-direction:column;gap:6px}.gc-setting-item label[data-v-3554c17a]{font-size:0.85em;color:var(--gc-text-muted,#94a3b8);font-weight:500}.gc-input[data-v-3554c17a]{padding:8px 10px;background:rgba(0,0,0,0.2);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:6px;color:var(--gc-text,#f1f5f9);font-size:0.9em}.gc-input[data-v-3554c17a]:focus{outline:none;border-color:var(--gc-primary,#f472b6)}.gc-textarea[data-v-3554c17a]{padding:8px 10px;background:rgba(0,0,0,0.2);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:6px;color:var(--gc-text,#f1f5f9);font-size:0.9em;resize:vertical}.gc-textarea[data-v-3554c17a]:focus{outline:none;border-color:var(--gc-primary,#f472b6)}.gc-editor-actions[data-v-3554c17a]{display:flex;gap:8px;justify-content:flex-end;margin-top:8px}.gc-add-template-btn[data-v-3554c17a]{margin-top:8px}.gc-btn-link[data-v-3554c17a]{background:transparent;border:none;color:var(--gc-text-muted,#94a3b8);cursor:pointer;padding:4px 8px;font-size:0.9em;display:flex;align-items:center;gap:6px}.gc-btn-link[data-v-3554c17a]:hover{color:var(--gc-text,#f1f5f9)}\n','',{version:3,sources:['webpack://./src/ui/panels/WorldviewPanel.vue'],names:[],mappings:'AAiRA,uCACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,wCACE,iBACF,CAEA,uCACE,YAAa,CACb,0BAA8B,CAC9B,iBAAkB,CAClB,kBACF,CAEA,4CACE,YAAa,CACb,kBAAmB,CACnB,QACF,CAEA,oCACE,eAAgB,CAChB,UAAW,CACX,WAAY,CACZ,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,gCAAoC,CACpC,iBAAkB,CAClB,+BACF,CAEA,oCACE,eAAgB,CAChB,gBAAiB,CACjB,iBACF,CAEA,oCACE,eAAgB,CAChB,kCACF,CAEA,oCACE,YAAa,CACb,qBAAsB,CACtB,OAAQ,CACR,gBAAiB,CACjB,eACF,CAEA,oCACE,YAAa,CACb,kBAAmB,CACnB,QAAS,CACT,gBAAiB,CACjB,2BAA+B,CAC/B,iBAAkB,CAClB,cAAe,CACf,mBACF,CAEA,0CACE,2BACF,CAEA,2CACE,iCAAqC,CACrC,sCACF,CAEA,yCACE,eAAgB,CAChB,UAAW,CACX,iBAAkB,CAClB,kCACF,CAEA,mEACE,+BACF,CAEA,yCACE,MAAO,CACP,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,yCACE,eACF,CAEA,qCACE,+BAAiC,CACjC,eACF,CAEA,uCACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,uCACE,YAAa,CACb,0BAA8B,CAC9B,iBACF,CAEA,0CACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,gBAAiB,CACjB,eAAgB,CAChB,iBAAkB,CAClB,4BACF,CAEA,4CACE,+BACF,CAEA,oCACE,gBAAiB,CACjB,kCAAoC,CACpC,eACF,CAEA,0CACE,QAAS,CACT,iBAAkB,CAClB,gBAAiB,CACjB,kCACF,CAEA,6CACE,iBACF,CAEA,uCACE,4DAAiE,CACjE,gBACF,CAEA,oCACE,YAAa,CACb,6BAA8B,CAC9B,sBAAuB,CACvB,aAAc,CACd,8DACF,CAEA,+CACE,kBACF,CAEA,0CACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,+CACE,gBAAiB,CACjB,eACF,CAEA,gDACE,gBAAiB,CACjB,kCACF,CAEA,uCACE,YAAa,CACb,OAAQ,CACR,cACF,CAEA,sCACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,mCACE,YAAa,CACb,kBAAmB,CACnB,QACF,CAEA,kCACE,eAAgB,CAChB,gBACF,CAEA,iCACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,kCACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,wCACE,gBAAiB,CACjB,kCAAoC,CACpC,eACF,CAEA,2BACE,gBAAiB,CACjB,0BAA8B,CAC9B,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,eACF,CAEA,iCACE,YAAa,CACb,sCACF,CAEA,8BACE,gBAAiB,CACjB,0BAA8B,CAC9B,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,eAAgB,CAChB,eACF,CAEA,oCACE,YAAa,CACb,sCACF,CAEA,oCACE,YAAa,CACb,OAAQ,CACR,wBAAyB,CACzB,cACF,CAEA,sCACE,cACF,CAEA,8BACE,sBAAuB,CACvB,WAAY,CACZ,kCAAoC,CACpC,cAAe,CACf,eAAgB,CAChB,eAAgB,CAChB,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,oCACE,4BACF',sourcesContent:['<template>\n  <GcOverlay\n    :visible="visible"\n    :title="\'世界观设定\'"\n    :icon="currentWorldview?.icon || \'fa-solid fa-globe\'"\n    panel-class="gc-worldview-panel"\n    @close="handleClose"\n  >\n    <template #header-actions>\n      <button class="gc-btn-link" @click="$emit(\'reset\')" title="重置为默认">\n        <i class="fa-solid fa-rotate-left"></i>\n      </button>\n    </template>\n\n    <div class="gc-worldview-content">\n      \x3c!-- 当前世界观选择 --\x3e\n      <div class="gc-worldview-selector">\n        <div class="gc-worldview-current">\n          <div class="gc-worldview-current-info">\n            <i :class="currentWorldview?.icon" class="gc-worldview-icon"></i>\n            <div>\n              <div class="gc-worldview-name">{{ currentWorldview?.name }}</div>\n              <div class="gc-worldview-desc">{{ currentWorldview?.description }}</div>\n            </div>\n          </div>\n        </div>\n        \n        \x3c!-- 世界观快速切换列表 --\x3e\n        <div class="gc-worldview-list">\n          <div \n            v-for="wv in worldviews" \n            :key="wv.id"\n            class="gc-worldview-item"\n            :class="{ active: wv.id === currentWorldviewId, builtin: wv.builtin }"\n            @click="$emit(\'select\', wv.id)"\n          >\n            <i :class="wv.icon" class="gc-worldview-item-icon"></i>\n            <div class="gc-worldview-item-info">\n              <span class="gc-worldview-item-name">{{ wv.name }}</span>\n              <GcBadge v-if="!wv.builtin" variant="custom" size="sm">自定义</GcBadge>\n            </div>\n            <i v-if="wv.id === currentWorldviewId" class="fa-solid fa-check gc-worldview-check"></i>\n          </div>\n        </div>\n      </div>\n      \n      \x3c!-- 当前世界观详情 --\x3e\n      <div v-if="!isEditing" class="gc-worldview-details">\n        <div class="gc-worldview-section">\n          <h4><i class="fa-solid fa-gears"></i> 变化机制</h4>\n          <div class="gc-worldview-text">{{ currentWorldview?.mechanism }}</div>\n        </div>\n        \n        <div class="gc-worldview-section">\n          <h4><i class="fa-solid fa-person"></i> 身体特性</h4>\n          <div class="gc-worldview-text">{{ currentWorldview?.bodyCharacteristics }}</div>\n        </div>\n        \n        <div v-if="hasLimitations" class="gc-worldview-section">\n          <h4><i class="fa-solid fa-triangle-exclamation"></i> 限制与代价</h4>\n          <ul class="gc-worldview-list-items">\n            <li v-for="(item, i) in currentWorldview?.limitations" :key="i">{{ item }}</li>\n          </ul>\n        </div>\n        \n        <div v-if="currentWorldview?.specialRules?.length" class="gc-worldview-section">\n          <h4><i class="fa-solid fa-star"></i> 特殊规则</h4>\n          <ul class="gc-worldview-list-items">\n            <li v-for="(item, i) in currentWorldview?.specialRules" :key="i">{{ item }}</li>\n          </ul>\n        </div>\n        \n        <div v-if="currentWorldview?.writingTips?.length" class="gc-worldview-section">\n          <h4><i class="fa-solid fa-pen-fancy"></i> 写作建议</h4>\n          <ul class="gc-worldview-list-items">\n            <li v-for="(item, i) in currentWorldview?.writingTips" :key="i">{{ item }}</li>\n          </ul>\n        </div>\n        \n        \x3c!-- 世界观设置选项 --\x3e\n        <div class="gc-worldview-section gc-worldview-options">\n          <h4><i class="fa-solid fa-sliders"></i> 世界观选项</h4>\n          <div class="gc-setting-toggle">\n            <label>\n              <span>注入世界观提示词</span>\n              <small>将世界观设定注入到 AI 提示词中</small>\n            </label>\n            <GcSwitch\n              :model-value="settings.injectWorldviewPrompt"\n              @update:model-value="$emit(\'update:setting\', \'injectWorldviewPrompt\', $event)"\n            />\n          </div>\n          <div class="gc-setting-toggle">\n            <label>\n              <span>允许身体部位独立变化</span>\n              <small>特定部位可以有不同的缩放倍率</small>\n            </label>\n            <GcSwitch\n              :model-value="settings.allowPartialScaling"\n              @update:model-value="$emit(\'update:setting\', \'allowPartialScaling\', $event)"\n            />\n          </div>\n        </div>\n        \n        <div v-if="!currentWorldview?.builtin" class="gc-worldview-actions">\n          <GcButton @click="startEdit"><i class="fa-solid fa-pen"></i> 编辑</GcButton>\n          <GcButton variant="danger" @click="$emit(\'delete\', currentWorldview?.id, currentWorldview?.name)">\n            <i class="fa-solid fa-trash"></i> 删除\n          </GcButton>\n        </div>\n      </div>\n      \n      \x3c!-- 编辑世界观 --\x3e\n      <div v-else class="gc-worldview-editor">\n        <div class="gc-editor-header">\n          <button class="gc-btn-link" @click="cancelEdit">\n            <i class="fa-solid fa-arrow-left"></i> 返回\n          </button>\n          <span class="gc-editor-title">{{ editingData ? \'编辑世界观\' : \'新建世界观\' }}</span>\n        </div>\n        <div class="gc-editor-form">\n          <div class="gc-setting-item">\n            <label>名称 *</label>\n            <input v-model="form.name" type="text" class="gc-input" placeholder="世界观名称" />\n          </div>\n          <div class="gc-setting-item">\n            <label>图标 (Font Awesome class)</label>\n            <input v-model="form.icon" type="text" class="gc-input" placeholder="fa-solid fa-atom" />\n          </div>\n          <div class="gc-setting-item">\n            <label>描述</label>\n            <input v-model="form.description" type="text" class="gc-input" placeholder="简短描述" />\n          </div>\n          <div class="gc-setting-item">\n            <label>变化机制</label>\n            <textarea v-model="form.mechanism" class="gc-textarea" rows="4" placeholder="描述体型变化的机制..."></textarea>\n          </div>\n          <div class="gc-setting-item">\n            <label>身体特性</label>\n            <textarea v-model="form.bodyCharacteristics" class="gc-textarea" rows="4" placeholder="描述变化后的身体特征..."></textarea>\n          </div>\n          <div class="gc-editor-actions">\n            <GcButton @click="cancelEdit">取消</GcButton>\n            <GcButton variant="primary" @click="saveWorldview">\n              <i class="fa-solid fa-save"></i> 保存\n            </GcButton>\n          </div>\n        </div>\n      </div>\n      \n      \x3c!-- 新建世界观按钮 --\x3e\n      <GcButton v-if="!isEditing" class="gc-add-template-btn" @click="startCreate">\n        <i class="fa-solid fa-plus"></i> 新建自定义世界观\n      </GcButton>\n    </div>\n  </GcOverlay>\n</template>\n\n<script setup lang="ts">\nimport { ref, computed } from \'vue\';\nimport { GcOverlay, GcSwitch, GcButton, GcBadge } from \'../components\';\nimport type { Worldview } from \'../../types\';\nimport type { Settings } from \'../../types\';\n\nconst props = defineProps<{\n  visible: boolean;\n  worldviews: Worldview[];\n  currentWorldviewId: string;\n  currentWorldview: Worldview | undefined;\n  settings: Settings;\n}>();\n\nconst emit = defineEmits<{\n  (e: \'close\'): void;\n  (e: \'reset\'): void;\n  (e: \'select\', id: string): void;\n  (e: \'create\', wv: Omit<Worldview, \'id\' | \'builtin\'>): void;\n  (e: \'update\', id: string, wv: Partial<Worldview>): void;\n  (e: \'delete\', id: string | undefined, name: string | undefined): void;\n  (e: \'update:setting\', key: keyof Settings, value: unknown): void;\n}>();\n\n// 内部状态\nconst isEditing = ref(false);\nconst editingData = ref<Worldview | null>(null);\nconst form = ref({\n  name: \'\',\n  icon: \'fa-solid fa-star\',\n  description: \'\',\n  mechanism: \'\',\n  bodyCharacteristics: \'\',\n  limitations: [] as string[],\n  specialRules: [] as string[],\n  writingTips: [] as string[],\n});\n\nconst hasLimitations = computed(() => {\n  const lim = props.currentWorldview?.limitations;\n  return lim && lim.length > 0 && lim[0] !== \'无\';\n});\n\nconst startCreate = () => {\n  editingData.value = null;\n  form.value = {\n    name: \'\',\n    icon: \'fa-solid fa-star\',\n    description: \'\',\n    mechanism: \'\',\n    bodyCharacteristics: \'\',\n    limitations: [],\n    specialRules: [],\n    writingTips: [],\n  };\n  isEditing.value = true;\n};\n\nconst startEdit = () => {\n  if (!props.currentWorldview) return;\n  editingData.value = props.currentWorldview;\n  form.value = {\n    name: props.currentWorldview.name,\n    icon: props.currentWorldview.icon,\n    description: props.currentWorldview.description,\n    mechanism: props.currentWorldview.mechanism,\n    bodyCharacteristics: props.currentWorldview.bodyCharacteristics,\n    limitations: [...props.currentWorldview.limitations],\n    specialRules: [...props.currentWorldview.specialRules],\n    writingTips: [...props.currentWorldview.writingTips],\n  };\n  isEditing.value = true;\n};\n\nconst cancelEdit = () => {\n  isEditing.value = false;\n  editingData.value = null;\n};\n\nconst saveWorldview = () => {\n  if (!form.value.name.trim()) {\n    toastr.warning(\'请输入世界观名称\');\n    return;\n  }\n  \n  const worldviewData = {\n    name: form.value.name.trim(),\n    icon: form.value.icon.trim() || \'fa-solid fa-star\',\n    description: form.value.description.trim(),\n    mechanism: form.value.mechanism.trim(),\n    bodyCharacteristics: form.value.bodyCharacteristics.trim(),\n    limitations: form.value.limitations.filter(s => s.trim()),\n    specialRules: form.value.specialRules.filter(s => s.trim()),\n    writingTips: form.value.writingTips.filter(s => s.trim()),\n  };\n  \n  if (editingData.value) {\n    emit(\'update\', editingData.value.id, worldviewData);\n  } else {\n    emit(\'create\', worldviewData);\n  }\n  \n  isEditing.value = false;\n  editingData.value = null;\n};\n\nconst handleClose = () => {\n  if (isEditing.value) {\n    cancelEdit();\n  }\n  emit(\'close\');\n};\n<\/script>\n\n<style scoped>\n.gc-worldview-content {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.gc-worldview-selector {\n  margin-bottom: 8px;\n}\n\n.gc-worldview-current {\n  padding: 12px;\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  margin-bottom: 12px;\n}\n\n.gc-worldview-current-info {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.gc-worldview-icon {\n  font-size: 1.5em;\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(244, 114, 182, 0.2);\n  border-radius: 8px;\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-worldview-name {\n  font-weight: 600;\n  font-size: 0.95em;\n  margin-bottom: 2px;\n}\n\n.gc-worldview-desc {\n  font-size: 0.8em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-worldview-list {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  max-height: 180px;\n  overflow-y: auto;\n}\n\n.gc-worldview-item {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 8px 12px;\n  background: rgba(0, 0, 0, 0.15);\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.gc-worldview-item:hover {\n  background: rgba(0, 0, 0, 0.25);\n}\n\n.gc-worldview-item.active {\n  background: rgba(244, 114, 182, 0.15);\n  border: 1px solid rgba(244, 114, 182, 0.3);\n}\n\n.gc-worldview-item-icon {\n  font-size: 1.1em;\n  width: 28px;\n  text-align: center;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-worldview-item.active .gc-worldview-item-icon {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-worldview-item-info {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.gc-worldview-item-name {\n  font-size: 0.9em;\n}\n\n.gc-worldview-check {\n  color: var(--gc-primary, #f472b6);\n  font-size: 0.9em;\n}\n\n.gc-worldview-details {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.gc-worldview-section {\n  padding: 10px;\n  background: rgba(0, 0, 0, 0.1);\n  border-radius: 6px;\n}\n\n.gc-worldview-section h4 {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.85em;\n  font-weight: 600;\n  margin-bottom: 8px;\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-worldview-section h4 i {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-worldview-text {\n  font-size: 0.85em;\n  color: var(--gc-text-muted, #94a3b8);\n  line-height: 1.5;\n}\n\n.gc-worldview-list-items {\n  margin: 0;\n  padding-left: 20px;\n  font-size: 0.85em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-worldview-list-items li {\n  margin-bottom: 4px;\n}\n\n.gc-worldview-options {\n  border-top: 1px dashed var(--gc-border, rgba(255, 255, 255, 0.1));\n  padding-top: 12px;\n}\n\n.gc-setting-toggle {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  padding: 8px 0;\n  border-bottom: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n}\n\n.gc-setting-toggle:last-child {\n  border-bottom: none;\n}\n\n.gc-setting-toggle label {\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n}\n\n.gc-setting-toggle label span {\n  font-size: 0.85em;\n  font-weight: 500;\n}\n\n.gc-setting-toggle label small {\n  font-size: 0.75em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-worldview-actions {\n  display: flex;\n  gap: 8px;\n  margin-top: 8px;\n}\n\n.gc-worldview-editor {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.gc-editor-header {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.gc-editor-title {\n  font-weight: 600;\n  font-size: 0.95em;\n}\n\n.gc-editor-form {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.gc-setting-item {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.gc-setting-item label {\n  font-size: 0.85em;\n  color: var(--gc-text-muted, #94a3b8);\n  font-weight: 500;\n}\n\n.gc-input {\n  padding: 8px 10px;\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 6px;\n  color: var(--gc-text, #f1f5f9);\n  font-size: 0.9em;\n}\n\n.gc-input:focus {\n  outline: none;\n  border-color: var(--gc-primary, #f472b6);\n}\n\n.gc-textarea {\n  padding: 8px 10px;\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 6px;\n  color: var(--gc-text, #f1f5f9);\n  font-size: 0.9em;\n  resize: vertical;\n}\n\n.gc-textarea:focus {\n  outline: none;\n  border-color: var(--gc-primary, #f472b6);\n}\n\n.gc-editor-actions {\n  display: flex;\n  gap: 8px;\n  justify-content: flex-end;\n  margin-top: 8px;\n}\n\n.gc-add-template-btn {\n  margin-top: 8px;\n}\n\n.gc-btn-link {\n  background: transparent;\n  border: none;\n  color: var(--gc-text-muted, #94a3b8);\n  cursor: pointer;\n  padding: 4px 8px;\n  font-size: 0.9em;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.gc-btn-link:hover {\n  color: var(--gc-text, #f1f5f9);\n}\n</style>\n'],sourceRoot:''}]);const s=o},18(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-badge[data-v-8712d0e8]{display:inline-flex;align-items:center;padding:2px 8px;font-size:0.75em;font-weight:500;border-radius:4px;background:rgba(255,255,255,0.1);color:var(--gc-text-muted,#94a3b8)}.gc-badge.primary[data-v-8712d0e8]{background:rgba(244,114,182,0.2);color:#f472b6}.gc-badge.success[data-v-8712d0e8]{background:rgba(52,211,153,0.2);color:#34d399}.gc-badge.warning[data-v-8712d0e8]{background:rgba(251,191,36,0.2);color:#fbbf24}.gc-badge.danger[data-v-8712d0e8]{background:rgba(239,68,68,0.2);color:#f87171}.gc-badge.muted[data-v-8712d0e8]{background:rgba(148,163,184,0.2);color:#94a3b8}.gc-badge.giant[data-v-8712d0e8]{background:rgba(244,114,182,0.2);color:#f472b6}.gc-badge.tiny[data-v-8712d0e8]{background:rgba(59,130,246,0.2);color:#60a5fa}.gc-badge.custom[data-v-8712d0e8]{background:rgba(168,85,247,0.2);color:#a855f7}.gc-badge.sm[data-v-8712d0e8]{padding:1px 6px;font-size:0.7em}\n','',{version:3,sources:['webpack://./src/ui/components/GcBadge.vue'],names:[],mappings:'AAcA,2BACE,mBAAoB,CACpB,kBAAmB,CACnB,eAAgB,CAChB,gBAAiB,CACjB,eAAgB,CAChB,iBAAkB,CAClB,gCAAoC,CACpC,kCACF,CAEA,mCACE,gCAAoC,CACpC,aACF,CAEA,mCACE,+BAAmC,CACnC,aACF,CAEA,mCACE,+BAAmC,CACnC,aACF,CAEA,kCACE,8BAAkC,CAClC,aACF,CAEA,iCACE,gCAAoC,CACpC,aACF,CAEA,iCACE,gCAAoC,CACpC,aACF,CAEA,gCACE,+BAAmC,CACnC,aACF,CAEA,kCACE,+BAAmC,CACnC,aACF,CAEA,8BACE,eAAgB,CAChB,eACF',sourcesContent:['<template>\n  <span class="gc-badge" :class="[variant, size]">\n    <slot></slot>\n  </span>\n</template>\n\n<script setup lang="ts">\ndefineProps<{\n  variant?: \'primary\' | \'success\' | \'warning\' | \'danger\' | \'muted\' | \'giant\' | \'tiny\' | \'custom\';\n  size?: \'sm\' | \'md\';\n}>();\n<\/script>\n\n<style scoped>\n.gc-badge {\n  display: inline-flex;\n  align-items: center;\n  padding: 2px 8px;\n  font-size: 0.75em;\n  font-weight: 500;\n  border-radius: 4px;\n  background: rgba(255, 255, 255, 0.1);\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-badge.primary {\n  background: rgba(244, 114, 182, 0.2);\n  color: #f472b6;\n}\n\n.gc-badge.success {\n  background: rgba(52, 211, 153, 0.2);\n  color: #34d399;\n}\n\n.gc-badge.warning {\n  background: rgba(251, 191, 36, 0.2);\n  color: #fbbf24;\n}\n\n.gc-badge.danger {\n  background: rgba(239, 68, 68, 0.2);\n  color: #f87171;\n}\n\n.gc-badge.muted {\n  background: rgba(148, 163, 184, 0.2);\n  color: #94a3b8;\n}\n\n.gc-badge.giant {\n  background: rgba(244, 114, 182, 0.2);\n  color: #f472b6;\n}\n\n.gc-badge.tiny {\n  background: rgba(59, 130, 246, 0.2);\n  color: #60a5fa;\n}\n\n.gc-badge.custom {\n  background: rgba(168, 85, 247, 0.2);\n  color: #a855f7;\n}\n\n.gc-badge.sm {\n  padding: 1px 6px;\n  font-size: 0.7em;\n}\n</style>\n'],sourceRoot:''}]);const s=o},42(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-extensions[data-v-4e3af112]{margin-top:16px}.gc-section-header[data-v-4e3af112]{display:flex;align-items:center;justify-content:space-between;padding:8px 0;font-size:0.9em;font-weight:600;margin-bottom:4px;color:var(--gc-text-muted,#94a3b8);cursor:pointer;-webkit-user-select:none;user-select:none;transition:color 0.2s}.gc-section-header[data-v-4e3af112]:hover{color:var(--gc-text,#f1f5f9)}.gc-section-header.clickable:hover .gc-header-left[data-v-4e3af112]{color:var(--gc-primary,#f472b6)}.gc-header-left[data-v-4e3af112]{display:flex;align-items:center;gap:8px;transition:color 0.2s}.gc-chevron[data-v-4e3af112]{font-size:0.8em;opacity:0.7;transition:transform 0.2s}.gc-section-header i[data-v-4e3af112]{color:var(--gc-primary,#f472b6)}.gc-extension-list[data-v-4e3af112]{display:flex;flex-direction:column;gap:8px}.gc-extension-item[data-v-4e3af112]{display:flex;align-items:center;gap:12px;padding:10px 12px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px solid transparent;transition:all 0.2s}.gc-extension-item[data-v-4e3af112]:hover{background:rgba(0,0,0,0.3)}.gc-extension-item.clickable[data-v-4e3af112]{cursor:pointer}.gc-extension-item.core[data-v-4e3af112]{border-color:rgba(52,211,153,0.2)}.gc-extension-item.active[data-v-4e3af112]{border-color:rgba(244,114,182,0.3)}.gc-extension-icon[data-v-4e3af112]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.05);border-radius:8px;color:var(--gc-text-muted,#94a3b8)}.gc-extension-item.core .gc-extension-icon[data-v-4e3af112]{background:rgba(52,211,153,0.1);color:#34d399}.gc-extension-icon.damage[data-v-4e3af112]{background:rgba(239,68,68,0.1);color:#f87171}.gc-extension-item.active .gc-extension-icon.damage[data-v-4e3af112]{color:#ef4444}.gc-extension-info[data-v-4e3af112]{flex:1;min-width:0}.gc-extension-name[data-v-4e3af112]{display:flex;align-items:center;gap:6px;font-weight:500;font-size:0.9em;margin-bottom:2px}.gc-extension-desc[data-v-4e3af112]{font-size:0.8em;color:var(--gc-text-muted,#94a3b8)}.gc-extension-toggle[data-v-4e3af112]{flex-shrink:0;display:flex;align-items:center;gap:12px}.gc-switch-wrapper[data-v-4e3af112]{display:flex;align-items:center}.gc-expand-icon[data-v-4e3af112]{width:20px;display:flex;justify-content:center;color:var(--gc-text-muted,#94a3b8);font-size:0.8em;opacity:0.7}.gc-always-on[data-v-4e3af112]{font-size:0.75em;color:#34d399;padding:2px 8px;background:rgba(52,211,153,0.1);border-radius:4px}.gc-extension-settings[data-v-4e3af112]{padding:12px;background:rgba(0,0,0,0.15);border-radius:8px;margin-left:48px;display:flex;flex-direction:column;gap:10px}.gc-setting-item[data-v-4e3af112]{display:flex;flex-direction:column;gap:6px}.gc-setting-item label[data-v-4e3af112]{font-size:0.85em;color:var(--gc-text-muted,#94a3b8)}.gc-input[data-v-4e3af112]{width:100%;padding:6px 10px;background:rgba(0,0,0,0.2);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:6px;color:var(--gc-text,#f1f5f9);font-size:0.85em}.gc-setting-toggle[data-v-4e3af112]{display:flex;justify-content:space-between;align-items:flex-start;padding:6px 0}.gc-setting-toggle label[data-v-4e3af112]{display:flex;flex-direction:column;gap:2px}.gc-setting-toggle label span[data-v-4e3af112]{font-size:0.85em;font-weight:500}.gc-setting-toggle label small[data-v-4e3af112]{font-size:0.75em;color:var(--gc-text-muted,#94a3b8)}.gc-damage-preview[data-v-4e3af112]{margin-top:8px;padding:10px;background:rgba(239,68,68,0.1);border-radius:6px}.gc-damage-preview-header[data-v-4e3af112]{display:flex;align-items:center;gap:6px;font-size:0.85em;font-weight:500;margin-bottom:8px;color:#f87171}.gc-damage-preview-content[data-v-4e3af112]{display:flex;flex-direction:column;gap:4px}.gc-damage-stat[data-v-4e3af112]{display:flex;justify-content:space-between;font-size:0.8em}.gc-damage-label[data-v-4e3af112]{color:var(--gc-text-muted,#94a3b8)}.gc-damage-value[data-v-4e3af112]{font-weight:500}.gc-damage-value.casualties[data-v-4e3af112]{color:#f87171}.gc-damage-value.buildings[data-v-4e3af112]{color:#fbbf24}.slide-enter-active[data-v-4e3af112],.slide-leave-active[data-v-4e3af112]{transition:all 0.3s ease}.slide-enter-from[data-v-4e3af112],.slide-leave-to[data-v-4e3af112]{opacity:0;max-height:0;padding-top:0;padding-bottom:0;margin-top:0}.slide-enter-to[data-v-4e3af112],.slide-leave-from[data-v-4e3af112]{max-height:1000px}\n','',{version:3,sources:['webpack://./src/ui/panels/ExtensionsPanel.vue'],names:[],mappings:'AAwMA,gCACE,eACF,CAEA,oCACE,YAAa,CACb,kBAAmB,CACnB,6BAA8B,CAC9B,aAAc,CACd,eAAgB,CAChB,eAAgB,CAChB,iBAAkB,CAClB,kCAAoC,CACpC,cAAe,CACf,wBAAiB,CAAjB,gBAAiB,CACjB,qBACF,CAEA,0CACE,4BACF,CAEA,oEACE,+BACF,CAEA,iCACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,qBACF,CAEA,6BACE,eAAgB,CAChB,WAAY,CACZ,yBACF,CAEA,sCACE,+BACF,CAEA,oCACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,oCACE,YAAa,CACb,kBAAmB,CACnB,QAAS,CACT,iBAAkB,CAClB,0BAA8B,CAC9B,iBAAkB,CAClB,4BAA6B,CAC7B,mBACF,CAEA,0CACE,0BACF,CAEA,8CACE,cACF,CAEA,yCACE,iCACF,CAEA,2CACE,kCACF,CAEA,oCACE,UAAW,CACX,WAAY,CACZ,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,iCAAqC,CACrC,iBAAkB,CAClB,kCACF,CAEA,4DACE,+BAAmC,CACnC,aACF,CAEA,2CACE,8BAAkC,CAClC,aACF,CAEA,qEACE,aACF,CAEA,oCACE,MAAO,CACP,WACF,CAEA,oCACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,eAAgB,CAChB,eAAgB,CAChB,iBACF,CAEA,oCACE,eAAgB,CAChB,kCACF,CAEA,sCACE,aAAc,CACd,YAAa,CACb,kBAAmB,CACnB,QACF,CAEA,oCACE,YAAa,CACb,kBACF,CAEA,iCACE,UAAW,CACX,YAAa,CACb,sBAAuB,CACvB,kCAAoC,CACpC,eAAgB,CAChB,WACF,CAEA,+BACE,gBAAiB,CACjB,aAAc,CACd,eAAgB,CAChB,+BAAmC,CACnC,iBACF,CAEA,wCACE,YAAa,CACb,2BAA+B,CAC/B,iBAAkB,CAClB,gBAAiB,CACjB,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,kCACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,wCACE,gBAAiB,CACjB,kCACF,CAEA,2BACE,UAAW,CACX,gBAAiB,CACjB,0BAA8B,CAC9B,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,gBACF,CAEA,oCACE,YAAa,CACb,6BAA8B,CAC9B,sBAAuB,CACvB,aACF,CAEA,0CACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,+CACE,gBAAiB,CACjB,eACF,CAEA,gDACE,gBAAiB,CACjB,kCACF,CAEA,oCACE,cAAe,CACf,YAAa,CACb,8BAAkC,CAClC,iBACF,CAEA,2CACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,gBAAiB,CACjB,eAAgB,CAChB,iBAAkB,CAClB,aACF,CAEA,4CACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,iCACE,YAAa,CACb,6BAA8B,CAC9B,eACF,CAEA,kCACE,kCACF,CAEA,kCACE,eACF,CAEA,6CACE,aACF,CAEA,4CACE,aACF,CAEA,0EAEE,wBACF,CAEA,oEAEE,SAAU,CACV,YAAa,CACb,aAAc,CACd,gBAAiB,CACjB,YACF,CAEA,oEAEE,iBACF',sourcesContent:['<template>\n  <div class="gc-extensions">\n    <div \n      class="gc-section-header clickable"\n      @click="isSectionCollapsed = !isSectionCollapsed"\n    >\n      <div class="gc-header-left">\n        <i class="fa-solid fa-puzzle-piece"></i>\n        <span>扩展系统</span>\n      </div>\n      <i \n        class="fa-solid gc-chevron"\n        :class="isSectionCollapsed ? \'fa-chevron-right\' : \'fa-chevron-down\'"\n      ></i>\n    </div>\n    \n    <transition name="slide">\n      <div v-show="!isSectionCollapsed" class="gc-extension-list">\n      \x3c!-- 核心计算（始终开启） --\x3e\n      <div class="gc-extension-item core">\n        <div class="gc-extension-icon">\n          <i class="fa-solid fa-calculator"></i>\n        </div>\n        <div class="gc-extension-info">\n          <div class="gc-extension-name">\n            基础计算\n            <GcBadge size="sm">核心</GcBadge>\n          </div>\n          <div class="gc-extension-desc">身体数据计算、相对尺寸参照</div>\n        </div>\n        <div class="gc-extension-toggle">\n          <span class="gc-always-on">始终开启</span>\n        </div>\n      </div>\n\n      \x3c!-- 损害计算（可开关） --\x3e\n      <div \n        class="gc-extension-item" \n        :class="{ \n          active: settings.enableDamageCalculation,\n          clickable: settings.enableDamageCalculation\n        }"\n        @click="settings.enableDamageCalculation ? (isDamageExpanded = !isDamageExpanded) : null"\n      >\n        <div class="gc-extension-icon damage">\n          <i class="fa-solid fa-explosion"></i>\n        </div>\n        <div class="gc-extension-info">\n          <div class="gc-extension-name">\n            损害计算\n            <GcBadge v-if="settings.enableDamageCalculation" variant="success" size="sm">已启用</GcBadge>\n          </div>\n          <div class="gc-extension-desc">计算巨大娘行动可能造成的破坏</div>\n        </div>\n        <div class="gc-extension-toggle">\n          <div @click.stop class="gc-switch-wrapper">\n            <GcSwitch\n              :model-value="settings.enableDamageCalculation"\n              @update:model-value="$emit(\'toggle-damage\', $event)"\n            />\n          </div>\n          <div v-if="settings.enableDamageCalculation" class="gc-expand-icon">\n            <i class="fa-solid" :class="isDamageExpanded ? \'fa-chevron-up\' : \'fa-chevron-down\'"></i>\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- 损害计算设置 --\x3e\n      <transition name="slide">\n        <div v-if="settings.enableDamageCalculation && isDamageExpanded" class="gc-extension-settings">\n          <div class="gc-setting-item">\n            <label>默认场景</label>\n            <select class="gc-input" :value="settings.damageScenario" @change="$emit(\'update:setting\', \'damageScenario\', ($event.target as HTMLSelectElement).value)">\n              <option\n                v-for="scenario in damageScenarios"\n                :key="scenario.id"\n                :value="scenario.id"\n              >\n                {{ scenario.name }} ({{ scenario.density.toLocaleString() }}人/km²)\n              </option>\n            </select>\n          </div>\n          \n          <div class="gc-setting-toggle">\n            <label>\n              <span>注入损害提示词</span>\n              <small>在提示词中包含损害计算结果</small>\n            </label>\n            <GcSwitch\n              size="sm"\n              :model-value="settings.injectDamagePrompt"\n              @update:model-value="$emit(\'update:setting\', \'injectDamagePrompt\', $event)"\n            />\n          </div>\n          \n          <div class="gc-setting-toggle">\n            <label>\n              <span>显示特殊效应</span>\n              <small>地震、海啸等物理效应</small>\n            </label>\n            <GcSwitch\n              size="sm"\n              :model-value="settings.showSpecialEffects"\n              @update:model-value="$emit(\'update:setting\', \'showSpecialEffects\', $event)"\n            />\n          </div>\n          \n          <div class="gc-setting-toggle">\n            <label>\n              <span>按角色显示损害</span>\n              <small>在角色卡片中显示损害数据</small>\n            </label>\n            <GcSwitch\n              size="sm"\n              :model-value="settings.showDamagePerCharacter"\n              @update:model-value="$emit(\'update:setting\', \'showDamagePerCharacter\', $event)"\n            />\n          </div>\n          \n          <div class="gc-setting-toggle">\n            <label>\n              <span>显示损害汇总</span>\n              <small>所有角色的损害统计</small>\n            </label>\n            <GcSwitch\n              size="sm"\n              :model-value="settings.showDamageSummary"\n              @update:model-value="$emit(\'update:setting\', \'showDamageSummary\', $event)"\n            />\n          </div>\n          \n          \x3c!-- 损害预览 --\x3e\n          <div v-if="damageSummary" class="gc-damage-preview">\n            <div class="gc-damage-preview-header">\n              <i class="fa-solid fa-chart-bar"></i>\n              <span>当前汇总</span>\n            </div>\n            <div class="gc-damage-preview-content">\n              <div class="gc-damage-stat">\n                <span class="gc-damage-label">巨大娘数量</span>\n                <span class="gc-damage-value">{{ damageSummary.giantCount }}</span>\n              </div>\n              <div class="gc-damage-stat">\n                <span class="gc-damage-label">预估单步伤亡</span>\n                <span class="gc-damage-value casualties">\n                  {{ formatDamageRange(damageSummary.totalCasualties) }}\n                </span>\n              </div>\n              <div class="gc-damage-stat">\n                <span class="gc-damage-label">预估建筑损毁</span>\n                <span class="gc-damage-value buildings">\n                  {{ formatDamageRange(damageSummary.totalBuildings) }}\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </transition>\n      </div>\n    </transition>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { ref, watch } from \'vue\';\nimport { GcSwitch, GcBadge } from \'../components\';\nimport type { Settings, DamageSummary } from \'../../types\';\n\nconst props = defineProps<{\n  settings: Settings;\n  damageSummary: DamageSummary | null;\n  damageScenarios: Array<{ id: string; name: string; density: number }>;\n}>();\n\ndefineEmits<{\n  (e: \'toggle-damage\', value: boolean): void;\n  (e: \'update:setting\', key: keyof Settings, value: unknown): void;\n}>();\n\n// 状态控制\nconst isSectionCollapsed = ref(false);\nconst isDamageExpanded = ref(true);\n\n// 当启用损害计算时，自动展开设置\nwatch(() => props.settings.enableDamageCalculation, (val) => {\n  if (val) isDamageExpanded.value = true;\n});\n\nconst formatDamageRange = (range: { min: number; max: number } | undefined) => {\n  if (!range) return \'-\';\n  const formatNum = (n: number) => {\n    if (n >= 1000000) return `${(n / 1000000).toFixed(1)}M`;\n    if (n >= 1000) return `${(n / 1000).toFixed(1)}K`;\n    return n.toString();\n  };\n  return `${formatNum(range.min)} - ${formatNum(range.max)}`;\n};\n<\/script>\n\n<style scoped>\n.gc-extensions {\n  margin-top: 16px;\n}\n\n.gc-section-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 0;\n  font-size: 0.9em;\n  font-weight: 600;\n  margin-bottom: 4px;\n  color: var(--gc-text-muted, #94a3b8);\n  cursor: pointer;\n  user-select: none;\n  transition: color 0.2s;\n}\n\n.gc-section-header:hover {\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-section-header.clickable:hover .gc-header-left {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-header-left {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  transition: color 0.2s;\n}\n\n.gc-chevron {\n  font-size: 0.8em;\n  opacity: 0.7;\n  transition: transform 0.2s;\n}\n\n.gc-section-header i {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-extension-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.gc-extension-item {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 10px 12px;\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  border: 1px solid transparent;\n  transition: all 0.2s;\n}\n\n.gc-extension-item:hover {\n  background: rgba(0, 0, 0, 0.3);\n}\n\n.gc-extension-item.clickable {\n  cursor: pointer;\n}\n\n.gc-extension-item.core {\n  border-color: rgba(52, 211, 153, 0.2);\n}\n\n.gc-extension-item.active {\n  border-color: rgba(244, 114, 182, 0.3);\n}\n\n.gc-extension-icon {\n  width: 36px;\n  height: 36px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-extension-item.core .gc-extension-icon {\n  background: rgba(52, 211, 153, 0.1);\n  color: #34d399;\n}\n\n.gc-extension-icon.damage {\n  background: rgba(239, 68, 68, 0.1);\n  color: #f87171;\n}\n\n.gc-extension-item.active .gc-extension-icon.damage {\n  color: #ef4444;\n}\n\n.gc-extension-info {\n  flex: 1;\n  min-width: 0;\n}\n\n.gc-extension-name {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-weight: 500;\n  font-size: 0.9em;\n  margin-bottom: 2px;\n}\n\n.gc-extension-desc {\n  font-size: 0.8em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-extension-toggle {\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.gc-switch-wrapper {\n  display: flex;\n  align-items: center;\n}\n\n.gc-expand-icon {\n  width: 20px;\n  display: flex;\n  justify-content: center;\n  color: var(--gc-text-muted, #94a3b8);\n  font-size: 0.8em;\n  opacity: 0.7;\n}\n\n.gc-always-on {\n  font-size: 0.75em;\n  color: #34d399;\n  padding: 2px 8px;\n  background: rgba(52, 211, 153, 0.1);\n  border-radius: 4px;\n}\n\n.gc-extension-settings {\n  padding: 12px;\n  background: rgba(0, 0, 0, 0.15);\n  border-radius: 8px;\n  margin-left: 48px;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.gc-setting-item {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.gc-setting-item label {\n  font-size: 0.85em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-input {\n  width: 100%;\n  padding: 6px 10px;\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 6px;\n  color: var(--gc-text, #f1f5f9);\n  font-size: 0.85em;\n}\n\n.gc-setting-toggle {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  padding: 6px 0;\n}\n\n.gc-setting-toggle label {\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n}\n\n.gc-setting-toggle label span {\n  font-size: 0.85em;\n  font-weight: 500;\n}\n\n.gc-setting-toggle label small {\n  font-size: 0.75em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-damage-preview {\n  margin-top: 8px;\n  padding: 10px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 6px;\n}\n\n.gc-damage-preview-header {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 0.85em;\n  font-weight: 500;\n  margin-bottom: 8px;\n  color: #f87171;\n}\n\n.gc-damage-preview-content {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.gc-damage-stat {\n  display: flex;\n  justify-content: space-between;\n  font-size: 0.8em;\n}\n\n.gc-damage-label {\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-damage-value {\n  font-weight: 500;\n}\n\n.gc-damage-value.casualties {\n  color: #f87171;\n}\n\n.gc-damage-value.buildings {\n  color: #fbbf24;\n}\n\n.slide-enter-active,\n.slide-leave-active {\n  transition: all 0.3s ease;\n}\n\n.slide-enter-from,\n.slide-leave-to {\n  opacity: 0;\n  max-height: 0;\n  padding-top: 0;\n  padding-bottom: 0;\n  margin-top: 0;\n}\n\n.slide-enter-to,\n.slide-leave-from {\n  max-height: 1000px;\n}\n</style>\n'],sourceRoot:''}]);const s=o},65(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-btn[data-v-7bc235a6]{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:8px 14px;background:rgba(255,255,255,0.05);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:8px;color:var(--gc-text,#f1f5f9);font-weight:500;font-size:0.85em;cursor:pointer;transition:all 0.2s}.gc-btn[data-v-7bc235a6]:hover{background:rgba(255,255,255,0.1)}.gc-btn-primary[data-v-7bc235a6]{background:var(--gc-primary,#f472b6);border-color:var(--gc-primary,#f472b6);color:white}.gc-btn-primary[data-v-7bc235a6]:hover{background:var(--gc-primary-hover,#ec4899)}.gc-btn-danger[data-v-7bc235a6]{background:rgba(239,68,68,0.1);border-color:rgba(239,68,68,0.3);color:#f87171}.gc-btn-danger[data-v-7bc235a6]:hover{background:rgba(239,68,68,0.2)}.gc-btn-link[data-v-7bc235a6]{background:transparent;border:none;color:var(--gc-text-muted,#94a3b8);padding:4px 8px}.gc-btn-link[data-v-7bc235a6]:hover{color:var(--gc-text,#f1f5f9)}.gc-btn-sm[data-v-7bc235a6]{padding:6px 10px;font-size:0.8em}.gc-btn-icon[data-v-7bc235a6]{width:36px;height:36px;padding:0;border-radius:8px}.gc-btn-icon-sm[data-v-7bc235a6]{width:28px;height:28px;padding:0;font-size:0.8em;border-radius:6px}.gc-btn-icon-xs[data-v-7bc235a6]{width:20px;height:20px;padding:0;font-size:0.7em;border-radius:4px}.gc-btn[data-v-7bc235a6]:disabled{opacity:0.5;cursor:not-allowed}.gc-btn.active[data-v-7bc235a6]{background:var(--gc-primary,#f472b6);color:white}\n','',{version:3,sources:['webpack://./src/ui/components/GcButton.vue'],names:[],mappings:'AA+BA,yBACE,mBAAoB,CACpB,kBAAmB,CACnB,sBAAuB,CACvB,OAAQ,CACR,gBAAiB,CACjB,iCAAqC,CACrC,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,eAAgB,CAChB,gBAAiB,CACjB,cAAe,CACf,mBACF,CAEA,+BACE,gCACF,CAEA,iCACE,oCAAsC,CACtC,sCAAwC,CACxC,WACF,CAEA,uCACE,0CACF,CAEA,gCACE,8BAAkC,CAClC,gCAAoC,CACpC,aACF,CAEA,sCACE,8BACF,CAEA,8BACE,sBAAuB,CACvB,WAAY,CACZ,kCAAoC,CACpC,eACF,CAEA,oCACE,4BACF,CAEA,4BACE,gBAAiB,CACjB,eACF,CAEA,8BACE,UAAW,CACX,WAAY,CACZ,SAAU,CACV,iBACF,CAEA,iCACE,UAAW,CACX,WAAY,CACZ,SAAU,CACV,eAAgB,CAChB,iBACF,CAEA,iCACE,UAAW,CACX,WAAY,CACZ,SAAU,CACV,eAAgB,CAChB,iBACF,CAEA,kCACE,WAAY,CACZ,kBACF,CAEA,gCACE,oCAAsC,CACtC,WACF',sourcesContent:['<template>\n  <button\n    class="gc-btn"\n    :class="[\n      variant && `gc-btn-${variant}`,\n      size && `gc-btn-${size}`,\n      { active, disabled }\n    ]"\n    :disabled="disabled"\n    @click="$emit(\'click\', $event)"\n  >\n    <i v-if="icon" :class="icon"></i>\n    <slot></slot>\n  </button>\n</template>\n\n<script setup lang="ts">\ndefineProps<{\n  variant?: \'primary\' | \'danger\' | \'link\' | \'icon\' | \'icon-sm\' | \'icon-xs\';\n  size?: \'sm\' | \'md\';\n  icon?: string;\n  active?: boolean;\n  disabled?: boolean;\n}>();\n\ndefineEmits<{\n  (e: \'click\', event: MouseEvent): void;\n}>();\n<\/script>\n\n<style scoped>\n.gc-btn {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  padding: 8px 14px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 8px;\n  color: var(--gc-text, #f1f5f9);\n  font-weight: 500;\n  font-size: 0.85em;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.gc-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.gc-btn-primary {\n  background: var(--gc-primary, #f472b6);\n  border-color: var(--gc-primary, #f472b6);\n  color: white;\n}\n\n.gc-btn-primary:hover {\n  background: var(--gc-primary-hover, #ec4899);\n}\n\n.gc-btn-danger {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: rgba(239, 68, 68, 0.3);\n  color: #f87171;\n}\n\n.gc-btn-danger:hover {\n  background: rgba(239, 68, 68, 0.2);\n}\n\n.gc-btn-link {\n  background: transparent;\n  border: none;\n  color: var(--gc-text-muted, #94a3b8);\n  padding: 4px 8px;\n}\n\n.gc-btn-link:hover {\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-btn-sm {\n  padding: 6px 10px;\n  font-size: 0.8em;\n}\n\n.gc-btn-icon {\n  width: 36px;\n  height: 36px;\n  padding: 0;\n  border-radius: 8px;\n}\n\n.gc-btn-icon-sm {\n  width: 28px;\n  height: 28px;\n  padding: 0;\n  font-size: 0.8em;\n  border-radius: 6px;\n}\n\n.gc-btn-icon-xs {\n  width: 20px;\n  height: 20px;\n  padding: 0;\n  font-size: 0.7em;\n  border-radius: 4px;\n}\n\n.gc-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.gc-btn.active {\n  background: var(--gc-primary, #f472b6);\n  color: white;\n}\n</style>\n'],sourceRoot:''}]);const s=o},134(e,n,a){var t=a(9);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('74633356',t,!1,{ssrId:!0})},139(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-result[data-v-5651f202]{--gc-giant-color:#fb923c;--gc-tiny-color:#60a5fa;--gc-bg:rgba(30,41,59,0.7);--gc-border:rgba(255,255,255,0.1);background:var(--gc-bg);border:1px solid var(--gc-border);border-radius:12px;overflow:hidden;margin-bottom:16px;transition:transform 0.2s,box-shadow 0.2s;backdrop-filter:blur(8px)}.gc-result[data-v-5651f202]:hover{transform:translateY(-2px);box-shadow:0 8px 16px -4px rgba(0,0,0,0.2)}.gc-result.giant[data-v-5651f202]{border-left:4px solid var(--gc-giant-color)}.gc-result.tiny[data-v-5651f202]{border-left:4px solid var(--gc-tiny-color)}.gc-result-header[data-v-5651f202]{padding:16px;display:flex;align-items:center;gap:16px;border-bottom:1px solid var(--gc-border);background:rgba(255,255,255,0.03);position:relative}.gc-result-close[data-v-5651f202]{position:absolute;top:8px;right:8px;width:28px;height:28px;border:none;border-radius:6px;background:rgba(255,255,255,0.05);color:rgba(255,255,255,0.5);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.2s}.gc-result-close[data-v-5651f202]:hover{background:rgba(239,68,68,0.2);color:#ef4444}.gc-result-icon-wrapper[data-v-5651f202]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.5em;flex-shrink:0;background:rgba(255,255,255,0.05)}.gc-result.giant .gc-result-icon-wrapper[data-v-5651f202]{color:var(--gc-giant-color);background:rgba(251,146,60,0.1)}.gc-result.tiny .gc-result-icon-wrapper[data-v-5651f202]{color:var(--gc-tiny-color);background:rgba(96,165,250,0.1)}.gc-result-title[data-v-5651f202]{flex:1}.gc-result-height[data-v-5651f202]{font-size:1.5em;font-weight:700;line-height:1.2;color:var(--smart-text-color,#e2e8f0);letter-spacing:-0.02em}.gc-result-meta[data-v-5651f202]{display:flex;align-items:center;gap:8px;margin-top:4px;font-size:0.85em}.gc-badge[data-v-5651f202]{padding:2px 8px;border-radius:6px;font-weight:600;text-transform:uppercase;font-size:0.85em}.gc-badge.giant[data-v-5651f202]{background:rgba(251,146,60,0.2);color:var(--gc-giant-color)}.gc-badge.tiny[data-v-5651f202]{background:rgba(96,165,250,0.2);color:var(--gc-tiny-color)}.gc-multiplier[data-v-5651f202]{color:var(--smart-text-muted-color,#94a3b8);font-family:\'JetBrains Mono\',monospace}.gc-result-body[data-v-5651f202]{padding:16px}.gc-level-desc[data-v-5651f202]{font-size:0.9em;color:var(--smart-text-muted-color,#94a3b8);margin-bottom:12px;font-style:italic;display:flex;gap:8px}.gc-level-desc i[data-v-5651f202]{opacity:0.5;margin-top:2px}.gc-result-desc[data-v-5651f202]{font-size:0.95em;line-height:1.6;color:var(--smart-text-color,#e2e8f0);white-space:pre-wrap}\n','',{version:3,sources:['webpack://./src/ui/Result.vue'],names:[],mappings:'AAgDA,4BACE,wBAAyB,CACzB,uBAAwB,CACxB,0BAA8B,CAC9B,iCAAqC,CAErC,uBAAwB,CACxB,iCAAkC,CAClC,kBAAmB,CACnB,eAAgB,CAChB,kBAAmB,CACnB,yCAA2C,CAC3C,yBACF,CAEA,kCACE,0BAA2B,CAC3B,0CACF,CAEA,kCACE,2CACF,CAEA,iCACE,0CACF,CAEA,mCACE,YAAa,CACb,YAAa,CACb,kBAAmB,CACnB,QAAS,CACT,wCAAyC,CACzC,iCAAqC,CACrC,iBACF,CAEA,kCACE,iBAAkB,CAClB,OAAQ,CACR,SAAU,CACV,UAAW,CACX,WAAY,CACZ,WAAY,CACZ,iBAAkB,CAClB,iCAAqC,CACrC,2BAA+B,CAC/B,cAAe,CACf,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,mBACF,CAEA,wCACE,8BAAkC,CAClC,aACF,CAEA,yCACE,UAAW,CACX,WAAY,CACZ,kBAAmB,CACnB,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,eAAgB,CAChB,aAAc,CACd,iCACF,CAEA,0DACE,2BAA4B,CAC5B,+BACF,CAEA,yDACE,0BAA2B,CAC3B,+BACF,CAEA,kCACE,MACF,CAEA,mCACE,eAAgB,CAChB,eAAgB,CAChB,eAAgB,CAChB,qCAAuC,CACvC,sBACF,CAEA,iCACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,cAAe,CACf,gBACF,CAEA,2BACE,eAAgB,CAChB,iBAAkB,CAClB,eAAgB,CAChB,wBAAyB,CACzB,gBACF,CAEA,iCACE,+BAAmC,CACnC,2BACF,CAEA,gCACE,+BAAmC,CACnC,0BACF,CAEA,gCACE,2CAA6C,CAC7C,sCACF,CAEA,iCACE,YACF,CAEA,gCACE,eAAgB,CAChB,2CAA6C,CAC7C,kBAAmB,CACnB,iBAAkB,CAClB,YAAa,CACb,OACF,CAEA,kCACE,WAAY,CACZ,cACF,CAEA,iCACE,gBAAiB,CACjB,eAAgB,CAChB,qCAAuC,CACvC,oBACF',sourcesContent:['<template>\n  <div class="gc-result" :class="isGiant ? \'giant\' : \'tiny\'">\n    <div class="gc-result-header">\n      <div class="gc-result-icon-wrapper">\n        <i class="fa-solid" :class="isGiant ? \'fa-ruler-vertical\' : \'fa-microscope\'"></i>\n      </div>\n      <div class="gc-result-title">\n        <div class="gc-result-height">\n          {{ result.当前身高_格式化 }}\n        </div>\n        <div class="gc-result-meta">\n          <span class="gc-badge" :class="isGiant ? \'giant\' : \'tiny\'">\n            {{ result.级别 }}\n          </span>\n          <span class="gc-multiplier">\n            <i class="fa-solid fa-xmark"></i> {{ result.倍率 }}\n          </span>\n        </div>\n      </div>\n      <button class="gc-result-close" @click="$emit(\'close\')" title="关闭">\n        <i class="fa-solid fa-times"></i>\n      </button>\n    </div>\n    \n    <div class="gc-result-body">\n      <div class="gc-level-desc">\n        <i class="fa-solid fa-quote-left"></i>\n        {{ result.级别描述 }}\n      </div>\n      <div class="gc-result-desc">{{ result.描述 }}</div>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport type { GiantessData, TinyData } from \'../core\';\n\ndefineProps<{\n  result: GiantessData | TinyData;\n  isGiant: boolean;\n}>();\n\ndefineEmits<{\n  (e: \'close\'): void;\n}>();\n<\/script>\n\n<style scoped>\n.gc-result {\n  --gc-giant-color: #fb923c;\n  --gc-tiny-color: #60a5fa;\n  --gc-bg: rgba(30, 41, 59, 0.7);\n  --gc-border: rgba(255, 255, 255, 0.1);\n  \n  background: var(--gc-bg);\n  border: 1px solid var(--gc-border);\n  border-radius: 12px;\n  overflow: hidden;\n  margin-bottom: 16px;\n  transition: transform 0.2s, box-shadow 0.2s;\n  backdrop-filter: blur(8px);\n}\n\n.gc-result:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.2);\n}\n\n.gc-result.giant {\n  border-left: 4px solid var(--gc-giant-color);\n}\n\n.gc-result.tiny {\n  border-left: 4px solid var(--gc-tiny-color);\n}\n\n.gc-result-header {\n  padding: 16px;\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  border-bottom: 1px solid var(--gc-border);\n  background: rgba(255, 255, 255, 0.03);\n  position: relative;\n}\n\n.gc-result-close {\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  width: 28px;\n  height: 28px;\n  border: none;\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.5);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n}\n\n.gc-result-close:hover {\n  background: rgba(239, 68, 68, 0.2);\n  color: #ef4444;\n}\n\n.gc-result-icon-wrapper {\n  width: 48px;\n  height: 48px;\n  border-radius: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.5em;\n  flex-shrink: 0;\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.gc-result.giant .gc-result-icon-wrapper {\n  color: var(--gc-giant-color);\n  background: rgba(251, 146, 60, 0.1);\n}\n\n.gc-result.tiny .gc-result-icon-wrapper {\n  color: var(--gc-tiny-color);\n  background: rgba(96, 165, 250, 0.1);\n}\n\n.gc-result-title {\n  flex: 1;\n}\n\n.gc-result-height {\n  font-size: 1.5em;\n  font-weight: 700;\n  line-height: 1.2;\n  color: var(--smart-text-color, #e2e8f0);\n  letter-spacing: -0.02em;\n}\n\n.gc-result-meta {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-top: 4px;\n  font-size: 0.85em;\n}\n\n.gc-badge {\n  padding: 2px 8px;\n  border-radius: 6px;\n  font-weight: 600;\n  text-transform: uppercase;\n  font-size: 0.85em;\n}\n\n.gc-badge.giant {\n  background: rgba(251, 146, 60, 0.2);\n  color: var(--gc-giant-color);\n}\n\n.gc-badge.tiny {\n  background: rgba(96, 165, 250, 0.2);\n  color: var(--gc-tiny-color);\n}\n\n.gc-multiplier {\n  color: var(--smart-text-muted-color, #94a3b8);\n  font-family: \'JetBrains Mono\', monospace;\n}\n\n.gc-result-body {\n  padding: 16px;\n}\n\n.gc-level-desc {\n  font-size: 0.9em;\n  color: var(--smart-text-muted-color, #94a3b8);\n  margin-bottom: 12px;\n  font-style: italic;\n  display: flex;\n  gap: 8px;\n}\n\n.gc-level-desc i {\n  opacity: 0.5;\n  margin-top: 2px;\n}\n\n.gc-result-desc {\n  font-size: 0.95em;\n  line-height: 1.6;\n  color: var(--smart-text-color, #e2e8f0);\n  white-space: pre-wrap;\n}\n</style>'],sourceRoot:''}]);const s=o},152(e,n,a){var t=a(176);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('f75aac88',t,!1,{ssrId:!0})},153(e,n,a){var t=a(672);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('39014354',t,!1,{ssrId:!0})},175(e,n,a){var t=a(926);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('700a4cf8',t,!1,{ssrId:!0})},176(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-debug-logs-section[data-v-4e1480de]{display:flex;flex-direction:column;height:100%}.gc-debug-logs-header[data-v-4e1480de]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.gc-debug-logs-header h3[data-v-4e1480de]{display:flex;align-items:center;gap:8px;font-size:0.9em;font-weight:600;color:var(--gc-text,#f1f5f9)}.gc-debug-logs-header h3 i[data-v-4e1480de]{color:var(--gc-primary,#f472b6)}.gc-btn-link[data-v-4e1480de]{background:transparent;border:none;color:var(--gc-text-muted,#94a3b8);cursor:pointer;padding:4px 8px}.gc-btn-link[data-v-4e1480de]:hover{color:var(--gc-text,#f1f5f9)}.gc-debug-logs[data-v-4e1480de]{flex:1;background:rgba(0,0,0,0.3);border-radius:8px;padding:10px;font-family:\'Monaco\',\'Menlo\',monospace;font-size:0.8em;max-height:400px;overflow-y:auto}.gc-debug-log-item[data-v-4e1480de]{display:flex;gap:10px;padding:4px 0;border-bottom:1px solid rgba(255,255,255,0.05)}.gc-debug-log-item[data-v-4e1480de]:last-child{border-bottom:none}.gc-debug-log-item.warn[data-v-4e1480de]{color:#fbbf24}.gc-debug-log-item.error[data-v-4e1480de]{color:#f87171}.gc-log-time[data-v-4e1480de]{color:var(--gc-text-muted,#94a3b8);white-space:nowrap}.gc-log-msg[data-v-4e1480de]{word-break:break-all;color:var(--gc-text,#f1f5f9)}.gc-debug-empty[data-v-4e1480de]{display:flex;flex-direction:column;align-items:center;padding:40px 20px;text-align:center}.gc-debug-empty i[data-v-4e1480de]{font-size:2em;color:var(--gc-text-muted,#94a3b8);margin-bottom:12px}.gc-debug-empty p[data-v-4e1480de]{font-size:0.9em;margin-bottom:6px}.gc-debug-empty small[data-v-4e1480de]{font-size:0.8em;color:var(--gc-text-muted,#94a3b8)}\n','',{version:3,sources:['webpack://./src/ui/features/debug/DebugLogsSection.vue'],names:[],mappings:'AAwCA,wCACE,YAAa,CACb,qBAAsB,CACtB,WACF,CAEA,uCACE,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,kBACF,CAEA,0CACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,eAAgB,CAChB,eAAgB,CAChB,4BACF,CAEA,4CACE,+BACF,CAEA,8BACE,sBAAuB,CACvB,WAAY,CACZ,kCAAoC,CACpC,cAAe,CACf,eACF,CAEA,oCACE,4BACF,CAEA,gCACE,MAAO,CACP,0BAA8B,CAC9B,iBAAkB,CAClB,YAAa,CACb,sCAAyC,CACzC,eAAgB,CAChB,gBAAiB,CACjB,eACF,CAEA,oCACE,YAAa,CACb,QAAS,CACT,aAAc,CACd,8CACF,CAEA,+CACE,kBACF,CAEA,yCACE,aACF,CAEA,0CACE,aACF,CAEA,8BACE,kCAAoC,CACpC,kBACF,CAEA,6BACE,oBAAqB,CACrB,4BACF,CAEA,iCACE,YAAa,CACb,qBAAsB,CACtB,kBAAmB,CACnB,iBAAkB,CAClB,iBACF,CAEA,mCACE,aAAc,CACd,kCAAoC,CACpC,kBACF,CAEA,mCACE,eAAgB,CAChB,iBACF,CAEA,uCACE,eAAgB,CAChB,kCACF',sourcesContent:['<template>\n  <div class="gc-debug-logs-section">\n    <div class="gc-debug-logs-header">\n      <h3><i class="fa-solid fa-terminal"></i> 调试日志</h3>\n      <button class="gc-btn-link" @click="$emit(\'clear\')" title="清空日志">\n        <i class="fa-solid fa-trash"></i>\n      </button>\n    </div>\n    \n    <div class="gc-debug-logs">\n      <div \n        v-for="(log, i) in logs" \n        :key="i" \n        class="gc-debug-log-item"\n        :class="log.level"\n      >\n        <span class="gc-log-time">{{ log.time }}</span>\n        <span class="gc-log-msg">{{ log.message }}</span>\n      </div>\n      \n      <div v-if="!logs.length" class="gc-debug-empty">\n        <i class="fa-solid fa-terminal"></i>\n        <p>暂无日志</p>\n        <small>开启调试模式后操作会记录在这里</small>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\ndefineProps<{\n  logs: Array<{ time: string; message: string; level?: string }>;\n}>();\n\ndefineEmits<{\n  (e: \'clear\'): void;\n}>();\n<\/script>\n\n<style scoped>\n.gc-debug-logs-section {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.gc-debug-logs-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10px;\n}\n\n.gc-debug-logs-header h3 {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.9em;\n  font-weight: 600;\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-debug-logs-header h3 i {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-btn-link {\n  background: transparent;\n  border: none;\n  color: var(--gc-text-muted, #94a3b8);\n  cursor: pointer;\n  padding: 4px 8px;\n}\n\n.gc-btn-link:hover {\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-debug-logs {\n  flex: 1;\n  background: rgba(0, 0, 0, 0.3);\n  border-radius: 8px;\n  padding: 10px;\n  font-family: \'Monaco\', \'Menlo\', monospace;\n  font-size: 0.8em;\n  max-height: 400px;\n  overflow-y: auto;\n}\n\n.gc-debug-log-item {\n  display: flex;\n  gap: 10px;\n  padding: 4px 0;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n}\n\n.gc-debug-log-item:last-child {\n  border-bottom: none;\n}\n\n.gc-debug-log-item.warn {\n  color: #fbbf24;\n}\n\n.gc-debug-log-item.error {\n  color: #f87171;\n}\n\n.gc-log-time {\n  color: var(--gc-text-muted, #94a3b8);\n  white-space: nowrap;\n}\n\n.gc-log-msg {\n  word-break: break-all;\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-debug-empty {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 40px 20px;\n  text-align: center;\n}\n\n.gc-debug-empty i {\n  font-size: 2em;\n  color: var(--gc-text-muted, #94a3b8);\n  margin-bottom: 12px;\n}\n\n.gc-debug-empty p {\n  font-size: 0.9em;\n  margin-bottom: 6px;\n}\n\n.gc-debug-empty small {\n  font-size: 0.8em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n</style>\n'],sourceRoot:''}]);const s=o},202(e,n,a){var t=a(901);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('49523336',t,!1,{ssrId:!0})},206(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-switch[data-v-03ff4c3e]{-webkit-appearance:none;appearance:none;width:36px;height:20px;background:rgba(255,255,255,0.1);border-radius:10px;position:relative;cursor:pointer;transition:all 0.2s}.gc-switch[data-v-03ff4c3e]::after{content:\'\';position:absolute;width:16px;height:16px;background:white;border-radius:50%;top:2px;left:2px;transition:all 0.2s}.gc-switch[data-v-03ff4c3e]:checked{background:var(--gc-primary,#f472b6)}.gc-switch[data-v-03ff4c3e]:checked::after{left:18px}.gc-switch.sm[data-v-03ff4c3e]{width:28px;height:16px}.gc-switch.sm[data-v-03ff4c3e]::after{width:12px;height:12px}.gc-switch.sm[data-v-03ff4c3e]:checked::after{left:14px}\n','',{version:3,sources:['webpack://./src/ui/components/GcSwitch.vue'],names:[],mappings:'AAsBA,4BACE,uBAAgB,CAAhB,eAAgB,CAChB,UAAW,CACX,WAAY,CACZ,gCAAoC,CACpC,kBAAmB,CACnB,iBAAkB,CAClB,cAAe,CACf,mBACF,CAEA,mCACE,UAAW,CACX,iBAAkB,CAClB,UAAW,CACX,WAAY,CACZ,gBAAiB,CACjB,iBAAkB,CAClB,OAAQ,CACR,QAAS,CACT,mBACF,CAEA,oCACE,oCACF,CAEA,2CACE,SACF,CAEA,+BACE,UAAW,CACX,WACF,CAEA,sCACE,UAAW,CACX,WACF,CAEA,8CACE,SACF',sourcesContent:['<template>\n  <input\n    type="checkbox"\n    class="gc-switch"\n    :class="{ sm: size === \'sm\' }"\n    :checked="modelValue"\n    @change="$emit(\'update:modelValue\', ($event.target as HTMLInputElement).checked)"\n  />\n</template>\n\n<script setup lang="ts">\ndefineProps<{\n  modelValue: boolean;\n  size?: \'sm\' | \'md\';\n}>();\n\ndefineEmits<{\n  (e: \'update:modelValue\', value: boolean): void;\n}>();\n<\/script>\n\n<style scoped>\n.gc-switch {\n  appearance: none;\n  width: 36px;\n  height: 20px;\n  background: rgba(255, 255, 255, 0.1);\n  border-radius: 10px;\n  position: relative;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.gc-switch::after {\n  content: \'\';\n  position: absolute;\n  width: 16px;\n  height: 16px;\n  background: white;\n  border-radius: 50%;\n  top: 2px;\n  left: 2px;\n  transition: all 0.2s;\n}\n\n.gc-switch:checked {\n  background: var(--gc-primary, #f472b6);\n}\n\n.gc-switch:checked::after {\n  left: 18px;\n}\n\n.gc-switch.sm {\n  width: 28px;\n  height: 16px;\n}\n\n.gc-switch.sm::after {\n  width: 12px;\n  height: 12px;\n}\n\n.gc-switch.sm:checked::after {\n  left: 14px;\n}\n</style>\n'],sourceRoot:''}]);const s=o},275(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-char-list[data-v-142edb12]{display:flex;flex-direction:column;gap:0;max-height:600px;overflow-y:auto;padding-right:4px}.gc-empty[data-v-142edb12]{display:flex;flex-direction:column;align-items:center;gap:16px;color:var(--gc-text-muted,#94a3b8);padding:40px 24px;background:rgba(255,255,255,0.02);border-radius:16px;border:1px dashed var(--gc-border,rgba(255,255,255,0.08))}.gc-damage-section[data-v-142edb12]{background:rgba(249,115,22,0.05);border-radius:8px;padding:12px !important;border:1px solid rgba(249,115,22,0.15)}.gc-damage-section .gc-detail-section-title[data-v-142edb12]{color:#fb923c}.gc-damage-level-badge[data-v-142edb12]{font-size:0.8em;font-weight:500;padding:2px 8px;background:rgba(249,115,22,0.2);color:#fb923c;border-radius:4px;margin-left:auto}.gc-damage-grid[data-v-142edb12]{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:8px}.gc-damage-item[data-v-142edb12]{background:rgba(0,0,0,0.2);padding:8px 10px;border-radius:6px}.gc-damage-item-label[data-v-142edb12]{font-size:0.75em;color:var(--gc-text-muted,#94a3b8);margin-bottom:2px}.gc-damage-item-value[data-v-142edb12]{font-size:0.9em;font-weight:500;font-family:var(--gc-font-mono);color:var(--gc-text,#f8fafc)}.gc-damage-item-value.casualties[data-v-142edb12]{color:#f87171}.gc-damage-item-value.buildings[data-v-142edb12]{color:#fbbf24}.gc-macro-damage[data-v-142edb12]{margin-top:10px;padding-top:10px;border-top:1px dashed rgba(249,115,22,0.2)}.gc-macro-damage-title[data-v-142edb12]{font-size:0.8em;font-weight:600;color:#fb923c;display:flex;align-items:center;gap:6px;margin-bottom:6px}.gc-macro-damage-list[data-v-142edb12]{display:flex;flex-wrap:wrap;gap:6px}.gc-macro-damage-list span[data-v-142edb12]{font-size:0.8em;padding:3px 8px;background:rgba(249,115,22,0.15);color:var(--gc-text,#f8fafc);border-radius:4px}.gc-special-effects[data-v-142edb12]{margin-top:10px;padding-top:10px;border-top:1px dashed rgba(249,115,22,0.2)}.gc-special-effects-title[data-v-142edb12]{font-size:0.8em;font-weight:600;color:#60a5fa;display:flex;align-items:center;gap:6px;margin-bottom:6px}.gc-special-effects-list[data-v-142edb12]{display:flex;flex-wrap:wrap;gap:4px}.gc-effect-tag[data-v-142edb12]{font-size:0.75em;padding:2px 6px;background:rgba(96,165,250,0.15);color:#60a5fa;border-radius:4px}.gc-effect-more[data-v-142edb12]{font-size:0.75em;padding:2px 6px;background:rgba(255,255,255,0.1);color:var(--gc-text-muted,#94a3b8);border-radius:4px}.gc-actual-damage-section[data-v-142edb12]{background:rgba(239,68,68,0.05);border-radius:8px;padding:12px !important;border:1px solid rgba(239,68,68,0.2);margin-top:8px}.gc-actual-damage-section .gc-detail-section-title[data-v-142edb12]{color:#ef4444}.gc-actual-damage-badge[data-v-142edb12]{font-size:0.7em;font-weight:500;padding:2px 6px;background:rgba(239,68,68,0.2);color:#ef4444;border-radius:4px;margin-left:auto}.gc-actual-damage-grid[data-v-142edb12]{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:8px}.gc-actual-damage-item[data-v-142edb12]{background:rgba(0,0,0,0.2);padding:8px 10px;border-radius:6px;text-align:center}.gc-actual-damage-item-label[data-v-142edb12]{font-size:0.7em;color:var(--gc-text-muted,#94a3b8);margin-bottom:2px}.gc-actual-damage-item-value[data-v-142edb12]{font-size:0.95em;font-weight:600;font-family:var(--gc-font-mono)}.gc-actual-damage-item-value.casualties[data-v-142edb12]{color:#f87171}.gc-actual-damage-item-value.buildings[data-v-142edb12]{color:#fbbf24}.gc-actual-damage-item-value.cities[data-v-142edb12]{color:#c084fc}.gc-last-action[data-v-142edb12]{margin-top:10px;padding-top:10px;border-top:1px dashed rgba(239,68,68,0.2)}.gc-last-action-title[data-v-142edb12]{font-size:0.75em;font-weight:600;color:#f87171;display:flex;align-items:center;gap:6px;margin-bottom:4px}.gc-last-action-content[data-v-142edb12]{display:flex;justify-content:space-between;align-items:center;font-size:0.85em}.gc-last-action-desc[data-v-142edb12]{color:var(--gc-text,#f8fafc)}.gc-last-action-casualties[data-v-142edb12]{color:#f87171;font-family:var(--gc-font-mono)}.gc-major-events[data-v-142edb12]{margin-top:10px;padding-top:10px;border-top:1px dashed rgba(239,68,68,0.2)}.gc-major-events-title[data-v-142edb12]{font-size:0.75em;font-weight:600;color:#fbbf24;display:flex;align-items:center;gap:6px;margin-bottom:6px}.gc-major-events-list[data-v-142edb12]{display:flex;flex-direction:column;gap:4px}.gc-major-event-item[data-v-142edb12]{display:flex;justify-content:space-between;align-items:center;font-size:0.8em;padding:4px 8px;background:rgba(0,0,0,0.15);border-radius:4px}.gc-major-event-desc[data-v-142edb12]{color:var(--gc-text,#f8fafc);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.gc-major-event-casualties[data-v-142edb12]{color:#f87171;font-family:var(--gc-font-mono);margin-left:8px;flex-shrink:0}.gc-actual-damage-note[data-v-142edb12]{margin-top:8px;font-size:0.8em;color:var(--gc-text-muted,#94a3b8);font-style:italic;display:flex;align-items:center;gap:6px}.gc-actual-damage-note i[data-v-142edb12]{color:#94a3b8}.gc-char-list[data-v-142edb12]::-webkit-scrollbar{width:4px}.gc-char-list[data-v-142edb12]::-webkit-scrollbar-track{background:transparent}.gc-char-list[data-v-142edb12]::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.1);border-radius:2px}.gc-char-list[data-v-142edb12]::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,0.2)}\n','',{version:3,sources:['webpack://./src/ui/CharacterList.vue'],names:[],mappings:'AA+JA,+BACE,YAAa,CACb,qBAAsB,CACtB,KAAM,CACN,gBAAiB,CACjB,eAAgB,CAChB,iBACF,CAEA,2BACE,YAAa,CACb,qBAAsB,CACtB,kBAAmB,CACnB,QAAS,CACT,kCAAoC,CACpC,iBAAkB,CAClB,iCAAqC,CACrC,kBAAmB,CACnB,yDACF,CAEA,oCACE,gCAAoC,CACpC,iBAAkB,CAClB,uBAAwB,CACxB,sCACF,CAEA,6DACE,aACF,CAEA,wCACE,eAAgB,CAChB,eAAgB,CAChB,eAAgB,CAChB,+BAAmC,CACnC,aAAc,CACd,iBAAkB,CAClB,gBACF,CAEA,iCACE,YAAa,CACb,mCAAqC,CACrC,OAAQ,CACR,cACF,CAEA,iCACE,0BAA8B,CAC9B,gBAAiB,CACjB,iBACF,CAEA,uCACE,gBAAiB,CACjB,kCAAoC,CACpC,iBACF,CAEA,uCACE,eAAgB,CAChB,eAAgB,CAChB,+BAAgC,CAChC,4BACF,CAEA,kDACE,aACF,CAEA,iDACE,aACF,CAGA,kCACE,eAAgB,CAChB,gBAAiB,CACjB,0CACF,CAEA,wCACE,eAAgB,CAChB,eAAgB,CAChB,aAAc,CACd,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,iBACF,CAEA,uCACE,YAAa,CACb,cAAe,CACf,OACF,CAEA,4CACE,eAAgB,CAChB,eAAgB,CAChB,gCAAoC,CACpC,4BAA8B,CAC9B,iBACF,CAGA,qCACE,eAAgB,CAChB,gBAAiB,CACjB,0CACF,CAEA,2CACE,eAAgB,CAChB,eAAgB,CAChB,aAAc,CACd,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,iBACF,CAEA,0CACE,YAAa,CACb,cAAe,CACf,OACF,CAEA,gCACE,gBAAiB,CACjB,eAAgB,CAChB,gCAAoC,CACpC,aAAc,CACd,iBACF,CAEA,iCACE,gBAAiB,CACjB,eAAgB,CAChB,gCAAoC,CACpC,kCAAoC,CACpC,iBACF,CAGA,2CACE,+BAAmC,CACnC,iBAAkB,CAClB,uBAAwB,CACxB,oCAAwC,CACxC,cACF,CAEA,oEACE,aACF,CAEA,yCACE,eAAgB,CAChB,eAAgB,CAChB,eAAgB,CAChB,8BAAkC,CAClC,aAAc,CACd,iBAAkB,CAClB,gBACF,CAEA,wCACE,YAAa,CACb,mCAAqC,CACrC,OAAQ,CACR,cACF,CAEA,wCACE,0BAA8B,CAC9B,gBAAiB,CACjB,iBAAkB,CAClB,iBACF,CAEA,8CACE,eAAgB,CAChB,kCAAoC,CACpC,iBACF,CAEA,8CACE,gBAAiB,CACjB,eAAgB,CAChB,+BACF,CAEA,yDACE,aACF,CAEA,wDACE,aACF,CAEA,qDACE,aACF,CAGA,iCACE,eAAgB,CAChB,gBAAiB,CACjB,yCACF,CAEA,uCACE,gBAAiB,CACjB,eAAgB,CAChB,aAAc,CACd,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,iBACF,CAEA,yCACE,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,gBACF,CAEA,sCACE,4BACF,CAEA,4CACE,aAAc,CACd,+BACF,CAGA,kCACE,eAAgB,CAChB,gBAAiB,CACjB,yCACF,CAEA,wCACE,gBAAiB,CACjB,eAAgB,CAChB,aAAc,CACd,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,iBACF,CAEA,uCACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,sCACE,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,eAAgB,CAChB,eAAgB,CAChB,2BAA+B,CAC/B,iBACF,CAEA,sCACE,4BAA8B,CAC9B,MAAO,CACP,eAAgB,CAChB,sBAAuB,CACvB,kBACF,CAEA,4CACE,aAAc,CACd,+BAAgC,CAChC,eAAgB,CAChB,aACF,CAGA,wCACE,cAAe,CACf,eAAgB,CAChB,kCAAoC,CACpC,iBAAkB,CAClB,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,0CACE,aACF,CAGA,kDACE,SACF,CAEA,wDACE,sBACF,CAEA,wDACE,gCAAoC,CACpC,iBACF,CAEA,8DACE,gCACF',sourcesContent:['<template>\n  <div class="gc-char-list">\n    <div v-if="characters.size === 0" class="gc-empty">\n      <i class="fa-regular fa-folder-open"></i>\n      <span>暂无角色数据</span>\n    </div>\n    \n    <CharacterCard\n      v-for="[name, data] in characters"\n      :key="name"\n      :name="name"\n      :data="data"\n      :show-damage="showDamage"\n      :expanded="expandedChar === name"\n      @toggle="toggleExpand"\n    >\n      \x3c!-- 损害数据插槽 --\x3e\n      <template #damage="{ damageData }">\n        <div v-if="showDamage && damageData" class="gc-detail-section full-width gc-damage-section">\n          <div class="gc-detail-section-title">\n            <i class="fa-solid fa-explosion"></i> 破坏力数据\n            <span class="gc-damage-level-badge">{{ damageData.破坏力等级 }}</span>\n          </div>\n          <div class="gc-damage-grid">\n            <div class="gc-damage-item">\n              <div class="gc-damage-item-label">足迹面积</div>\n              <div class="gc-damage-item-value">{{ damageData.足迹.足迹面积_格式化 }}</div>\n            </div>\n            <div class="gc-damage-item">\n              <div class="gc-damage-item-label">单步伤亡</div>\n              <div class="gc-damage-item-value casualties">{{ damageData.单步损害.小人伤亡.格式化 }}</div>\n            </div>\n            <div class="gc-damage-item">\n              <div class="gc-damage-item-label">建筑损毁</div>\n              <div class="gc-damage-item-value buildings">{{ damageData.单步损害.建筑损毁.格式化 }}</div>\n            </div>\n            <div v-if="damageData.单步损害.城区损毁.数量 > 0" class="gc-damage-item">\n              <div class="gc-damage-item-label">城区损毁</div>\n              <div class="gc-damage-item-value">{{ damageData.单步损害.城区损毁.格式化 }}</div>\n            </div>\n          </div>\n          \n          \x3c!-- 宏观破坏 --\x3e\n          <div v-if="damageData.宏观破坏" class="gc-macro-damage">\n            <div class="gc-macro-damage-title">\n              <i class="fa-solid fa-globe"></i>\n              宏观破坏力: {{ damageData.宏观破坏.等级名称 }}\n            </div>\n            <div class="gc-macro-damage-list">\n              <span v-if="damageData.宏观破坏.城市">{{ damageData.宏观破坏.城市.格式化 }}</span>\n              <span v-if="damageData.宏观破坏.国家">{{ damageData.宏观破坏.国家.格式化 }}</span>\n              <span v-if="damageData.宏观破坏.大陆">{{ damageData.宏观破坏.大陆.格式化 }}</span>\n              <span v-if="damageData.宏观破坏.行星">{{ damageData.宏观破坏.行星.格式化 }}</span>\n              <span v-if="damageData.宏观破坏.恒星">{{ damageData.宏观破坏.恒星.格式化 }}</span>\n              <span v-if="damageData.宏观破坏.星系">{{ damageData.宏观破坏.星系.格式化 }}</span>\n            </div>\n          </div>\n          \n          \x3c!-- 特殊效应 --\x3e\n          <div v-if="damageData.特殊效应.length > 0" class="gc-special-effects">\n            <div class="gc-special-effects-title">\n              <i class="fa-solid fa-bolt"></i> 物理效应\n            </div>\n            <div class="gc-special-effects-list">\n              <span v-for="(effect, i) in damageData.特殊效应.slice(0, 4)" :key="i" class="gc-effect-tag">\n                {{ effect }}\n              </span>\n              <span v-if="damageData.特殊效应.length > 4" class="gc-effect-more">\n                +{{ damageData.特殊效应.length - 4 }}更多\n              </span>\n            </div>\n          </div>\n        </div>\n      </template>\n\n      \x3c!-- 实际损害插槽 --\x3e\n      <template #actual-damage="{ actualDamage }">\n        <div v-if="actualDamage" class="gc-detail-section full-width gc-actual-damage-section">\n          <div class="gc-detail-section-title">\n            <i class="fa-solid fa-skull"></i> 实际损害记录\n            <span class="gc-actual-damage-badge">剧情累计</span>\n          </div>\n          <div class="gc-actual-damage-grid">\n            <div v-if="actualDamage.总伤亡人数" class="gc-actual-damage-item">\n              <div class="gc-actual-damage-item-label">累计伤亡</div>\n              <div class="gc-actual-damage-item-value casualties">{{ formatLargeNumber(actualDamage.总伤亡人数) }}人</div>\n            </div>\n            <div v-if="actualDamage.总建筑损毁" class="gc-actual-damage-item">\n              <div class="gc-actual-damage-item-label">建筑损毁</div>\n              <div class="gc-actual-damage-item-value buildings">{{ actualDamage.总建筑损毁 }}栋</div>\n            </div>\n            <div v-if="actualDamage.总城市毁灭" class="gc-actual-damage-item">\n              <div class="gc-actual-damage-item-label">城市毁灭</div>\n              <div class="gc-actual-damage-item-value cities">{{ actualDamage.总城市毁灭 }}座</div>\n            </div>\n          </div>\n          \n          \x3c!-- 最近行动 --\x3e\n          <div v-if="actualDamage.最近行动" class="gc-last-action">\n            <div class="gc-last-action-title">\n              <i class="fa-solid fa-shoe-prints"></i> 最近行动\n            </div>\n            <div class="gc-last-action-content">\n              <span class="gc-last-action-desc">{{ actualDamage.最近行动.描述 }}</span>\n              <span v-if="actualDamage.最近行动.伤亡人数" class="gc-last-action-casualties">\n                伤亡: {{ formatLargeNumber(actualDamage.最近行动.伤亡人数) }}人\n              </span>\n            </div>\n          </div>\n          \n          \x3c!-- 重大事件 --\x3e\n          <div v-if="actualDamage.重大事件?.length" class="gc-major-events">\n            <div class="gc-major-events-title">\n              <i class="fa-solid fa-star"></i> 重大事件 ({{ actualDamage.重大事件.length }})\n            </div>\n            <div class="gc-major-events-list">\n              <div v-for="(event, i) in actualDamage.重大事件.slice(-3)" :key="i" class="gc-major-event-item">\n                <span class="gc-major-event-desc">{{ event.描述 }}</span>\n                <span v-if="event.伤亡人数" class="gc-major-event-casualties">{{ formatLargeNumber(event.伤亡人数) }}人</span>\n              </div>\n            </div>\n          </div>\n          \n          \x3c!-- 备注 --\x3e\n          <div v-if="actualDamage.备注" class="gc-actual-damage-note">\n            <i class="fa-solid fa-comment"></i> {{ actualDamage.备注 }}\n          </div>\n        </div>\n      </template>\n    </CharacterCard>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { ref } from \'vue\';\nimport CharacterCard from \'./features/CharacterCard.vue\';\nimport type { CharacterData } from \'../characters\';\n\ndefineProps<{\n  characters: Map<string, CharacterData>;\n  showDamage?: boolean;\n}>();\n\nconst expandedChar = ref<string | null>(null);\n\nconst toggleExpand = (name: string) => {\n  expandedChar.value = expandedChar.value === name ? null : name;\n};\n\n// 格式化大数字\nconst formatLargeNumber = (n: number): string => {\n  if (n >= 1e8) return `${(n / 1e8).toFixed(1)}亿`;\n  if (n >= 1e4) return `${(n / 1e4).toFixed(1)}万`;\n  if (n >= 1000) return `${(n / 1000).toFixed(1)}千`;\n  return Math.round(n).toString();\n};\n<\/script>\n\n<style scoped>\n.gc-char-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0;\n  max-height: 600px;\n  overflow-y: auto;\n  padding-right: 4px;\n}\n\n.gc-empty {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 16px;\n  color: var(--gc-text-muted, #94a3b8);\n  padding: 40px 24px;\n  background: rgba(255, 255, 255, 0.02);\n  border-radius: 16px;\n  border: 1px dashed var(--gc-border, rgba(255, 255, 255, 0.08));\n}\n\n.gc-damage-section {\n  background: rgba(249, 115, 22, 0.05);\n  border-radius: 8px;\n  padding: 12px !important;\n  border: 1px solid rgba(249, 115, 22, 0.15);\n}\n\n.gc-damage-section .gc-detail-section-title {\n  color: #fb923c;\n}\n\n.gc-damage-level-badge {\n  font-size: 0.8em;\n  font-weight: 500;\n  padding: 2px 8px;\n  background: rgba(249, 115, 22, 0.2);\n  color: #fb923c;\n  border-radius: 4px;\n  margin-left: auto;\n}\n\n.gc-damage-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 8px;\n  margin-top: 8px;\n}\n\n.gc-damage-item {\n  background: rgba(0, 0, 0, 0.2);\n  padding: 8px 10px;\n  border-radius: 6px;\n}\n\n.gc-damage-item-label {\n  font-size: 0.75em;\n  color: var(--gc-text-muted, #94a3b8);\n  margin-bottom: 2px;\n}\n\n.gc-damage-item-value {\n  font-size: 0.9em;\n  font-weight: 500;\n  font-family: var(--gc-font-mono);\n  color: var(--gc-text, #f8fafc);\n}\n\n.gc-damage-item-value.casualties {\n  color: #f87171;\n}\n\n.gc-damage-item-value.buildings {\n  color: #fbbf24;\n}\n\n/* 宏观破坏 */\n.gc-macro-damage {\n  margin-top: 10px;\n  padding-top: 10px;\n  border-top: 1px dashed rgba(249, 115, 22, 0.2);\n}\n\n.gc-macro-damage-title {\n  font-size: 0.8em;\n  font-weight: 600;\n  color: #fb923c;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  margin-bottom: 6px;\n}\n\n.gc-macro-damage-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n}\n\n.gc-macro-damage-list span {\n  font-size: 0.8em;\n  padding: 3px 8px;\n  background: rgba(249, 115, 22, 0.15);\n  color: var(--gc-text, #f8fafc);\n  border-radius: 4px;\n}\n\n/* 特殊效应 */\n.gc-special-effects {\n  margin-top: 10px;\n  padding-top: 10px;\n  border-top: 1px dashed rgba(249, 115, 22, 0.2);\n}\n\n.gc-special-effects-title {\n  font-size: 0.8em;\n  font-weight: 600;\n  color: #60a5fa;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  margin-bottom: 6px;\n}\n\n.gc-special-effects-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 4px;\n}\n\n.gc-effect-tag {\n  font-size: 0.75em;\n  padding: 2px 6px;\n  background: rgba(96, 165, 250, 0.15);\n  color: #60a5fa;\n  border-radius: 4px;\n}\n\n.gc-effect-more {\n  font-size: 0.75em;\n  padding: 2px 6px;\n  background: rgba(255, 255, 255, 0.1);\n  color: var(--gc-text-muted, #94a3b8);\n  border-radius: 4px;\n}\n\n/* 实际损害记录区域 */\n.gc-actual-damage-section {\n  background: rgba(239, 68, 68, 0.05);\n  border-radius: 8px;\n  padding: 12px !important;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n  margin-top: 8px;\n}\n\n.gc-actual-damage-section .gc-detail-section-title {\n  color: #ef4444;\n}\n\n.gc-actual-damage-badge {\n  font-size: 0.7em;\n  font-weight: 500;\n  padding: 2px 6px;\n  background: rgba(239, 68, 68, 0.2);\n  color: #ef4444;\n  border-radius: 4px;\n  margin-left: auto;\n}\n\n.gc-actual-damage-grid {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 8px;\n  margin-top: 8px;\n}\n\n.gc-actual-damage-item {\n  background: rgba(0, 0, 0, 0.2);\n  padding: 8px 10px;\n  border-radius: 6px;\n  text-align: center;\n}\n\n.gc-actual-damage-item-label {\n  font-size: 0.7em;\n  color: var(--gc-text-muted, #94a3b8);\n  margin-bottom: 2px;\n}\n\n.gc-actual-damage-item-value {\n  font-size: 0.95em;\n  font-weight: 600;\n  font-family: var(--gc-font-mono);\n}\n\n.gc-actual-damage-item-value.casualties {\n  color: #f87171;\n}\n\n.gc-actual-damage-item-value.buildings {\n  color: #fbbf24;\n}\n\n.gc-actual-damage-item-value.cities {\n  color: #c084fc;\n}\n\n/* 最近行动 */\n.gc-last-action {\n  margin-top: 10px;\n  padding-top: 10px;\n  border-top: 1px dashed rgba(239, 68, 68, 0.2);\n}\n\n.gc-last-action-title {\n  font-size: 0.75em;\n  font-weight: 600;\n  color: #f87171;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  margin-bottom: 4px;\n}\n\n.gc-last-action-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 0.85em;\n}\n\n.gc-last-action-desc {\n  color: var(--gc-text, #f8fafc);\n}\n\n.gc-last-action-casualties {\n  color: #f87171;\n  font-family: var(--gc-font-mono);\n}\n\n/* 重大事件 */\n.gc-major-events {\n  margin-top: 10px;\n  padding-top: 10px;\n  border-top: 1px dashed rgba(239, 68, 68, 0.2);\n}\n\n.gc-major-events-title {\n  font-size: 0.75em;\n  font-weight: 600;\n  color: #fbbf24;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  margin-bottom: 6px;\n}\n\n.gc-major-events-list {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.gc-major-event-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 0.8em;\n  padding: 4px 8px;\n  background: rgba(0, 0, 0, 0.15);\n  border-radius: 4px;\n}\n\n.gc-major-event-desc {\n  color: var(--gc-text, #f8fafc);\n  flex: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.gc-major-event-casualties {\n  color: #f87171;\n  font-family: var(--gc-font-mono);\n  margin-left: 8px;\n  flex-shrink: 0;\n}\n\n/* 备注 */\n.gc-actual-damage-note {\n  margin-top: 8px;\n  font-size: 0.8em;\n  color: var(--gc-text-muted, #94a3b8);\n  font-style: italic;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.gc-actual-damage-note i {\n  color: #94a3b8;\n}\n\n/* 滚动条 */\n.gc-char-list::-webkit-scrollbar {\n  width: 4px;\n}\n\n.gc-char-list::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.gc-char-list::-webkit-scrollbar-thumb {\n  background: rgba(255, 255, 255, 0.1);\n  border-radius: 2px;\n}\n\n.gc-char-list::-webkit-scrollbar-thumb:hover {\n  background: rgba(255, 255, 255, 0.2);\n}\n</style>\n'],sourceRoot:''}]);const s=o},339(e,n,a){var t=a(18);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('1ea5b0d7',t,!1,{ssrId:!0})},345(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-debug-section[data-v-91dab098]{padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;margin-bottom:12px}.gc-debug-section[data-v-91dab098]:last-child{margin-bottom:0}.gc-debug-section h3[data-v-91dab098]{display:flex;align-items:center;gap:8px;font-size:0.9em;font-weight:600;margin-bottom:10px;color:var(--gc-text,#f1f5f9)}.gc-debug-section h3 i[data-v-91dab098]{color:var(--gc-primary,#f472b6)}.gc-debug-status[data-v-91dab098]{display:flex;flex-direction:column;gap:6px}.gc-debug-row[data-v-91dab098]{display:flex;justify-content:space-between;align-items:center;font-size:0.85em;padding:4px 0}.gc-debug-row[data-v-91dab098]:not(:last-child){border-bottom:1px solid rgba(255,255,255,0.05)}.gc-debug-label[data-v-91dab098]{color:var(--gc-text-muted,#94a3b8)}.gc-debug-value[data-v-91dab098]{font-weight:500;text-align:right}.gc-debug-value.success[data-v-91dab098]{color:#34d399}.gc-debug-value.warn[data-v-91dab098]{color:#fbbf24}.gc-debug-value.error[data-v-91dab098]{color:#f87171}.gc-debug-value.muted[data-v-91dab098]{color:var(--gc-text-muted,#94a3b8)}.gc-debug-value.highlight[data-v-91dab098]{color:var(--gc-primary,#f472b6)}.gc-debug-value.mono[data-v-91dab098]{font-family:\'Monaco\',\'Menlo\',monospace}\n','',{version:3,sources:['webpack://./src/ui/features/debug/DebugStatusSection.vue'],names:[],mappings:'AA+HA,mCACE,YAAa,CACb,0BAA8B,CAC9B,iBAAkB,CAClB,kBACF,CAEA,8CACE,eACF,CAEA,sCACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,eAAgB,CAChB,eAAgB,CAChB,kBAAmB,CACnB,4BACF,CAEA,wCACE,+BACF,CAEA,kCACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,+BACE,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,gBAAiB,CACjB,aACF,CAEA,gDACE,8CACF,CAEA,iCACE,kCACF,CAEA,iCACE,eAAgB,CAChB,gBACF,CAEA,yCACE,aACF,CAEA,sCACE,aACF,CAEA,uCACE,aACF,CAEA,uCACE,kCACF,CAEA,2CACE,+BACF,CAEA,sCACE,sCACF',sourcesContent:['<template>\n  <div class="gc-debug-status-section">\n    \x3c!-- MVU 状态 --\x3e\n    <div class="gc-debug-section">\n      <h3><i class="fa-solid fa-satellite-dish"></i> MVU 连接</h3>\n      <div class="gc-debug-status">\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">MVU 可用</span>\n          <span class="gc-debug-value" :class="mvuInfo.mvuAvailable ? \'success\' : \'error\'">\n            {{ mvuInfo.mvuAvailable ? \'✅ 是\' : \'❌ 否\' }}\n          </span>\n        </div>\n        <div v-if="mvuInfo.mvuVersion" class="gc-debug-row">\n          <span class="gc-debug-label">MVU 版本</span>\n          <span class="gc-debug-value">{{ mvuInfo.mvuVersion }}</span>\n        </div>\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">变量前缀</span>\n          <span class="gc-debug-value mono">{{ mvuInfo.prefix }}</span>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- 数据状态 --\x3e\n    <div class="gc-debug-section">\n      <h3><i class="fa-solid fa-database"></i> 数据状态</h3>\n      <div class="gc-debug-status">\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">stat_data</span>\n          <span class="gc-debug-value" :class="mvuInfo.messageVariables?.hasStatData ? \'success\' : \'warn\'">\n            {{ mvuInfo.messageVariables?.hasStatData ? \'✅ 有\' : \'⚠️ 无\' }}\n          </span>\n        </div>\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">巨大娘数据</span>\n          <span class="gc-debug-value" :class="mvuInfo.messageVariables?.hasGiantessData ? \'success\' : \'warn\'">\n            {{ mvuInfo.messageVariables?.hasGiantessData ? \'✅ 有\' : \'⚠️ 无\' }}\n          </span>\n        </div>\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">场景数据</span>\n          <span class="gc-debug-value" :class="mvuInfo.messageVariables?.hasScenarioData ? \'success\' : \'muted\'">\n            {{ mvuInfo.messageVariables?.hasScenarioData ? \'✅ 有\' : \'— 无\' }}\n          </span>\n        </div>\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">互动限制</span>\n          <span class="gc-debug-value" :class="mvuInfo.messageVariables?.hasInteractionData ? \'success\' : \'muted\'">\n            {{ mvuInfo.messageVariables?.hasInteractionData ? \'✅ 有\' : \'— 无\' }}\n          </span>\n        </div>\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">角色数量</span>\n          <span class="gc-debug-value">\n            {{ mvuInfo.messageVariables?.characterDetails?.length || 0 }}\n          </span>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- 当前设置 --\x3e\n    <div class="gc-debug-section">\n      <h3><i class="fa-solid fa-sliders"></i> 当前配置</h3>\n      <div class="gc-debug-status">\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">脚本启用</span>\n          <span class="gc-debug-value" :class="mvuInfo.settings?.enabled ? \'success\' : \'warn\'">\n            {{ mvuInfo.settings?.enabled ? \'✅ 是\' : \'⚠️ 否\' }}\n          </span>\n        </div>\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">自动注入</span>\n          <span class="gc-debug-value" :class="mvuInfo.settings?.autoInject ? \'success\' : \'muted\'">\n            {{ mvuInfo.settings?.autoInject ? \'✅ 开\' : \'— 关\' }}\n          </span>\n        </div>\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">损害计算</span>\n          <span class="gc-debug-value" :class="mvuInfo.settings?.enableDamageCalculation ? \'success\' : \'muted\'">\n            {{ mvuInfo.settings?.enableDamageCalculation ? \'✅ 开\' : \'— 关\' }}\n          </span>\n        </div>\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">世界观注入</span>\n          <span class="gc-debug-value" :class="mvuInfo.settings?.injectWorldviewPrompt ? \'success\' : \'muted\'">\n            {{ mvuInfo.settings?.injectWorldviewPrompt ? \'✅ 开\' : \'— 关\' }}\n          </span>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- 场景与世界观 --\x3e\n    <div class="gc-debug-section">\n      <h3><i class="fa-solid fa-globe"></i> 场景与世界观</h3>\n      <div class="gc-debug-status">\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">当前场景</span>\n          <span class="gc-debug-value">{{ mvuInfo.scenario?.current }}</span>\n        </div>\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">场景来源</span>\n          <span class="gc-debug-value" :class="mvuInfo.scenario?.source === \'MVU变量\' ? \'highlight\' : \'muted\'">\n            {{ mvuInfo.scenario?.source }}\n          </span>\n        </div>\n        <div v-if="mvuInfo.scenario?.reason" class="gc-debug-row">\n          <span class="gc-debug-label">场景原因</span>\n          <span class="gc-debug-value">{{ mvuInfo.scenario.reason }}</span>\n        </div>\n        <div class="gc-debug-row">\n          <span class="gc-debug-label">当前世界观</span>\n          <span class="gc-debug-value highlight">{{ mvuInfo.worldview?.name }}</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport type { MvuDebugInfo } from \'../../../services/debug\';\n\ndefineProps<{\n  mvuInfo: MvuDebugInfo;\n}>();\n<\/script>\n\n<style scoped>\n.gc-debug-section {\n  padding: 12px;\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  margin-bottom: 12px;\n}\n\n.gc-debug-section:last-child {\n  margin-bottom: 0;\n}\n\n.gc-debug-section h3 {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.9em;\n  font-weight: 600;\n  margin-bottom: 10px;\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-debug-section h3 i {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-debug-status {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.gc-debug-row {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 0.85em;\n  padding: 4px 0;\n}\n\n.gc-debug-row:not(:last-child) {\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n}\n\n.gc-debug-label {\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-debug-value {\n  font-weight: 500;\n  text-align: right;\n}\n\n.gc-debug-value.success {\n  color: #34d399;\n}\n\n.gc-debug-value.warn {\n  color: #fbbf24;\n}\n\n.gc-debug-value.error {\n  color: #f87171;\n}\n\n.gc-debug-value.muted {\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-debug-value.highlight {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-debug-value.mono {\n  font-family: \'Monaco\', \'Menlo\', monospace;\n}\n</style>\n'],sourceRoot:''}]);const s=o},372(e,n,a){var t=a(721);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('e7ff91e4',t,!1,{ssrId:!0})},374(e,n,a){var t=a(713);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('2ddcb531',t,!1,{ssrId:!0})},424(e,n,a){function t(e,n){for(var a=[],t={},i=0;i<n.length;i++){var c=n[i],o=c[0],s={id:e+':'+i,css:c[1],media:c[2],sourceMap:c[3]};t[o]?t[o].parts.push(s):a.push(t[o]={id:o,parts:[s]})}return a}a.d(n,{A:()=>m});var i='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!i)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var c={},o=i&&(document.head||document.getElementsByTagName('head')[0]),s=null,r=0,l=!1,d=function(){},g=null,A='data-vue-ssr-id',p='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function m(e,n,a,i){l=a,g=i||{};var o=t(e,n);return C(o),function(n){for(var a=[],i=0;i<o.length;i++){var s=o[i];(r=c[s.id]).refs--,a.push(r)}n?C(o=t(e,n)):o=[];for(i=0;i<a.length;i++){var r;if(0===(r=a[i]).refs){for(var l=0;l<r.parts.length;l++)r.parts[l]();delete c[r.id]}}}}function C(e){for(var n=0;n<e.length;n++){var a=e[n],t=c[a.id];if(t){t.refs++;for(var i=0;i<t.parts.length;i++)t.parts[i](a.parts[i]);for(;i<a.parts.length;i++)t.parts.push(b(a.parts[i]));t.parts.length>a.parts.length&&(t.parts.length=a.parts.length)}else{var o=[];for(i=0;i<a.parts.length;i++)o.push(b(a.parts[i]));c[a.id]={id:a.id,refs:1,parts:o}}}}function u(){var e=document.createElement('style');return e.type='text/css',o.appendChild(e),e}function b(e){var n,a,t=document.querySelector('style['+A+'~="'+e.id+'"]');if(t){if(l)return d;t.parentNode.removeChild(t)}if(p){var i=r++;t=s||(s=u()),n=x.bind(null,t,i,!1),a=x.bind(null,t,i,!0)}else t=u(),n=h.bind(null,t),a=function(){t.parentNode.removeChild(t)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else a()}}var v,f=(v=[],function(e,n){return v[e]=n,v.filter(Boolean).join('\n')});function x(e,n,a,t){var i=a?'':t.css;if(e.styleSheet)e.styleSheet.cssText=f(n,i);else{var c=document.createTextNode(i),o=e.childNodes;o[n]&&e.removeChild(o[n]),o.length?e.insertBefore(c,o[n]):e.appendChild(c)}}function h(e,n){var a=n.css,t=n.media,i=n.sourceMap;if(t&&e.setAttribute('media',t),g.ssrId&&e.setAttribute(A,n.id),i&&(a+='\n/*# sourceURL='+i.sources[0]+' */',a+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+' */'),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}},459(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-settings-list[data-v-eb968c1a]{display:flex;flex-direction:column;gap:12px}.gc-setting-item[data-v-eb968c1a]{display:flex;flex-direction:column;gap:6px}.gc-setting-item label[data-v-eb968c1a]{font-size:0.85em;color:var(--gc-text-muted,#94a3b8);font-weight:500}.gc-input[data-v-eb968c1a]{padding:6px 10px;background:rgba(0,0,0,0.2);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:6px;color:var(--gc-text,#f1f5f9);font-size:0.9em}.gc-input[data-v-eb968c1a]:focus{outline:none;border-color:var(--gc-primary,#f472b6)}.gc-input.sm[data-v-eb968c1a]{padding:4px 8px;font-size:0.85em}.gc-input-spinner[data-v-eb968c1a]{display:flex;align-items:center;gap:4px}.gc-input-spinner button[data-v-eb968c1a]{width:28px;height:28px;background:rgba(255,255,255,0.05);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:4px;color:var(--gc-text,#f1f5f9);cursor:pointer}.gc-input-spinner button[data-v-eb968c1a]:hover{background:rgba(255,255,255,0.1)}.gc-input-spinner input[data-v-eb968c1a]{width:50px;text-align:center;background:rgba(0,0,0,0.2);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:4px;color:var(--gc-text,#f1f5f9);font-size:0.9em;padding:4px}.gc-setting-toggle[data-v-eb968c1a]{display:flex;justify-content:space-between;align-items:flex-start;padding:8px 0;border-bottom:1px solid var(--gc-border,rgba(255,255,255,0.1))}.gc-setting-toggle label[data-v-eb968c1a]{display:flex;flex-direction:column;gap:2px}.gc-setting-toggle label span[data-v-eb968c1a]{font-size:0.9em;font-weight:500}.gc-setting-toggle label small[data-v-eb968c1a]{font-size:0.75em;color:var(--gc-text-muted,#94a3b8)}\n','',{version:3,sources:['webpack://./src/ui/panels/SettingsPanel.vue'],names:[],mappings:'AAsHA,mCACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,kCACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,wCACE,gBAAiB,CACjB,kCAAoC,CACpC,eACF,CAEA,2BACE,gBAAiB,CACjB,0BAA8B,CAC9B,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,eACF,CAEA,iCACE,YAAa,CACb,sCACF,CAEA,8BACE,eAAgB,CAChB,gBACF,CAEA,mCACE,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,0CACE,UAAW,CACX,WAAY,CACZ,iCAAqC,CACrC,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,cACF,CAEA,gDACE,gCACF,CAEA,yCACE,UAAW,CACX,iBAAkB,CAClB,0BAA8B,CAC9B,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,eAAgB,CAChB,WACF,CAEA,oCACE,YAAa,CACb,6BAA8B,CAC9B,sBAAuB,CACvB,aAAc,CACd,8DACF,CAEA,0CACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,+CACE,eAAgB,CAChB,eACF,CAEA,gDACE,gBAAiB,CACjB,kCACF',sourcesContent:['<template>\n  <GcOverlay\n    :visible="visible"\n    title="设置"\n    icon="fa-solid fa-gear"\n    @close="$emit(\'close\')"\n  >\n    <div class="gc-settings-list">\n      <div class="gc-setting-item">\n        <label>变量前缀</label>\n        <input\n          :value="settings.variablePrefix"\n          @input="updateSetting(\'variablePrefix\', ($event.target as HTMLInputElement).value)"\n          type="text"\n          class="gc-input sm"\n          placeholder="巨大娘"\n        />\n      </div>\n      \n      <div class="gc-setting-item">\n        <label>注入深度</label>\n        <div class="gc-input-spinner">\n          <button @click="decrementDepth">-</button>\n          <input :value="settings.injectDepth" type="number" readonly />\n          <button @click="incrementDepth">+</button>\n        </div>\n      </div>\n      \n      <div class="gc-setting-toggle">\n        <label>\n          <span>自动注入提示词</span>\n          <small>数据变化时自动更新 Prompt</small>\n        </label>\n        <GcSwitch\n          :model-value="settings.autoInject"\n          @update:model-value="updateSetting(\'autoInject\', $event)"\n        />\n      </div>\n      \n      <div class="gc-setting-toggle">\n        <label>\n          <span>注入互动限制</span>\n          <small>检查物理上不可能的互动</small>\n        </label>\n        <GcSwitch\n          :model-value="settings.injectInteractionLimits"\n          @update:model-value="updateSetting(\'injectInteractionLimits\', $event)"\n        />\n      </div>\n      \n      <div class="gc-setting-toggle">\n        <label>\n          <span>调试模式</span>\n          <small>在控制台输出详细日志</small>\n        </label>\n        <GcSwitch\n          :model-value="settings.debug"\n          @update:model-value="updateSetting(\'debug\', $event)"\n        />\n      </div>\n      \n      <div class="gc-setting-toggle">\n        <label>\n          <span>显示变量更新规则</span>\n          <small>指导 AI 如何更新身高变量</small>\n        </label>\n        <GcSwitch\n          :model-value="settings.showVariableUpdateRules"\n          @update:model-value="updateSetting(\'showVariableUpdateRules\', $event)"\n        />\n      </div>\n      \n      <div class="gc-setting-toggle">\n        <label>\n          <span>紧凑提示词格式</span>\n          <small>减少提示词中的空行</small>\n        </label>\n        <GcSwitch\n          :model-value="settings.compactPromptFormat"\n          @update:model-value="updateSetting(\'compactPromptFormat\', $event)"\n        />\n      </div>\n    </div>\n  </GcOverlay>\n</template>\n\n<script setup lang="ts">\nimport { GcOverlay, GcSwitch } from \'../components\';\nimport type { Settings } from \'../../types\';\n\nconst props = defineProps<{\n  visible: boolean;\n  settings: Settings;\n}>();\n\nconst emit = defineEmits<{\n  (e: \'close\'): void;\n  (e: \'update:setting\', key: keyof Settings, value: unknown): void;\n}>();\n\nconst updateSetting = (key: keyof Settings, value: unknown) => {\n  emit(\'update:setting\', key, value);\n};\n\nconst decrementDepth = () => {\n  if (props.settings.injectDepth > 0) {\n    updateSetting(\'injectDepth\', props.settings.injectDepth - 1);\n  }\n};\n\nconst incrementDepth = () => {\n  if (props.settings.injectDepth < 10) {\n    updateSetting(\'injectDepth\', props.settings.injectDepth + 1);\n  }\n};\n<\/script>\n\n<style scoped>\n.gc-settings-list {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.gc-setting-item {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.gc-setting-item label {\n  font-size: 0.85em;\n  color: var(--gc-text-muted, #94a3b8);\n  font-weight: 500;\n}\n\n.gc-input {\n  padding: 6px 10px;\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 6px;\n  color: var(--gc-text, #f1f5f9);\n  font-size: 0.9em;\n}\n\n.gc-input:focus {\n  outline: none;\n  border-color: var(--gc-primary, #f472b6);\n}\n\n.gc-input.sm {\n  padding: 4px 8px;\n  font-size: 0.85em;\n}\n\n.gc-input-spinner {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n\n.gc-input-spinner button {\n  width: 28px;\n  height: 28px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 4px;\n  color: var(--gc-text, #f1f5f9);\n  cursor: pointer;\n}\n\n.gc-input-spinner button:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.gc-input-spinner input {\n  width: 50px;\n  text-align: center;\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 4px;\n  color: var(--gc-text, #f1f5f9);\n  font-size: 0.9em;\n  padding: 4px;\n}\n\n.gc-setting-toggle {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  padding: 8px 0;\n  border-bottom: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n}\n\n.gc-setting-toggle label {\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n}\n\n.gc-setting-toggle label span {\n  font-size: 0.9em;\n  font-weight: 500;\n}\n\n.gc-setting-toggle label small {\n  font-size: 0.75em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n</style>\n'],sourceRoot:''}]);const s=o},465(e){e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var a='',t=void 0!==n[5];return n[4]&&(a+='@supports ('.concat(n[4],') {')),n[2]&&(a+='@media '.concat(n[2],' {')),t&&(a+='@layer'.concat(n[5].length>0?' '.concat(n[5]):'',' {')),a+=e(n),t&&(a+='}'),n[2]&&(a+='}'),n[4]&&(a+='}'),a}).join('')},n.i=function(e,a,t,i,c){'string'==typeof e&&(e=[[null,e,void 0]]);var o={};if(t)for(var s=0;s<this.length;s++){var r=this[s][0];null!=r&&(o[r]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);t&&o[d[0]]||(void 0!==c&&(void 0===d[5]||(d[1]='@layer'.concat(d[5].length>0?' '.concat(d[5]):'',' {').concat(d[1],'}')),d[5]=c),a&&(d[2]?(d[1]='@media '.concat(d[2],' {').concat(d[1],'}'),d[2]=a):d[2]=a),i&&(d[4]?(d[1]='@supports ('.concat(d[4],') {').concat(d[1],'}'),d[4]=i):d[4]=''.concat(i)),n.push(d))}},n}},490(e,n,a){var t=a(459);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('7bdd0d86',t,!1,{ssrId:!0})},526(e,n,a){var t=a(139);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('6dfc6f34',t,!1,{ssrId:!0})},566(e,n,a){var t=a(65);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('2fa8b60e',t,!1,{ssrId:!0})},585(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-overlay-panel[data-v-01d31954]{position:absolute;top:0;left:0;right:0;bottom:0;background:var(--gc-bg,#1e293b);z-index:10;display:flex;flex-direction:column;border-radius:var(--gc-radius,12px);animation:fadeIn-01d31954 0.2s ease}@keyframes fadeIn-01d31954{from{opacity:0}to{opacity:1}}.gc-overlay-header[data-v-01d31954]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid var(--gc-border,rgba(255,255,255,0.1))}.gc-overlay-header span[data-v-01d31954]{display:flex;align-items:center;gap:8px;font-weight:600}.gc-header-actions-inner[data-v-01d31954]{display:flex;align-items:center;gap:8px}.gc-close-btn[data-v-01d31954]{background:transparent;border:none;color:var(--gc-text-muted,#94a3b8);cursor:pointer;padding:4px}.gc-close-btn[data-v-01d31954]:hover{color:var(--gc-text,#f1f5f9)}.gc-overlay-content[data-v-01d31954]{flex:1;overflow-y:auto;padding:16px}\n','',{version:3,sources:['webpack://./src/ui/components/GcOverlay.vue'],names:[],mappings:'AAkCA,mCACE,iBAAkB,CAClB,KAAM,CACN,MAAO,CACP,OAAQ,CACR,QAAS,CACT,+BAAiC,CACjC,UAAW,CACX,YAAa,CACb,qBAAsB,CACtB,mCAAqC,CACrC,mCACF,CAEA,2BACE,KAAO,SAAY,CACnB,GAAK,SAAY,CACnB,CAEA,oCACE,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,iBAAkB,CAClB,8DACF,CAEA,yCACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,eACF,CAEA,0CACE,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,+BACE,sBAAuB,CACvB,WAAY,CACZ,kCAAoC,CACpC,cAAe,CACf,WACF,CAEA,qCACE,4BACF,CAEA,qCACE,MAAO,CACP,eAAgB,CAChB,YACF',sourcesContent:['<template>\n  <div v-if="visible" class="gc-overlay-panel" :class="panelClass">\n    <div class="gc-overlay-header">\n      <span>\n        <i v-if="icon" :class="icon"></i>\n        {{ title }}\n      </span>\n      <div class="gc-header-actions-inner">\n        <slot name="header-actions"></slot>\n        <button class="gc-close-btn" @click="$emit(\'close\')">\n          <i class="fa-solid fa-xmark"></i>\n        </button>\n      </div>\n    </div>\n    <div class="gc-overlay-content">\n      <slot></slot>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\ndefineProps<{\n  visible: boolean;\n  title: string;\n  icon?: string;\n  panelClass?: string;\n}>();\n\ndefineEmits<{\n  (e: \'close\'): void;\n}>();\n<\/script>\n\n<style scoped>\n.gc-overlay-panel {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: var(--gc-bg, #1e293b);\n  z-index: 10;\n  display: flex;\n  flex-direction: column;\n  border-radius: var(--gc-radius, 12px);\n  animation: fadeIn 0.2s ease;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; }\n  to { opacity: 1; }\n}\n\n.gc-overlay-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  border-bottom: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n}\n\n.gc-overlay-header span {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-weight: 600;\n}\n\n.gc-header-actions-inner {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.gc-close-btn {\n  background: transparent;\n  border: none;\n  color: var(--gc-text-muted, #94a3b8);\n  cursor: pointer;\n  padding: 4px;\n}\n\n.gc-close-btn:hover {\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-overlay-content {\n  flex: 1;\n  overflow-y: auto;\n  padding: 16px;\n}\n</style>\n'],sourceRoot:''}]);const s=o},587(e,n,a){var t=a(42);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('cf1e11c8',t,!1,{ssrId:!0})},590(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-prompts-content[data-v-16fdb386]{display:flex;flex-direction:column;gap:12px}.gc-prompts-hint[data-v-16fdb386]{display:flex;align-items:center;gap:8px;padding:10px 12px;background:rgba(59,130,246,0.1);border-radius:6px;font-size:0.8em;color:#60a5fa;margin-bottom:8px}.gc-prompts-hint i[data-v-16fdb386]{font-size:1.1em}.gc-prompts-list[data-v-16fdb386]{display:flex;flex-direction:column;gap:8px}.gc-prompt-item[data-v-16fdb386]{display:flex;align-items:flex-start;gap:10px;padding:10px 12px;background:rgba(0,0,0,0.2);border-radius:8px;transition:all 0.2s}.gc-prompt-item[data-v-16fdb386]:hover{background:rgba(0,0,0,0.3)}.gc-prompt-item.disabled[data-v-16fdb386]{opacity:0.6}.gc-prompt-toggle[data-v-16fdb386]{padding-top:2px}.gc-prompt-info[data-v-16fdb386]{flex:1;cursor:pointer;min-width:0}.gc-prompt-name[data-v-16fdb386]{display:flex;align-items:center;flex-wrap:wrap;gap:6px;margin-bottom:4px;font-weight:500;font-size:0.9em}.gc-prompt-type[data-v-16fdb386]{font-size:0.75em;color:var(--gc-text-muted,#94a3b8);padding:2px 6px;background:rgba(255,255,255,0.05);border-radius:4px}.gc-prompt-desc[data-v-16fdb386]{font-size:0.8em;color:var(--gc-text-muted,#94a3b8)}.gc-prompt-actions[data-v-16fdb386]{display:flex;align-items:center;gap:4px}.gc-prompt-order-btns[data-v-16fdb386]{display:flex;flex-direction:column;gap:2px}.gc-btn-icon-xs[data-v-16fdb386]{width:20px;height:16px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.05);border:none;border-radius:3px;color:var(--gc-text-muted,#94a3b8);cursor:pointer;font-size:0.7em}.gc-btn-icon-xs[data-v-16fdb386]:hover{background:rgba(255,255,255,0.1);color:var(--gc-text,#f1f5f9)}.gc-btn-icon-sm[data-v-16fdb386]{width:28px;height:28px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.05);border:none;border-radius:4px;color:var(--gc-text-muted,#94a3b8);cursor:pointer}.gc-btn-icon-sm[data-v-16fdb386]:hover{background:rgba(255,255,255,0.1);color:var(--gc-text,#f1f5f9)}.gc-btn-icon-sm.danger[data-v-16fdb386]:hover{background:rgba(239,68,68,0.2);color:#f87171}.gc-add-template-btn[data-v-16fdb386]{margin-top:8px}.gc-prompt-editor[data-v-16fdb386]{display:flex;flex-direction:column;gap:12px}.gc-editor-header[data-v-16fdb386]{display:flex;align-items:center;gap:12px}.gc-editor-title[data-v-16fdb386]{font-weight:600;font-size:0.95em}.gc-editor-form[data-v-16fdb386]{display:flex;flex-direction:column;gap:12px}.gc-setting-item[data-v-16fdb386]{display:flex;flex-direction:column;gap:6px}.gc-setting-item label[data-v-16fdb386]{font-size:0.85em;color:var(--gc-text-muted,#94a3b8);font-weight:500}.gc-input[data-v-16fdb386]{padding:8px 10px;background:rgba(0,0,0,0.2);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:6px;color:var(--gc-text,#f1f5f9);font-size:0.9em}.gc-input[data-v-16fdb386]:focus{outline:none;border-color:var(--gc-primary,#f472b6)}.gc-textarea[data-v-16fdb386]{padding:8px 10px;background:rgba(0,0,0,0.2);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:6px;color:var(--gc-text,#f1f5f9);font-size:0.9em;resize:vertical;font-family:inherit}.gc-textarea[data-v-16fdb386]:focus{outline:none;border-color:var(--gc-primary,#f472b6)}.gc-editor-textarea[data-v-16fdb386]{min-height:200px}.gc-editor-hint[data-v-16fdb386]{font-size:0.75em;color:var(--gc-text-muted,#94a3b8);padding:6px 10px;background:rgba(0,0,0,0.15);border-radius:4px;margin-bottom:6px}.gc-editor-hint code[data-v-16fdb386]{padding:1px 4px;background:rgba(255,255,255,0.1);border-radius:3px;font-family:monospace;font-size:0.95em}.gc-setting-toggle[data-v-16fdb386]{display:flex;justify-content:space-between;align-items:center;padding:8px 0}.gc-setting-toggle label[data-v-16fdb386]{display:flex;flex-direction:column;gap:2px}.gc-setting-toggle label span[data-v-16fdb386]{font-size:0.85em;font-weight:500}.gc-editor-actions[data-v-16fdb386]{display:flex;gap:8px;justify-content:flex-end;margin-top:8px}.gc-btn-link[data-v-16fdb386]{background:transparent;border:none;color:var(--gc-text-muted,#94a3b8);cursor:pointer;padding:4px 8px;font-size:0.9em;display:flex;align-items:center;gap:6px}.gc-btn-link[data-v-16fdb386]:hover{color:var(--gc-text,#f1f5f9)}\n','',{version:3,sources:['webpack://./src/ui/panels/PromptsPanel.vue'],names:[],mappings:'AA8PA,qCACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,kCACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,iBAAkB,CAClB,+BAAmC,CACnC,iBAAkB,CAClB,eAAgB,CAChB,aAAc,CACd,iBACF,CAEA,oCACE,eACF,CAEA,kCACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,iCACE,YAAa,CACb,sBAAuB,CACvB,QAAS,CACT,iBAAkB,CAClB,0BAA8B,CAC9B,iBAAkB,CAClB,mBACF,CAEA,uCACE,0BACF,CAEA,0CACE,WACF,CAEA,mCACE,eACF,CAEA,iCACE,MAAO,CACP,cAAe,CACf,WACF,CAEA,iCACE,YAAa,CACb,kBAAmB,CACnB,cAAe,CACf,OAAQ,CACR,iBAAkB,CAClB,eAAgB,CAChB,eACF,CAEA,iCACE,gBAAiB,CACjB,kCAAoC,CACpC,eAAgB,CAChB,iCAAqC,CACrC,iBACF,CAEA,iCACE,eAAgB,CAChB,kCACF,CAEA,oCACE,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,uCACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,iCACE,UAAW,CACX,WAAY,CACZ,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,iCAAqC,CACrC,WAAY,CACZ,iBAAkB,CAClB,kCAAoC,CACpC,cAAe,CACf,eACF,CAEA,uCACE,gCAAoC,CACpC,4BACF,CAEA,iCACE,UAAW,CACX,WAAY,CACZ,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,iCAAqC,CACrC,WAAY,CACZ,iBAAkB,CAClB,kCAAoC,CACpC,cACF,CAEA,uCACE,gCAAoC,CACpC,4BACF,CAEA,8CACE,8BAAkC,CAClC,aACF,CAEA,sCACE,cACF,CAEA,mCACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,mCACE,YAAa,CACb,kBAAmB,CACnB,QACF,CAEA,kCACE,eAAgB,CAChB,gBACF,CAEA,iCACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,kCACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,wCACE,gBAAiB,CACjB,kCAAoC,CACpC,eACF,CAEA,2BACE,gBAAiB,CACjB,0BAA8B,CAC9B,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,eACF,CAEA,iCACE,YAAa,CACb,sCACF,CAEA,8BACE,gBAAiB,CACjB,0BAA8B,CAC9B,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,eAAgB,CAChB,eAAgB,CAChB,mBACF,CAEA,oCACE,YAAa,CACb,sCACF,CAEA,qCACE,gBACF,CAEA,iCACE,gBAAiB,CACjB,kCAAoC,CACpC,gBAAiB,CACjB,2BAA+B,CAC/B,iBAAkB,CAClB,iBACF,CAEA,sCACE,eAAgB,CAChB,gCAAoC,CACpC,iBAAkB,CAClB,qBAAsB,CACtB,gBACF,CAEA,oCACE,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,aACF,CAEA,0CACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,+CACE,gBAAiB,CACjB,eACF,CAEA,oCACE,YAAa,CACb,OAAQ,CACR,wBAAyB,CACzB,cACF,CAEA,8BACE,sBAAuB,CACvB,WAAY,CACZ,kCAAoC,CACpC,cAAe,CACf,eAAgB,CAChB,eAAgB,CAChB,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,oCACE,4BACF',sourcesContent:['<template>\n  <GcOverlay\n    :visible="visible"\n    title="提示词管理"\n    icon="fa-solid fa-file-lines"\n    panel-class="gc-prompts-panel"\n    @close="handleClose"\n  >\n    <template #header-actions>\n      <button class="gc-btn-link" @click="$emit(\'reset\')" title="重置为默认">\n        <i class="fa-solid fa-rotate-left"></i>\n      </button>\n    </template>\n\n    <div class="gc-prompts-content">\n      \x3c!-- 模板列表 --\x3e\n      <div v-if="!editingTemplate && !isCreating" class="gc-prompts-list">\n        <div class="gc-prompts-hint">\n          <i class="fa-solid fa-info-circle"></i>\n          <span>启用/禁用模板来自定义注入的提示词内容，点击模板可编辑</span>\n        </div>\n        \n        <div \n          v-for="template in templates" \n          :key="template.id" \n          class="gc-prompt-item"\n          :class="{ disabled: !template.enabled, builtin: template.builtin }"\n        >\n          <div class="gc-prompt-toggle">\n            <GcSwitch\n              :model-value="template.enabled"\n              size="sm"\n              @update:model-value="$emit(\'toggle\', template.id)"\n            />\n          </div>\n          \n          <div class="gc-prompt-info" @click="startEdit(template)">\n            <div class="gc-prompt-name">\n              <span>{{ template.name }}</span>\n              <GcBadge v-if="template.builtin" size="sm">内置</GcBadge>\n              <GcBadge v-else variant="custom" size="sm">自定义</GcBadge>\n              <span class="gc-prompt-type">{{ template.type }}</span>\n            </div>\n            <div class="gc-prompt-desc">{{ template.description }}</div>\n          </div>\n          \n          <div class="gc-prompt-actions">\n            <div class="gc-prompt-order-btns">\n              <button class="gc-btn-icon-xs" @click="$emit(\'move\', template.id, \'up\')" title="上移">\n                <i class="fa-solid fa-chevron-up"></i>\n              </button>\n              <button class="gc-btn-icon-xs" @click="$emit(\'move\', template.id, \'down\')" title="下移">\n                <i class="fa-solid fa-chevron-down"></i>\n              </button>\n            </div>\n            <button class="gc-btn-icon-sm" @click="startEdit(template)" title="编辑">\n              <i class="fa-solid fa-pen"></i>\n            </button>\n            <button \n              v-if="!template.builtin" \n              class="gc-btn-icon-sm danger" \n              @click="$emit(\'delete\', template.id, template.name)" \n              title="删除"\n            >\n              <i class="fa-solid fa-trash"></i>\n            </button>\n          </div>\n        </div>\n        \n        <GcButton class="gc-add-template-btn" @click="startCreate">\n          <i class="fa-solid fa-plus"></i> 新建自定义模板\n        </GcButton>\n      </div>\n\n      \x3c!-- 新建模板 --\x3e\n      <div v-else-if="isCreating" class="gc-prompt-editor">\n        <div class="gc-editor-header">\n          <button class="gc-btn-link" @click="cancelCreate">\n            <i class="fa-solid fa-arrow-left"></i> 返回列表\n          </button>\n          <span class="gc-editor-title">新建模板</span>\n        </div>\n        <div class="gc-editor-form">\n          <div class="gc-setting-item">\n            <label>模板名称 *</label>\n            <input v-model="newTemplate.name" type="text" class="gc-input" placeholder="输入模板名称" />\n          </div>\n          <div class="gc-setting-item">\n            <label>描述</label>\n            <input v-model="newTemplate.description" type="text" class="gc-input" placeholder="简短描述模板用途" />\n          </div>\n          <div class="gc-setting-item">\n            <label>模板类型</label>\n            <select v-model="newTemplate.type" class="gc-input">\n              <option value="header">header - 头部说明</option>\n              <option value="character">character - 角色数据（为每个角色生成）</option>\n              <option value="interaction">interaction - 互动限制</option>\n              <option value="rules">rules - 规则说明</option>\n              <option value="footer">footer - 尾部补充</option>\n            </select>\n          </div>\n          <div class="gc-setting-item">\n            <label>模板内容</label>\n            <div class="gc-editor-hint" v-pre>\n              支持变量: <code>{{角色名}}</code> <code>{{当前身高_格式化}}</code> <code>{{倍率}}</code> <code>{{级别}}</code> <code>{{描述}}</code> <code>{{身体数据}}</code> <code>{{相对参照}}</code> <code>{{互动限制列表}}</code>\n            </div>\n            <textarea \n              v-model="newTemplate.content" \n              class="gc-textarea gc-editor-textarea"\n              rows="10"\n              placeholder="输入模板内容..."\n            ></textarea>\n          </div>\n          <div class="gc-setting-toggle">\n            <label><span>默认启用</span></label>\n            <GcSwitch v-model="newTemplate.enabled" />\n          </div>\n          <div class="gc-editor-actions">\n            <GcButton @click="cancelCreate">取消</GcButton>\n            <GcButton variant="primary" @click="createTemplate">\n              <i class="fa-solid fa-plus"></i> 创建模板\n            </GcButton>\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- 模板编辑 --\x3e\n      <div v-else-if="editingTemplate" class="gc-prompt-editor">\n        <div class="gc-editor-header">\n          <button class="gc-btn-link" @click="cancelEdit">\n            <i class="fa-solid fa-arrow-left"></i> 返回列表\n          </button>\n          <span class="gc-editor-title">编辑: {{ editingTemplate.name }}</span>\n        </div>\n        <div class="gc-editor-form">\n          <div class="gc-setting-item">\n            <label>模板名称</label>\n            <input v-model="editingTemplate.name" type="text" class="gc-input" :disabled="editingTemplate.builtin" />\n          </div>\n          <div class="gc-setting-item">\n            <label>描述</label>\n            <input v-model="editingTemplate.description" type="text" class="gc-input" />\n          </div>\n          <div class="gc-setting-item">\n            <label>模板内容</label>\n            <div class="gc-editor-hint" v-pre>\n              支持变量: <code>{{角色名}}</code> <code>{{当前身高_格式化}}</code> <code>{{倍率}}</code> <code>{{级别}}</code> <code>{{描述}}</code> <code>{{身体数据}}</code> <code>{{相对参照}}</code> <code>{{互动限制列表}}</code>\n            </div>\n            <textarea \n              v-model="editingTemplate.content" \n              class="gc-textarea gc-editor-textarea"\n              rows="12"\n            ></textarea>\n          </div>\n          <div class="gc-editor-actions">\n            <GcButton @click="cancelEdit">取消</GcButton>\n            <GcButton variant="primary" @click="saveTemplate">\n              <i class="fa-solid fa-save"></i> 保存\n            </GcButton>\n          </div>\n        </div>\n      </div>\n    </div>\n  </GcOverlay>\n</template>\n\n<script setup lang="ts">\nimport { ref } from \'vue\';\nimport { GcOverlay, GcSwitch, GcButton, GcBadge } from \'../components\';\nimport type { PromptTemplate, PromptTemplateType } from \'../../types\';\n\ndefineProps<{\n  visible: boolean;\n  templates: PromptTemplate[];\n}>();\n\nconst emit = defineEmits<{\n  (e: \'close\'): void;\n  (e: \'reset\'): void;\n  (e: \'toggle\', id: string): void;\n  (e: \'move\', id: string, direction: \'up\' | \'down\'): void;\n  (e: \'delete\', id: string, name: string): void;\n  (e: \'create\', template: Omit<PromptTemplate, \'id\' | \'order\' | \'builtin\'>): void;\n  (e: \'save\', template: PromptTemplate): void;\n}>();\n\n// 内部状态\nconst isCreating = ref(false);\nconst editingTemplate = ref<PromptTemplate | null>(null);\nconst newTemplate = ref({\n  name: \'\',\n  description: \'\',\n  content: \'\',\n  type: \'footer\' as PromptTemplateType,\n  enabled: true,\n});\n\nconst startCreate = () => {\n  newTemplate.value = {\n    name: \'\',\n    description: \'\',\n    content: \'\',\n    type: \'footer\',\n    enabled: true,\n  };\n  isCreating.value = true;\n};\n\nconst cancelCreate = () => {\n  isCreating.value = false;\n};\n\nconst createTemplate = () => {\n  if (!newTemplate.value.name.trim()) {\n    toastr.warning(\'请输入模板名称\');\n    return;\n  }\n  emit(\'create\', {\n    name: newTemplate.value.name.trim(),\n    description: newTemplate.value.description.trim(),\n    content: newTemplate.value.content,\n    type: newTemplate.value.type,\n    enabled: newTemplate.value.enabled,\n  });\n  isCreating.value = false;\n};\n\nconst startEdit = (template: PromptTemplate) => {\n  editingTemplate.value = { ...template };\n};\n\nconst cancelEdit = () => {\n  editingTemplate.value = null;\n};\n\nconst saveTemplate = () => {\n  if (editingTemplate.value) {\n    emit(\'save\', editingTemplate.value);\n    editingTemplate.value = null;\n  }\n};\n\nconst handleClose = () => {\n  if (isCreating.value) {\n    isCreating.value = false;\n  }\n  if (editingTemplate.value) {\n    editingTemplate.value = null;\n  }\n  emit(\'close\');\n};\n<\/script>\n\n<style scoped>\n.gc-prompts-content {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.gc-prompts-hint {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 10px 12px;\n  background: rgba(59, 130, 246, 0.1);\n  border-radius: 6px;\n  font-size: 0.8em;\n  color: #60a5fa;\n  margin-bottom: 8px;\n}\n\n.gc-prompts-hint i {\n  font-size: 1.1em;\n}\n\n.gc-prompts-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.gc-prompt-item {\n  display: flex;\n  align-items: flex-start;\n  gap: 10px;\n  padding: 10px 12px;\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  transition: all 0.2s;\n}\n\n.gc-prompt-item:hover {\n  background: rgba(0, 0, 0, 0.3);\n}\n\n.gc-prompt-item.disabled {\n  opacity: 0.6;\n}\n\n.gc-prompt-toggle {\n  padding-top: 2px;\n}\n\n.gc-prompt-info {\n  flex: 1;\n  cursor: pointer;\n  min-width: 0;\n}\n\n.gc-prompt-name {\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n  gap: 6px;\n  margin-bottom: 4px;\n  font-weight: 500;\n  font-size: 0.9em;\n}\n\n.gc-prompt-type {\n  font-size: 0.75em;\n  color: var(--gc-text-muted, #94a3b8);\n  padding: 2px 6px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 4px;\n}\n\n.gc-prompt-desc {\n  font-size: 0.8em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-prompt-actions {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n\n.gc-prompt-order-btns {\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n}\n\n.gc-btn-icon-xs {\n  width: 20px;\n  height: 16px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(255, 255, 255, 0.05);\n  border: none;\n  border-radius: 3px;\n  color: var(--gc-text-muted, #94a3b8);\n  cursor: pointer;\n  font-size: 0.7em;\n}\n\n.gc-btn-icon-xs:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-btn-icon-sm {\n  width: 28px;\n  height: 28px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(255, 255, 255, 0.05);\n  border: none;\n  border-radius: 4px;\n  color: var(--gc-text-muted, #94a3b8);\n  cursor: pointer;\n}\n\n.gc-btn-icon-sm:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-btn-icon-sm.danger:hover {\n  background: rgba(239, 68, 68, 0.2);\n  color: #f87171;\n}\n\n.gc-add-template-btn {\n  margin-top: 8px;\n}\n\n.gc-prompt-editor {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.gc-editor-header {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.gc-editor-title {\n  font-weight: 600;\n  font-size: 0.95em;\n}\n\n.gc-editor-form {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.gc-setting-item {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.gc-setting-item label {\n  font-size: 0.85em;\n  color: var(--gc-text-muted, #94a3b8);\n  font-weight: 500;\n}\n\n.gc-input {\n  padding: 8px 10px;\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 6px;\n  color: var(--gc-text, #f1f5f9);\n  font-size: 0.9em;\n}\n\n.gc-input:focus {\n  outline: none;\n  border-color: var(--gc-primary, #f472b6);\n}\n\n.gc-textarea {\n  padding: 8px 10px;\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 6px;\n  color: var(--gc-text, #f1f5f9);\n  font-size: 0.9em;\n  resize: vertical;\n  font-family: inherit;\n}\n\n.gc-textarea:focus {\n  outline: none;\n  border-color: var(--gc-primary, #f472b6);\n}\n\n.gc-editor-textarea {\n  min-height: 200px;\n}\n\n.gc-editor-hint {\n  font-size: 0.75em;\n  color: var(--gc-text-muted, #94a3b8);\n  padding: 6px 10px;\n  background: rgba(0, 0, 0, 0.15);\n  border-radius: 4px;\n  margin-bottom: 6px;\n}\n\n.gc-editor-hint code {\n  padding: 1px 4px;\n  background: rgba(255, 255, 255, 0.1);\n  border-radius: 3px;\n  font-family: monospace;\n  font-size: 0.95em;\n}\n\n.gc-setting-toggle {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 0;\n}\n\n.gc-setting-toggle label {\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n}\n\n.gc-setting-toggle label span {\n  font-size: 0.85em;\n  font-weight: 500;\n}\n\n.gc-editor-actions {\n  display: flex;\n  gap: 8px;\n  justify-content: flex-end;\n  margin-top: 8px;\n}\n\n.gc-btn-link {\n  background: transparent;\n  border: none;\n  color: var(--gc-text-muted, #94a3b8);\n  cursor: pointer;\n  padding: 4px 8px;\n  font-size: 0.9em;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.gc-btn-link:hover {\n  color: var(--gc-text, #f1f5f9);\n}\n</style>\n'],sourceRoot:''}]);const s=o},601(e,n,a){var t=a(206);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('762a302c',t,!1,{ssrId:!0})},672(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-debug-section[data-v-22b96ac2]{padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;margin-bottom:12px}.gc-debug-section[data-v-22b96ac2]:last-child{margin-bottom:0}.gc-debug-section h3[data-v-22b96ac2]{display:flex;align-items:center;gap:8px;font-size:0.9em;font-weight:600;margin-bottom:10px;color:var(--gc-text,#f1f5f9)}.gc-debug-section h3 i[data-v-22b96ac2]{color:var(--gc-primary,#f472b6)}.gc-debug-json[data-v-22b96ac2]{background:rgba(0,0,0,0.3);border-radius:6px;padding:12px;font-family:\'Monaco\',\'Menlo\',monospace;font-size:0.75em;overflow-x:auto;max-height:300px;color:#a5f3fc;white-space:pre-wrap;word-break:break-all}\n','',{version:3,sources:['webpack://./src/ui/features/debug/DebugRawSection.vue'],names:[],mappings:'AAyBA,mCACE,YAAa,CACb,0BAA8B,CAC9B,iBAAkB,CAClB,kBACF,CAEA,8CACE,eACF,CAEA,sCACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,eAAgB,CAChB,eAAgB,CAChB,kBAAmB,CACnB,4BACF,CAEA,wCACE,+BACF,CAEA,gCACE,0BAA8B,CAC9B,iBAAkB,CAClB,YAAa,CACb,sCAAyC,CACzC,gBAAiB,CACjB,eAAgB,CAChB,gBAAiB,CACjB,aAAc,CACd,oBAAqB,CACrB,oBACF',sourcesContent:['<template>\n  <div class="gc-debug-raw-section">\n    <div class="gc-debug-section">\n      <h3><i class="fa-solid fa-database"></i> MVU 原始数据</h3>\n      <pre class="gc-debug-json">{{ JSON.stringify(mvuInfo.messageVariables, null, 2) }}</pre>\n    </div>\n    \n    <div class="gc-debug-section">\n      <h3><i class="fa-solid fa-cog"></i> 当前设置</h3>\n      <pre class="gc-debug-json">{{ JSON.stringify(settings, null, 2) }}</pre>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport type { MvuDebugInfo } from \'../../../services/debug\';\nimport type { Settings } from \'../../../types\';\n\ndefineProps<{\n  mvuInfo: MvuDebugInfo;\n  settings: Settings;\n}>();\n<\/script>\n\n<style scoped>\n.gc-debug-section {\n  padding: 12px;\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  margin-bottom: 12px;\n}\n\n.gc-debug-section:last-child {\n  margin-bottom: 0;\n}\n\n.gc-debug-section h3 {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.9em;\n  font-weight: 600;\n  margin-bottom: 10px;\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-debug-section h3 i {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-debug-json {\n  background: rgba(0, 0, 0, 0.3);\n  border-radius: 6px;\n  padding: 12px;\n  font-family: \'Monaco\', \'Menlo\', monospace;\n  font-size: 0.75em;\n  overflow-x: auto;\n  max-height: 300px;\n  color: #a5f3fc;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n</style>\n'],sourceRoot:''}]);const s=o},681(e,n,a){var t=a(590);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('aef8a866',t,!1,{ssrId:!0})},690(e,n,a){var t=a(801);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('205eba9a',t,!1,{ssrId:!0})},699(e){e.exports=function(e){var n=e[1],a=e[3];if(!a)return n;if('function'==typeof btoa){var t=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),i='sourceMappingURL=data:application/json;charset=utf-8;base64,'.concat(t),c='/*# '.concat(i,' */');return[n].concat([c]).join('\n')}return[n].join('\n')}},713(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-panel[data-v-2fd76fdc]{--gc-primary:#ec4899;--gc-bg:#0f172a;--gc-text:#f8fafc;--gc-text-muted:#94a3b8;--gc-border:rgba(255,255,255,0.08);--gc-radius:16px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:var(--gc-bg);border:1px solid var(--gc-border);border-radius:var(--gc-radius);margin-bottom:24px;color:var(--gc-text);box-shadow:0 4px 20px -5px rgba(0,0,0,0.3);position:relative;overflow:hidden;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);backdrop-filter:blur(10px)}.gc-panel.collapsed[data-v-2fd76fdc]{border-color:rgba(255,255,255,0.05);background:rgba(15,23,42,0.6)}.gc-header[data-v-2fd76fdc]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;cursor:pointer;background:linear-gradient(to right,rgba(255,255,255,0.03),transparent);border-bottom:1px solid transparent;transition:all 0.2s}.gc-panel:not(.collapsed) .gc-header[data-v-2fd76fdc]{border-bottom-color:var(--gc-border)}.gc-header[data-v-2fd76fdc]:hover{background:rgba(255,255,255,0.06)}.gc-header-title[data-v-2fd76fdc]{display:flex;align-items:center;gap:12px;font-weight:600;font-size:1.05em;color:var(--gc-text)}.gc-logo-wrapper[data-v-2fd76fdc]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:rgba(236,72,153,0.15);border-radius:8px;box-shadow:0 0 10px rgba(236,72,153,0.2)}.gc-logo-icon[data-v-2fd76fdc]{color:var(--gc-primary);font-size:1.1em}.gc-header-actions[data-v-2fd76fdc]{display:flex;align-items:center;gap:14px}.gc-toggle-icon[data-v-2fd76fdc]{color:var(--gc-text-muted);font-size:0.9em;transition:transform 0.2s}.gc-status-badge[data-v-2fd76fdc]{font-size:0.75em;padding:4px 10px;border-radius:6px;font-weight:500}.gc-status-badge.disabled[data-v-2fd76fdc]{background:rgba(239,68,68,0.15);color:#ef4444;border:1px solid rgba(239,68,68,0.2)}.gc-content[data-v-2fd76fdc]{padding:20px;position:relative;min-height:200px}.gc-content.has-overlay[data-v-2fd76fdc]{overflow:hidden}.gc-control-bar[data-v-2fd76fdc]{margin-bottom:16px}.gc-master-btn[data-v-2fd76fdc]{width:100%;padding:12px 16px;background:rgba(0,0,0,0.3);border:1px solid var(--gc-border);border-radius:12px;color:var(--gc-text-muted);cursor:pointer;display:flex;align-items:center;justify-content:space-between;gap:12px;font-size:1em;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);position:relative;overflow:hidden}.gc-master-btn[data-v-2fd76fdc]:hover{background:rgba(255,255,255,0.05);border-color:rgba(255,255,255,0.15)}.gc-master-btn.active[data-v-2fd76fdc]{background:linear-gradient(135deg,rgba(236,72,153,0.2) 0%,rgba(168,85,247,0.2) 100%);border-color:rgba(236,72,153,0.4);color:white;box-shadow:0 0 20px rgba(236,72,153,0.1)}.gc-master-btn.active[data-v-2fd76fdc]:hover{background:linear-gradient(135deg,rgba(236,72,153,0.25) 0%,rgba(168,85,247,0.25) 100%);border-color:rgba(236,72,153,0.5)}.gc-master-icon[data-v-2fd76fdc]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:8px;background:rgba(0,0,0,0.2);transition:all 0.3s}.gc-master-btn.active .gc-master-icon[data-v-2fd76fdc]{background:rgba(236,72,153,0.8);color:white;box-shadow:0 0 10px rgba(236,72,153,0.4)}.gc-master-status-dot[data-v-2fd76fdc]{width:8px;height:8px;border-radius:50%;background:#64748b;box-shadow:0 0 0 2px rgba(100,116,139,0.2);transition:all 0.3s}.gc-master-btn.active .gc-master-status-dot[data-v-2fd76fdc]{background:#10b981;box-shadow:0 0 0 2px rgba(16,185,129,0.3),0 0 10px rgba(16,185,129,0.5)}.gc-action-bar[data-v-2fd76fdc]{display:flex;gap:8px;margin-bottom:24px;justify-content:flex-end;align-items:center;padding:6px;background:rgba(0,0,0,0.2);border-radius:14px;border:1px solid rgba(255,255,255,0.05)}.gc-divider[data-v-2fd76fdc]{width:1px;height:20px;background:rgba(255,255,255,0.1);margin:0 4px}.gc-icon-btn[data-v-2fd76fdc]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:10px;border:none;background:transparent;color:var(--gc-text-muted,#94a3b8);cursor:pointer;transition:all 0.2s ease;padding:0;margin:0;box-shadow:none}.gc-icon-btn[data-v-2fd76fdc]:hover{background:rgba(255,255,255,0.08);color:var(--gc-text,#f8fafc)}.gc-icon-btn.active[data-v-2fd76fdc]{background:rgba(236,72,153,0.15);color:var(--gc-primary,#ec4899)}.gc-icon-btn.debug[data-v-2fd76fdc]{color:#fbbf24}.gc-icon-btn.debug[data-v-2fd76fdc]:hover{background:rgba(251,191,36,0.15)}.gc-icon-btn.debug.active[data-v-2fd76fdc]{background:rgba(251,191,36,0.2)}.gc-icon-btn.prompt[data-v-2fd76fdc]{color:#a78bfa}.gc-icon-btn.prompt[data-v-2fd76fdc]:hover{background:rgba(167,139,250,0.15)}.gc-icon-btn.prompt.active[data-v-2fd76fdc]{background:rgba(167,139,250,0.2)}.gc-icon-btn.worldview[data-v-2fd76fdc]{color:#c084fc}.gc-icon-btn.worldview[data-v-2fd76fdc]:hover{background:rgba(192,132,252,0.15)}.gc-icon-btn.worldview.active[data-v-2fd76fdc]{background:rgba(192,132,252,0.2)}.gc-main-area[data-v-2fd76fdc]{transition:opacity 0.2s}.gc-main-area.disabled[data-v-2fd76fdc]{opacity:0.5;pointer-events:none;filter:grayscale(1)}.gc-section[data-v-2fd76fdc]{margin-bottom:24px}.gc-section-header[data-v-2fd76fdc]{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;font-size:0.9em;font-weight:600;color:var(--gc-text-muted);text-transform:uppercase;letter-spacing:0.05em}.gc-section-header i[data-v-2fd76fdc]{color:var(--gc-primary);margin-right:8px}.gc-badge-count[data-v-2fd76fdc]{padding:2px 10px;background:rgba(255,255,255,0.08);border-radius:12px;font-size:0.85em;color:var(--gc-text);font-weight:500}\n','',{version:3,sources:['webpack://./src/ui/Panel.vue'],names:[],mappings:'AA+WA,2BACE,oBAAqB,CACrB,eAAgB,CAChB,iBAAkB,CAClB,uBAAwB,CACxB,kCAAsC,CACtC,gBAAiB,CAEjB,yEAA8E,CAC9E,uBAAwB,CACxB,iCAAkC,CAClC,8BAA+B,CAC/B,kBAAmB,CACnB,oBAAqB,CACrB,0CAA8C,CAC9C,iBAAkB,CAClB,eAAgB,CAChB,6CAAiD,CACjD,0BACF,CAEA,qCACE,mCAAuC,CACvC,6BACF,CAGA,4BACE,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,iBAAkB,CAClB,cAAe,CACf,uEAA6E,CAC7E,mCAAoC,CACpC,mBACF,CAEA,sDACE,oCACF,CAEA,kCACE,iCACF,CAEA,kCACE,YAAa,CACb,kBAAmB,CACnB,QAAS,CACT,eAAgB,CAChB,gBAAiB,CACjB,oBACF,CAEA,kCACE,UAAW,CACX,WAAY,CACZ,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,gCAAoC,CACpC,iBAAkB,CAClB,wCACF,CAEA,+BACE,uBAAwB,CACxB,eACF,CAEA,oCACE,YAAa,CACb,kBAAmB,CACnB,QACF,CAEA,iCACE,0BAA2B,CAC3B,eAAgB,CAChB,yBACF,CAEA,kCACE,gBAAiB,CACjB,gBAAiB,CACjB,iBAAkB,CAClB,eACF,CAEA,2CACE,+BAAmC,CACnC,aAAc,CACd,oCACF,CAGA,6BACE,YAAa,CACb,iBAAkB,CAClB,gBACF,CAEA,yCACE,eACF,CAGA,iCACE,kBACF,CAEA,gCACE,UAAW,CACX,iBAAkB,CAClB,0BAA8B,CAC9B,iCAAkC,CAClC,kBAAmB,CACnB,0BAA2B,CAC3B,cAAe,CACf,YAAa,CACb,kBAAmB,CACnB,6BAA8B,CAC9B,QAAS,CACT,aAAc,CACd,6CAAiD,CACjD,iBAAkB,CAClB,eACF,CAEA,sCACE,iCAAqC,CACrC,mCACF,CAEA,uCACE,oFAA6F,CAC7F,iCAAqC,CACrC,WAAY,CACZ,wCACF,CAEA,6CACE,sFAA+F,CAC/F,iCACF,CAEA,iCACE,UAAW,CACX,WAAY,CACZ,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,iBAAkB,CAClB,0BAA8B,CAC9B,mBACF,CAEA,uDACE,+BAAmC,CACnC,WAAY,CACZ,wCACF,CAEA,uCACE,SAAU,CACV,UAAW,CACX,iBAAkB,CAClB,kBAAmB,CACnB,0CAA8C,CAC9C,mBACF,CAEA,6DACE,kBAAmB,CACnB,uEACF,CAGA,gCACE,YAAa,CACb,OAAQ,CACR,kBAAmB,CACnB,wBAAyB,CACzB,kBAAmB,CACnB,WAAY,CACZ,0BAA8B,CAC9B,kBAAmB,CACnB,uCACF,CAEA,6BACE,SAAU,CACV,WAAY,CACZ,gCAAoC,CACpC,YACF,CAEA,8BACE,UAAW,CACX,WAAY,CACZ,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,kBAAmB,CACnB,WAAY,CACZ,sBAAuB,CACvB,kCAAoC,CACpC,cAAe,CACf,wBAAyB,CACzB,SAAU,CACV,QAAS,CACT,eACF,CAEA,oCACE,iCAAqC,CACrC,4BACF,CAEA,qCACE,gCAAoC,CACpC,+BACF,CAEA,oCAAqB,aAAgB,CACrC,0CAA2B,gCAAsC,CACjE,2CAA4B,+BAAqC,CAEjE,qCAAsB,aAAgB,CACtC,2CAA4B,iCAAuC,CACnE,4CAA6B,gCAAsC,CAEnE,wCAAyB,aAAgB,CACzC,8CAA+B,iCAAuC,CACtE,+CAAgC,gCAAsC,CAGtE,+BACE,uBACF,CAEA,wCACE,WAAY,CACZ,mBAAoB,CACpB,mBACF,CAGA,6BACE,kBACF,CAEA,oCACE,YAAa,CACb,kBAAmB,CACnB,6BAA8B,CAC9B,kBAAmB,CACnB,eAAgB,CAChB,eAAgB,CAChB,0BAA2B,CAC3B,wBAAyB,CACzB,qBACF,CAEA,sCACE,uBAAwB,CACxB,gBACF,CAEA,iCACE,gBAAiB,CACjB,iCAAqC,CACrC,kBAAmB,CACnB,gBAAiB,CACjB,oBAAqB,CACrB,eACF',sourcesContent:['<template>\n  <div class="gc-panel" :class="{ collapsed: isCollapsed }">\n    \x3c!-- 面板头部 --\x3e\n    <div class="gc-header" @click="togglePanel">\n      <div class="gc-header-title">\n        <div class="gc-logo-wrapper">\n          <i class="fa-solid fa-person-rays gc-logo-icon"></i>\n        </div>\n        <span>巨大娘计算器</span>\n      </div>\n      <div class="gc-header-actions">\n        <span v-if="!settings.enabled && !isCollapsed" class="gc-status-badge disabled">已禁用</span>\n        <i \n          class="fa-solid gc-toggle-icon"\n          :class="isCollapsed ? \'fa-chevron-right\' : \'fa-chevron-down\'"\n        ></i>\n      </div>\n    </div>\n\n    \x3c!-- 面板内容 --\x3e\n    <div v-show="!isCollapsed" class="gc-content" :class="{ \'has-overlay\': hasOverlay }">\n      \x3c!-- 总开关 --\x3e\n      <div class="gc-control-bar">\n        <button\n          class="gc-btn gc-master-btn"\n          :class="settings.enabled ? \'active\' : \'\'"\n          @click="toggleEnabled"\n        >\n          <div class="gc-master-icon">\n            <i class="fa-solid" :class="settings.enabled ? \'fa-bolt\' : \'fa-power-off\'"></i>\n          </div>\n          <span>{{ settings.enabled ? \'脚本已启用\' : \'脚本已禁用\' }}</span>\n          <div class="gc-master-status-dot"></div>\n        </button>\n      </div>\n      \n      \x3c!-- 功能按钮栏 --\x3e\n      <div class="gc-action-bar">\n        <button class="gc-icon-btn" @click="refreshCharacters" title="刷新数据">\n          <i class="fa-solid fa-rotate"></i>\n        </button>\n        <div class="gc-divider"></div>\n        <button \n          v-if="settings.debug" \n          class="gc-icon-btn debug" \n          @click="showDebug = !showDebug" \n          :class="{ active: showDebug }" \n          title="调试面板"\n        >\n          <i class="fa-solid fa-bug"></i>\n        </button>\n        <button class="gc-icon-btn prompt" @click="showPrompts = !showPrompts" :class="{ active: showPrompts }" title="提示词管理">\n          <i class="fa-solid fa-file-lines"></i>\n        </button>\n        <button class="gc-icon-btn worldview" @click="showWorldview = !showWorldview" :class="{ active: showWorldview }" title="世界观设定">\n          <i :class="currentWorldview?.icon || \'fa-solid fa-globe\'"></i>\n        </button>\n        <div class="gc-divider"></div>\n        <button class="gc-icon-btn" @click="showSettings = !showSettings" :class="{ active: showSettings }" title="设置">\n          <i class="fa-solid fa-gear"></i>\n        </button>\n        <button class="gc-icon-btn" @click="showHelp = !showHelp" :class="{ active: showHelp }" title="帮助">\n          <i class="fa-regular fa-circle-question"></i>\n        </button>\n      </div>\n\n      \x3c!-- 设置面板 --\x3e\n      <SettingsPanel\n        :visible="showSettings"\n        :settings="settings"\n        @close="showSettings = false"\n        @update:setting="updateSetting"\n      />\n\n      \x3c!-- 帮助面板 --\x3e\n      <HelpPanel\n        :visible="showHelp"\n        :version="VERSION"\n        :changelog="CHANGELOG"\n        @close="showHelp = false"\n      />\n\n      \x3c!-- 世界观面板 --\x3e\n      <WorldviewPanel\n        :visible="showWorldview"\n        :worldviews="worldviews"\n        :current-worldview="currentWorldview"\n        :current-worldview-id="currentWorldviewId"\n        :settings="settings"\n        @close="showWorldview = false"\n        @select="setCurrentWorldview"\n        @reset="resetWorldviews"\n        @update:setting="updateSetting"\n        @create="addWorldview"\n        @update="updateWorldview"\n        @delete="handleDeleteWorldview"\n      />\n\n      \x3c!-- 提示词面板 --\x3e\n      <PromptsPanel\n        :visible="showPrompts"\n        :templates="templates"\n        @close="showPrompts = false"\n        @toggle="toggleTemplate"\n        @move="moveTemplate"\n        @delete="handleDeleteTemplate"\n        @create="handleCreateTemplate"\n        @save="handleSaveTemplate"\n        @reset="resetPrompts"\n      />\n\n      \x3c!-- 调试面板 --\x3e\n      <DebugPanel\n        v-if="settings.debug"\n        :visible="showDebug"\n        :mvu-info="mvuInfo"\n        :logs="debugLogs"\n        :settings="settings"\n        :characters="charactersArray"\n        :test-name="testName"\n        :test-height="testHeight"\n        :test-original="testOriginal"\n        @close="showDebug = false"\n        @refresh="refreshMvuInfo"\n        @clear-logs="clearDebugLogs"\n        @update:testName="testName = $event"\n        @update:testHeight="testHeight = $event"\n        @update:testOriginal="testOriginal = $event"\n        @inject-test="doInjectTest"\n        @clear-test="doClearTest"\n        @quick-test="doQuickTest"\n        @save-damage="doSaveActualDamage"\n        @clear-damage="doClearActualDamage"\n      />\n\n      \x3c!-- 主要内容区 --\x3e\n      <div class="gc-main-area" :class="{ disabled: !settings.enabled }">\n        \n        \x3c!-- 快速计算器 --\x3e\n        <QuickCalc />\n\n        \x3c!-- 角色列表 --\x3e\n        <div class="gc-section">\n          <div class="gc-section-header">\n            <span><i class="fa-solid fa-users"></i> 角色列表</span>\n            <span class="gc-badge-count">{{ characters.size }}</span>\n          </div>\n          <CharacterList :characters="characters" :show-damage="settings.enableDamageCalculation" />\n        </div>\n\n        \x3c!-- 扩展计算系统 --\x3e\n        <ExtensionsPanel\n          :settings="settings"\n          :damage-summary="damageSummary"\n          :damage-scenarios="damageScenariosList"\n          @toggle-damage="onDamageToggle"\n          @update:setting="updateSetting"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { ref, computed, watch } from \'vue\';\nimport { storeToRefs } from \'pinia\';\nimport { useSettingsStore, DAMAGE_SCENARIOS } from \'../settings\';\nimport { useCharactersStore } from \'../characters\';\nimport { usePromptsStore, type PromptTemplate } from \'../prompts\';\nimport { useWorldviewsStore, type Worldview } from \'../worldviews\';\nimport { getMvuDebugInfo, injectTestData, clearTestData, type MvuDebugInfo } from \'../mvu集成\';\nimport { VERSION, CHANGELOG } from \'../version\';\n\n// 面板组件\nimport { SettingsPanel, HelpPanel, WorldviewPanel, PromptsPanel, DebugPanel, ExtensionsPanel } from \'./panels\';\nimport QuickCalc from \'./features/QuickCalc.vue\';\nimport CharacterList from \'./CharacterList.vue\';\n\nimport type { Settings } from \'../types\';\n\n// ========== Stores ==========\nconst settingsStore = useSettingsStore();\nconst { settings, debugLogs } = storeToRefs(settingsStore);\nconst { toggle: toggleEnabled, clearDebugLogs } = settingsStore;\n\nconst charactersStore = useCharactersStore();\nconst { characters } = storeToRefs(charactersStore);\nconst { refresh: refreshCharacters, recalculateDamage, getDamageSummary } = charactersStore;\n\nconst promptsStore = usePromptsStore();\nconst { templates } = storeToRefs(promptsStore);\nconst { toggleTemplate, updateTemplate, addTemplate, removeTemplate, moveTemplate, resetToDefaults: resetPrompts } = promptsStore;\n\nconst worldviewsStore = useWorldviewsStore();\nconst { worldviews, currentWorldviewId } = storeToRefs(worldviewsStore);\nconst { setCurrentWorldview, addWorldview, updateWorldview, removeWorldview, resetToDefaults: resetWorldviews } = worldviewsStore;\nconst currentWorldview = computed(() => worldviewsStore.currentWorldview);\n\n// ========== UI 状态 ==========\nconst isCollapsed = ref(false);\nconst showSettings = ref(false);\nconst showHelp = ref(false);\nconst showDebug = ref(false);\nconst showPrompts = ref(false);\nconst showWorldview = ref(false);\n\nconst hasOverlay = computed(() => \n  showSettings.value || showHelp.value || showDebug.value || showPrompts.value || showWorldview.value\n);\n\nconst togglePanel = (e: MouseEvent) => {\n  if ((e.target as HTMLElement).closest(\'.gc-header-actions\')) return;\n  isCollapsed.value = !isCollapsed.value;\n};\n\n// ========== 设置处理 ==========\n// 接受 unknown 类型，与子组件 emit 类型兼容\nconst updateSetting = (key: keyof Settings, value: unknown) => {\n  (settings.value as Record<keyof Settings, unknown>)[key] = value;\n};\n\n// ========== 损害计算 ==========\nconst damageSummary = computed(() => getDamageSummary());\n\nconst damageScenariosList = computed(() => \n  DAMAGE_SCENARIOS.map(id => ({\n    id,\n    name: id,\n    density: getDensityForScenario(id),\n  }))\n);\n\nfunction getDensityForScenario(id: string): number {\n  const densities: Record<string, number> = {\n    \'荒野\': 1,\n    \'乡村\': 50,\n    \'郊区\': 500,\n    \'小城市\': 2000,\n    \'中等城市\': 5000,\n    \'大城市\': 10000,\n    \'超大城市中心\': 25000,\n    \'东京市中心\': 15000,\n    \'香港\': 26000,\n    \'马尼拉\': 43000,\n  };\n  return densities[id] || 5000;\n}\n\nconst onDamageToggle = (enabled: boolean) => {\n  settings.value.enableDamageCalculation = enabled;\n  if (enabled) {\n    recalculateDamage();\n    toastr.success(\'损害计算已启用\');\n  } else {\n    toastr.info(\'损害计算已禁用\');\n  }\n};\n\n// ========== 提示词处理 ==========\nconst handleSaveTemplate = (template: PromptTemplate) => {\n  updateTemplate(template.id, template);\n  toastr.success(`模板 "${template.name}" 已保存`);\n};\n\nconst handleCreateTemplate = (template: Omit<PromptTemplate, \'id\' | \'order\' | \'builtin\'>) => {\n  addTemplate(template);\n  toastr.success(`模板 "${template.name}" 已创建`);\n};\n\nconst handleDeleteTemplate = (id: string, name: string) => {\n  if (confirm(`确定要删除模板 "${name}" 吗？`)) {\n    removeTemplate(id);\n    toastr.success(`模板 "${name}" 已删除`);\n  }\n};\n\n// ========== 世界观处理 ==========\nconst handleDeleteWorldview = (id: string | undefined, name: string | undefined) => {\n  if (id && name && confirm(`确定要删除世界观 "${name}" 吗？`)) {\n    removeWorldview(id);\n    toastr.success(`世界观 "${name}" 已删除`);\n  }\n};\n\n// ========== 调试功能 ==========\nconst mvuInfo = ref<MvuDebugInfo>(getMvuDebugInfo());\nconst testName = ref(\'测试角色\');\nconst testHeight = ref(100);\nconst testOriginal = ref(1.65);\n\nconst refreshMvuInfo = () => {\n  mvuInfo.value = getMvuDebugInfo();\n  settingsStore.debugLog(\'🔄 已刷新 MVU 状态\');\n};\n\n// 直接使用 values()，因为 CharacterData 已经包含 name 属性\nconst charactersArray = computed(() => \n  Array.from(characters.value.values())\n);\n\nconst doInjectTest = () => {\n  if (!testName.value) {\n    toastr.warning(\'请输入角色名\');\n    return;\n  }\n  const result = injectTestData(testName.value, testHeight.value, testOriginal.value);\n  if (result.success) {\n    toastr.success(`已注入测试数据: ${testName.value}`);\n    setTimeout(() => { refreshMvuInfo(); refreshCharacters(); }, 500);\n  } else {\n    toastr.error(`注入失败: ${result.error}`);\n  }\n};\n\nconst doQuickTest = (params: { name: string; height: number; original: number }) => {\n  const result = injectTestData(params.name, params.height, params.original);\n  if (result.success) {\n    toastr.success(`已注入测试数据: ${params.name}`);\n    setTimeout(() => { refreshMvuInfo(); refreshCharacters(); }, 500);\n  } else {\n    toastr.error(`注入失败: ${result.error}`);\n  }\n};\n\nconst doClearTest = (name?: string) => {\n  const result = clearTestData(name);\n  if (result.success) {\n    toastr.success(name ? `已清除角色: ${name}` : \'已清除所有测试数据\');\n    setTimeout(() => { refreshMvuInfo(); refreshCharacters(); }, 300);\n  } else {\n    toastr.error(`清除失败: ${result.error}`);\n  }\n};\n\nconst doSaveActualDamage = (params: { name: string; data: unknown }) => {\n  // 保存实际损害数据\n  try {\n    const prefix = settings.value.variablePrefix;\n    const variables = getVariables({ type: \'message\', message_id: \'latest\' });\n    _.set(variables, `stat_data.${prefix}.${params.name}._实际损害`, params.data);\n    insertOrAssignVariables(variables, { type: \'message\', message_id: \'latest\' });\n    toastr.success(`已保存 ${params.name} 的实际损害数据`);\n    setTimeout(() => { refreshMvuInfo(); refreshCharacters(); }, 300);\n  } catch (e) {\n    toastr.error(`保存失败: ${e}`);\n  }\n};\n\nconst doClearActualDamage = (name: string) => {\n  try {\n    const prefix = settings.value.variablePrefix;\n    deleteVariable(`stat_data.${prefix}.${name}._实际损害`, { type: \'message\', message_id: \'latest\' });\n    toastr.success(`已清除 ${name} 的实际损害数据`);\n    setTimeout(() => { refreshMvuInfo(); refreshCharacters(); }, 300);\n  } catch (e) {\n    toastr.error(`清除失败: ${e}`);\n  }\n};\n\n// 打开调试面板时自动刷新\nwatch(showDebug, (val) => {\n  if (val) refreshMvuInfo();\n});\n<\/script>\n\n<style scoped>\n/* ========== CSS 变量 ========== */\n.gc-panel {\n  --gc-primary: #ec4899;\n  --gc-bg: #0f172a;\n  --gc-text: #f8fafc;\n  --gc-text-muted: #94a3b8;\n  --gc-border: rgba(255, 255, 255, 0.08);\n  --gc-radius: 16px;\n  \n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;\n  background: var(--gc-bg);\n  border: 1px solid var(--gc-border);\n  border-radius: var(--gc-radius);\n  margin-bottom: 24px;\n  color: var(--gc-text);\n  box-shadow: 0 4px 20px -5px rgba(0, 0, 0, 0.3);\n  position: relative;\n  overflow: hidden;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  backdrop-filter: blur(10px);\n}\n\n.gc-panel.collapsed {\n  border-color: rgba(255, 255, 255, 0.05);\n  background: rgba(15, 23, 42, 0.6);\n}\n\n/* ========== 头部 ========== */\n.gc-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  cursor: pointer;\n  background: linear-gradient(to right, rgba(255, 255, 255, 0.03), transparent);\n  border-bottom: 1px solid transparent;\n  transition: all 0.2s;\n}\n\n.gc-panel:not(.collapsed) .gc-header {\n  border-bottom-color: var(--gc-border);\n}\n\n.gc-header:hover {\n  background: rgba(255, 255, 255, 0.06);\n}\n\n.gc-header-title {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  font-weight: 600;\n  font-size: 1.05em;\n  color: var(--gc-text);\n}\n\n.gc-logo-wrapper {\n  width: 32px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(236, 72, 153, 0.15);\n  border-radius: 8px;\n  box-shadow: 0 0 10px rgba(236, 72, 153, 0.2);\n}\n\n.gc-logo-icon {\n  color: var(--gc-primary);\n  font-size: 1.1em;\n}\n\n.gc-header-actions {\n  display: flex;\n  align-items: center;\n  gap: 14px;\n}\n\n.gc-toggle-icon {\n  color: var(--gc-text-muted);\n  font-size: 0.9em;\n  transition: transform 0.2s;\n}\n\n.gc-status-badge {\n  font-size: 0.75em;\n  padding: 4px 10px;\n  border-radius: 6px;\n  font-weight: 500;\n}\n\n.gc-status-badge.disabled {\n  background: rgba(239, 68, 68, 0.15);\n  color: #ef4444;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n/* ========== 内容区 ========== */\n.gc-content {\n  padding: 20px;\n  position: relative;\n  min-height: 200px;\n}\n\n.gc-content.has-overlay {\n  overflow: hidden;\n}\n\n/* ========== 控制栏 ========== */\n.gc-control-bar {\n  margin-bottom: 16px;\n}\n\n.gc-master-btn {\n  width: 100%;\n  padding: 12px 16px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid var(--gc-border);\n  border-radius: 12px;\n  color: var(--gc-text-muted);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 12px;\n  font-size: 1em;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  position: relative;\n  overflow: hidden;\n}\n\n.gc-master-btn:hover {\n  background: rgba(255, 255, 255, 0.05);\n  border-color: rgba(255, 255, 255, 0.15);\n}\n\n.gc-master-btn.active {\n  background: linear-gradient(135deg, rgba(236, 72, 153, 0.2) 0%, rgba(168, 85, 247, 0.2) 100%);\n  border-color: rgba(236, 72, 153, 0.4);\n  color: white;\n  box-shadow: 0 0 20px rgba(236, 72, 153, 0.1);\n}\n\n.gc-master-btn.active:hover {\n  background: linear-gradient(135deg, rgba(236, 72, 153, 0.25) 0%, rgba(168, 85, 247, 0.25) 100%);\n  border-color: rgba(236, 72, 153, 0.5);\n}\n\n.gc-master-icon {\n  width: 32px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 8px;\n  background: rgba(0, 0, 0, 0.2);\n  transition: all 0.3s;\n}\n\n.gc-master-btn.active .gc-master-icon {\n  background: rgba(236, 72, 153, 0.8);\n  color: white;\n  box-shadow: 0 0 10px rgba(236, 72, 153, 0.4);\n}\n\n.gc-master-status-dot {\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  background: #64748b;\n  box-shadow: 0 0 0 2px rgba(100, 116, 139, 0.2);\n  transition: all 0.3s;\n}\n\n.gc-master-btn.active .gc-master-status-dot {\n  background: #10b981;\n  box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.3), 0 0 10px rgba(16, 185, 129, 0.5);\n}\n\n/* ========== 按钮栏 ========== */\n.gc-action-bar {\n  display: flex;\n  gap: 8px;\n  margin-bottom: 24px;\n  justify-content: flex-end;\n  align-items: center;\n  padding: 6px;\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 14px;\n  border: 1px solid rgba(255, 255, 255, 0.05);\n}\n\n.gc-divider {\n  width: 1px;\n  height: 20px;\n  background: rgba(255, 255, 255, 0.1);\n  margin: 0 4px;\n}\n\n.gc-icon-btn {\n  width: 36px;\n  height: 36px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 10px;\n  border: none;\n  background: transparent;\n  color: var(--gc-text-muted, #94a3b8);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  padding: 0;\n  margin: 0;\n  box-shadow: none;\n}\n\n.gc-icon-btn:hover {\n  background: rgba(255, 255, 255, 0.08);\n  color: var(--gc-text, #f8fafc);\n}\n\n.gc-icon-btn.active {\n  background: rgba(236, 72, 153, 0.15);\n  color: var(--gc-primary, #ec4899);\n}\n\n.gc-icon-btn.debug { color: #fbbf24; }\n.gc-icon-btn.debug:hover { background: rgba(251, 191, 36, 0.15); }\n.gc-icon-btn.debug.active { background: rgba(251, 191, 36, 0.2); }\n\n.gc-icon-btn.prompt { color: #a78bfa; }\n.gc-icon-btn.prompt:hover { background: rgba(167, 139, 250, 0.15); }\n.gc-icon-btn.prompt.active { background: rgba(167, 139, 250, 0.2); }\n\n.gc-icon-btn.worldview { color: #c084fc; }\n.gc-icon-btn.worldview:hover { background: rgba(192, 132, 252, 0.15); }\n.gc-icon-btn.worldview.active { background: rgba(192, 132, 252, 0.2); }\n\n/* ========== 主区域 ========== */\n.gc-main-area {\n  transition: opacity 0.2s;\n}\n\n.gc-main-area.disabled {\n  opacity: 0.5;\n  pointer-events: none;\n  filter: grayscale(1);\n}\n\n/* ========== 区块 ========== */\n.gc-section {\n  margin-bottom: 24px;\n}\n\n.gc-section-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 12px;\n  font-size: 0.9em;\n  font-weight: 600;\n  color: var(--gc-text-muted);\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n}\n\n.gc-section-header i {\n  color: var(--gc-primary);\n  margin-right: 8px;\n}\n\n.gc-badge-count {\n  padding: 2px 10px;\n  background: rgba(255, 255, 255, 0.08);\n  border-radius: 12px;\n  font-size: 0.85em;\n  color: var(--gc-text);\n  font-weight: 500;\n}\n</style>\n'],sourceRoot:''}]);const s=o},721(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-char-item[data-v-f94d7aac]{background:rgba(255,255,255,0.03);border:1px solid var(--gc-border,rgba(255,255,255,0.08));border-radius:12px;overflow:hidden;cursor:pointer;transition:all 0.2s cubic-bezier(0.4,0,0.2,1);margin-bottom:12px}.gc-char-item[data-v-f94d7aac]:hover{background:rgba(255,255,255,0.06);border-color:rgba(255,255,255,0.15);transform:translateY(-1px)}.gc-char-item.expanded[data-v-f94d7aac]{background:rgba(15,23,42,0.6);border-color:var(--gc-primary-border,rgba(236,72,153,0.4));box-shadow:0 10px 30px -10px rgba(0,0,0,0.3);transform:translateY(-2px)}.gc-char-item.has-damage[data-v-f94d7aac]{border-left:3px solid rgba(249,115,22,0.4)}.gc-char-item.has-damage.expanded[data-v-f94d7aac]{border-left-color:#f97316}.gc-char-header[data-v-f94d7aac]{padding:14px;display:flex;align-items:center;gap:16px}.gc-char-avatar[data-v-f94d7aac]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.4em;flex-shrink:0;background:rgba(255,255,255,0.05);color:#94a3b8;transition:all 0.3s}.gc-char-avatar.giant[data-v-f94d7aac]{background:linear-gradient(135deg,rgba(249,115,22,0.2),rgba(239,68,68,0.2));color:#f97316;box-shadow:0 0 15px rgba(249,115,22,0.1)}.gc-char-avatar.tiny[data-v-f94d7aac]{background:linear-gradient(135deg,rgba(59,130,246,0.2),rgba(99,102,241,0.2));color:#60a5fa;box-shadow:0 0 15px rgba(59,130,246,0.1)}.gc-char-info[data-v-f94d7aac]{flex:1;min-width:0}.gc-char-name[data-v-f94d7aac]{font-weight:600;font-size:1.05em;color:#f1f5f9;display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.gc-char-expand-icon[data-v-f94d7aac]{font-size:0.8em;color:#94a3b8;transition:transform 0.3s cubic-bezier(0.4,0,0.2,1);opacity:0.5}.gc-char-item:hover .gc-char-expand-icon[data-v-f94d7aac]{opacity:1}.gc-char-item.expanded .gc-char-expand-icon[data-v-f94d7aac]{transform:rotate(90deg);color:var(--gc-primary,#ec4899)}.gc-char-stats[data-v-f94d7aac]{display:flex;align-items:center;gap:10px;font-size:0.9em}.gc-stat-height[data-v-f94d7aac]{color:#e2e8f0;font-weight:500}.gc-stat-unknown[data-v-f94d7aac]{color:#64748b;font-style:italic}.gc-stat-multiplier[data-v-f94d7aac]{color:#94a3b8;font-family:var(--gc-font-mono);background:rgba(255,255,255,0.05);padding:1px 6px;border-radius:4px;font-size:0.85em}.gc-level-badge[data-v-f94d7aac]{padding:4px 10px;border-radius:8px;font-size:0.75em;font-weight:700;text-transform:uppercase;background:rgba(255,255,255,0.05);color:#94a3b8;letter-spacing:0.05em}.gc-level-badge.giant[data-v-f94d7aac]{background:rgba(249,115,22,0.15);color:#f97316}.gc-level-badge.tiny[data-v-f94d7aac]{background:rgba(59,130,246,0.15);color:#60a5fa}.gc-damage-indicator[data-v-f94d7aac]{display:inline-flex;align-items:center;gap:4px;font-size:0.8em;padding:2px 8px;background:rgba(249,115,22,0.1);color:#fb923c;border-radius:6px;border:1px solid rgba(249,115,22,0.2)}.gc-char-details[data-v-f94d7aac]{border-top:1px solid rgba(255,255,255,0.05);background:rgba(0,0,0,0.15);padding:20px;animation:slideDown-f94d7aac 0.3s cubic-bezier(0.4,0,0.2,1);max-height:450px;overflow-y:auto}.gc-char-details[data-v-f94d7aac]::-webkit-scrollbar{width:4px}.gc-char-details[data-v-f94d7aac]::-webkit-scrollbar-track{background:transparent}.gc-char-details[data-v-f94d7aac]::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.1);border-radius:2px}.gc-char-details[data-v-f94d7aac]::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,0.2)}@keyframes slideDown-f94d7aac{from{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.gc-char-details-grid[data-v-f94d7aac]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:20px}.gc-detail-section[data-v-f94d7aac]{background:rgba(255,255,255,0.02);border-radius:8px;padding:12px;border:1px solid transparent}.gc-detail-section[data-v-f94d7aac]:hover{background:rgba(255,255,255,0.04);border-color:rgba(255,255,255,0.05)}.gc-detail-section.full-width[data-v-f94d7aac]{grid-column:1/-1}.gc-detail-section-title[data-v-f94d7aac]{font-size:0.8em;font-weight:700;color:#94a3b8;margin-bottom:12px;text-transform:uppercase;letter-spacing:0.05em;display:flex;align-items:center;gap:8px}.gc-detail-section-title i[data-v-f94d7aac]{color:var(--gc-primary,#ec4899)}.gc-detail-row[data-v-f94d7aac]{display:flex;justify-content:space-between;align-items:baseline;font-size:0.9em;padding:6px 0;border-bottom:1px dashed rgba(255,255,255,0.05)}.gc-detail-row[data-v-f94d7aac]:last-child{border-bottom:none}.gc-detail-label[data-v-f94d7aac]{color:#64748b}.gc-detail-value[data-v-f94d7aac]{color:#e2e8f0;font-family:var(--gc-font-mono);font-weight:500}.gc-history-list[data-v-f94d7aac]{display:flex;flex-direction:column;gap:8px}.gc-history-item[data-v-f94d7aac]{display:flex;gap:12px;font-size:0.9em;padding:8px 12px;background:rgba(0,0,0,0.2);border-radius:6px;align-items:center}.gc-history-time[data-v-f94d7aac]{color:#64748b;font-family:var(--gc-font-mono);font-size:0.85em}.gc-history-content[data-v-f94d7aac]{flex:1;display:flex;gap:10px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;align-items:center}.gc-history-height[data-v-f94d7aac]{color:#f1f5f9;font-weight:600}.gc-history-reason[data-v-f94d7aac]{color:#94a3b8;font-size:0.9em;opacity:0.8}\n','',{version:3,sources:['webpack://./src/ui/features/CharacterCard.vue'],names:[],mappings:'AA8LA,+BACE,iCAAqC,CACrC,wDAA6D,CAC7D,kBAAmB,CACnB,eAAgB,CAChB,cAAe,CACf,6CAAiD,CACjD,kBACF,CAEA,qCACE,iCAAqC,CACrC,mCAAuC,CACvC,0BACF,CAEA,wCACE,6BAAiC,CACjC,0DAA+D,CAC/D,4CAAgD,CAChD,0BACF,CAEA,0CACE,0CACF,CAEA,mDACE,yBACF,CAEA,iCACE,YAAa,CACb,YAAa,CACb,kBAAmB,CACnB,QACF,CAEA,iCACE,UAAW,CACX,WAAY,CACZ,kBAAmB,CACnB,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,eAAgB,CAChB,aAAc,CACd,iCAAqC,CACrC,aAAc,CACd,mBACF,CAEA,uCACE,2EAAoF,CACpF,aAAc,CACd,wCACF,CAEA,sCACE,4EAAqF,CACrF,aAAc,CACd,wCACF,CAEA,+BACE,MAAO,CACP,WACF,CAEA,+BACE,eAAgB,CAChB,gBAAiB,CACjB,aAAc,CACd,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,iBACF,CAEA,sCACE,eAAgB,CAChB,aAAc,CACd,mDAAuD,CACvD,WACF,CAEA,0DACE,SACF,CAEA,6DACE,uBAAwB,CACxB,+BACF,CAEA,gCACE,YAAa,CACb,kBAAmB,CACnB,QAAS,CACT,eACF,CAEA,iCACE,aAAc,CACd,eACF,CAEA,kCACE,aAAc,CACd,iBACF,CAEA,qCACE,aAAc,CACd,+BAAgC,CAChC,iCAAqC,CACrC,eAAgB,CAChB,iBAAkB,CAClB,gBACF,CAEA,iCACE,gBAAiB,CACjB,iBAAkB,CAClB,gBAAiB,CACjB,eAAgB,CAChB,wBAAyB,CACzB,iCAAqC,CACrC,aAAc,CACd,qBACF,CAEA,uCACE,gCAAoC,CACpC,aACF,CAEA,sCACE,gCAAoC,CACpC,aACF,CAGA,sCACE,mBAAoB,CACpB,kBAAmB,CACnB,OAAQ,CACR,eAAgB,CAChB,eAAgB,CAChB,+BAAmC,CACnC,aAAc,CACd,iBAAkB,CAClB,qCACF,CAGA,kCACE,2CAA+C,CAC/C,2BAA+B,CAC/B,YAAa,CACb,2DAAsD,CACtD,gBAAiB,CACjB,eACF,CAEA,qDACE,SACF,CAEA,2DACE,sBACF,CAEA,2DACE,gCAAoC,CACpC,iBACF,CAEA,iEACE,gCACF,CAEA,8BACE,KACE,SAAU,CACV,0BACF,CACA,GACE,SAAU,CACV,uBACF,CACF,CAEA,uCACE,YAAa,CACb,wDAA2D,CAC3D,QACF,CAEA,oCACE,iCAAqC,CACrC,iBAAkB,CAClB,YAAa,CACb,4BACF,CAEA,0CACE,iCAAqC,CACrC,mCACF,CAEA,+CACE,gBACF,CAEA,0CACE,eAAgB,CAChB,eAAgB,CAChB,aAAc,CACd,kBAAmB,CACnB,wBAAyB,CACzB,qBAAsB,CACtB,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,4CACE,+BACF,CAEA,gCACE,YAAa,CACb,6BAA8B,CAC9B,oBAAqB,CACrB,eAAgB,CAChB,aAAc,CACd,+CACF,CAEA,2CACE,kBACF,CAEA,kCACE,aACF,CAEA,kCACE,aAAc,CACd,+BAAgC,CAChC,eACF,CAGA,kCACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,kCACE,YAAa,CACb,QAAS,CACT,eAAgB,CAChB,gBAAiB,CACjB,0BAA8B,CAC9B,iBAAkB,CAClB,kBACF,CAEA,kCACE,aAAc,CACd,+BAAgC,CAChC,gBACF,CAEA,qCACE,MAAO,CACP,YAAa,CACb,QAAS,CACT,eAAgB,CAChB,sBAAuB,CACvB,kBAAmB,CACnB,kBACF,CAEA,oCACE,aAAc,CACd,eACF,CAEA,oCACE,aAAc,CACd,eAAgB,CAChB,WACF',sourcesContent:['<template>\n  <div\n    class="gc-char-item"\n    :class="{ expanded: isExpanded, \'has-damage\': showDamage && data.damageData }"\n    @click="toggleExpand"\n  >\n    <div class="gc-char-header">\n      <div class="gc-char-avatar" :class="avatarClass">\n        <i :class="avatarIcon"></i>\n      </div>\n      \n      <div class="gc-char-info">\n        <div class="gc-char-name">\n          {{ name }}\n          <i class="fa-solid fa-chevron-right gc-char-expand-icon"></i>\n        </div>\n        <div class="gc-char-stats">\n          <span v-if="data.calcData" class="gc-stat-height">\n            {{ data.calcData.当前身高_格式化 }}\n          </span>\n          <span v-else class="gc-stat-unknown">未设置</span>\n          \n          <span v-if="data.calcData" class="gc-stat-multiplier">\n            ×{{ data.calcData.倍率 }}\n          </span>\n          \n          \x3c!-- 损害等级指示器 --\x3e\n          <span \n            v-if="showDamage && data.damageData" \n            class="gc-damage-indicator"\n            :title="`破坏力: ${data.damageData.破坏力等级}`"\n          >\n            <i class="fa-solid fa-explosion"></i>\n            {{ data.damageData.破坏力等级 }}\n          </span>\n        </div>\n      </div>\n      \n      <span v-if="data.calcData" class="gc-level-badge" :class="levelBadgeClass">\n        {{ data.calcData.级别 }}\n      </span>\n    </div>\n\n    \x3c!-- 展开详情 --\x3e\n    <div v-if="isExpanded && data.calcData" class="gc-char-details">\n      <div class="gc-char-details-grid">\n        \x3c!-- 基础数据 --\x3e\n        <div class="gc-detail-section">\n          <div class="gc-detail-section-title">\n            <i class="fa-solid fa-ruler-combined"></i> 基础数据\n          </div>\n          <div class="gc-detail-row">\n            <span class="gc-detail-label">原身高</span>\n            <span class="gc-detail-value">{{ data.calcData.原身高 }}m</span>\n          </div>\n          <div class="gc-detail-row">\n            <span class="gc-detail-label">当前身高</span>\n            <span class="gc-detail-value">{{ data.calcData.当前身高_格式化 }}</span>\n          </div>\n          <div class="gc-detail-row">\n            <span class="gc-detail-label">倍率</span>\n            <span class="gc-detail-value">×{{ data.calcData.倍率 }}</span>\n          </div>\n          <div class="gc-detail-row">\n            <span class="gc-detail-label">级别</span>\n            <span class="gc-detail-value">{{ data.calcData.级别 }}</span>\n          </div>\n        </div>\n\n        \x3c!-- 身体部位（巨大娘） --\x3e\n        <template v-if="\'身体部位_格式化\' in data.calcData">\n          <div class="gc-detail-section">\n            <div class="gc-detail-section-title">\n              <i class="fa-solid fa-person"></i> 关键部位\n            </div>\n            <template v-for="part in keyBodyParts" :key="part">\n              <div v-if="(data.calcData as any).身体部位_格式化[part]" class="gc-detail-row">\n                <span class="gc-detail-label">{{ part }}</span>\n                <span class="gc-detail-value">{{ (data.calcData as any).身体部位_格式化[part] }}</span>\n              </div>\n            </template>\n          </div>\n        </template>\n\n        \x3c!-- 眼中的世界（巨大娘） --\x3e\n        <template v-if="\'眼中的世界_格式化\' in data.calcData">\n          <div class="gc-detail-section">\n            <div class="gc-detail-section-title">\n              <i class="fa-solid fa-eye"></i> 她眼中的世界\n            </div>\n            <template v-for="obj in keyObjects" :key="obj">\n              <div v-if="(data.calcData as any).眼中的世界_格式化[obj]" class="gc-detail-row">\n                <span class="gc-detail-label">{{ obj }}</span>\n                <span class="gc-detail-value">{{ (data.calcData as any).眼中的世界_格式化[obj] }}</span>\n              </div>\n            </template>\n          </div>\n        </template>\n\n        \x3c!-- 眼中的巨大娘（小人） --\x3e\n        <template v-if="\'眼中的巨大娘_格式化\' in data.calcData">\n          <div class="gc-detail-section">\n            <div class="gc-detail-section-title">\n              <i class="fa-solid fa-eye"></i> 眼中的巨大娘\n            </div>\n            <template v-for="part in keyGiantessParts" :key="part">\n              <div v-if="(data.calcData as any).眼中的巨大娘_格式化[part]" class="gc-detail-row">\n                <span class="gc-detail-label">{{ part }}</span>\n                <span class="gc-detail-value">{{ (data.calcData as any).眼中的巨大娘_格式化[part] }}</span>\n              </div>\n            </template>\n          </div>\n        </template>\n\n        \x3c!-- 损害数据插槽 --\x3e\n        <slot name="damage" :damage-data="data.damageData"></slot>\n        \n        \x3c!-- 实际损害插槽 --\x3e\n        <slot name="actual-damage" :actual-damage="data.actualDamage"></slot>\n\n        \x3c!-- 身高历史 --\x3e\n        <template v-if="data.history && data.history.length > 0">\n          <div class="gc-detail-section full-width">\n            <div class="gc-detail-section-title">\n              <i class="fa-solid fa-clock-rotate-left"></i> 最近变化\n            </div>\n            <div class="gc-history-list">\n              <div v-for="(record, idx) in data.history.slice(-3).reverse()" :key="idx" class="gc-history-item">\n                <div class="gc-history-time">{{ formatTime(record.time) }}</div>\n                <div class="gc-history-content">\n                  <span class="gc-history-height">{{ record.heightFormatted }}</span>\n                  <span v-if="record.reason" class="gc-history-reason">{{ record.reason }}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </template>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { computed } from \'vue\';\nimport type { CharacterData } from \'../../characters\';\n\nconst props = defineProps<{\n  name: string;\n  data: CharacterData;\n  showDamage?: boolean;\n  expanded?: boolean;\n}>();\n\nconst emit = defineEmits<{\n  (e: \'toggle\', name: string): void;\n}>();\n\nconst isExpanded = computed(() => props.expanded);\n\nconst toggleExpand = () => {\n  emit(\'toggle\', props.name);\n};\n\nconst avatarClass = computed(() => {\n  if (!props.data.calcData) return \'\';\n  return props.data.calcData.倍率 >= 1 ? \'giant\' : \'tiny\';\n});\n\nconst avatarIcon = computed(() => {\n  if (!props.data.calcData) return \'fa-solid fa-user\';\n  return props.data.calcData.倍率 >= 1 ? \'fa-solid fa-shoe-prints\' : \'fa-solid fa-bug\';\n});\n\nconst levelBadgeClass = computed(() => {\n  if (!props.data.calcData) return \'\';\n  return props.data.calcData.倍率 >= 1 ? \'giant\' : \'tiny\';\n});\n\nconst formatTime = (time?: string) => {\n  if (!time) return \'\';\n  if (time.includes(\' \')) return time.split(\' \')[1];\n  return time;\n};\n\nconst keyBodyParts = [\'眼睛高度\', \'足长\', \'手掌长\', \'乳房高度\'];\nconst keyObjects = [\'普通成年人\', \'轿车长度\', \'十层楼房\'];\nconst keyGiantessParts = [\'身高\', \'足长\', \'手掌长\'];\n<\/script>\n\n<style scoped>\n.gc-char-item {\n  background: rgba(255, 255, 255, 0.03);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.08));\n  border-radius: 12px;\n  overflow: hidden;\n  cursor: pointer;\n  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n  margin-bottom: 12px;\n}\n\n.gc-char-item:hover {\n  background: rgba(255, 255, 255, 0.06);\n  border-color: rgba(255, 255, 255, 0.15);\n  transform: translateY(-1px);\n}\n\n.gc-char-item.expanded {\n  background: rgba(15, 23, 42, 0.6);\n  border-color: var(--gc-primary-border, rgba(236, 72, 153, 0.4));\n  box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.3);\n  transform: translateY(-2px);\n}\n\n.gc-char-item.has-damage {\n  border-left: 3px solid rgba(249, 115, 22, 0.4);\n}\n\n.gc-char-item.has-damage.expanded {\n  border-left-color: #f97316;\n}\n\n.gc-char-header {\n  padding: 14px;\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n\n.gc-char-avatar {\n  width: 48px;\n  height: 48px;\n  border-radius: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.4em;\n  flex-shrink: 0;\n  background: rgba(255, 255, 255, 0.05);\n  color: #94a3b8;\n  transition: all 0.3s;\n}\n\n.gc-char-avatar.giant {\n  background: linear-gradient(135deg, rgba(249, 115, 22, 0.2), rgba(239, 68, 68, 0.2));\n  color: #f97316;\n  box-shadow: 0 0 15px rgba(249, 115, 22, 0.1);\n}\n\n.gc-char-avatar.tiny {\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(99, 102, 241, 0.2));\n  color: #60a5fa;\n  box-shadow: 0 0 15px rgba(59, 130, 246, 0.1);\n}\n\n.gc-char-info {\n  flex: 1;\n  min-width: 0;\n}\n\n.gc-char-name {\n  font-weight: 600;\n  font-size: 1.05em;\n  color: #f1f5f9;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 4px;\n}\n\n.gc-char-expand-icon {\n  font-size: 0.8em;\n  color: #94a3b8;\n  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  opacity: 0.5;\n}\n\n.gc-char-item:hover .gc-char-expand-icon {\n  opacity: 1;\n}\n\n.gc-char-item.expanded .gc-char-expand-icon {\n  transform: rotate(90deg);\n  color: var(--gc-primary, #ec4899);\n}\n\n.gc-char-stats {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  font-size: 0.9em;\n}\n\n.gc-stat-height {\n  color: #e2e8f0;\n  font-weight: 500;\n}\n\n.gc-stat-unknown {\n  color: #64748b;\n  font-style: italic;\n}\n\n.gc-stat-multiplier {\n  color: #94a3b8;\n  font-family: var(--gc-font-mono);\n  background: rgba(255, 255, 255, 0.05);\n  padding: 1px 6px;\n  border-radius: 4px;\n  font-size: 0.85em;\n}\n\n.gc-level-badge {\n  padding: 4px 10px;\n  border-radius: 8px;\n  font-size: 0.75em;\n  font-weight: 700;\n  text-transform: uppercase;\n  background: rgba(255, 255, 255, 0.05);\n  color: #94a3b8;\n  letter-spacing: 0.05em;\n}\n\n.gc-level-badge.giant {\n  background: rgba(249, 115, 22, 0.15);\n  color: #f97316;\n}\n\n.gc-level-badge.tiny {\n  background: rgba(59, 130, 246, 0.15);\n  color: #60a5fa;\n}\n\n/* 损害指示器 */\n.gc-damage-indicator {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 0.8em;\n  padding: 2px 8px;\n  background: rgba(249, 115, 22, 0.1);\n  color: #fb923c;\n  border-radius: 6px;\n  border: 1px solid rgba(249, 115, 22, 0.2);\n}\n\n/* 详情区域 */\n.gc-char-details {\n  border-top: 1px solid rgba(255, 255, 255, 0.05);\n  background: rgba(0, 0, 0, 0.15);\n  padding: 20px;\n  animation: slideDown 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  max-height: 450px;\n  overflow-y: auto;\n}\n\n.gc-char-details::-webkit-scrollbar {\n  width: 4px;\n}\n\n.gc-char-details::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.gc-char-details::-webkit-scrollbar-thumb {\n  background: rgba(255, 255, 255, 0.1);\n  border-radius: 2px;\n}\n\n.gc-char-details::-webkit-scrollbar-thumb:hover {\n  background: rgba(255, 255, 255, 0.2);\n}\n\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    transform: translateY(-5px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.gc-char-details-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\n  gap: 20px;\n}\n\n.gc-detail-section {\n  background: rgba(255, 255, 255, 0.02);\n  border-radius: 8px;\n  padding: 12px;\n  border: 1px solid transparent;\n}\n\n.gc-detail-section:hover {\n  background: rgba(255, 255, 255, 0.04);\n  border-color: rgba(255, 255, 255, 0.05);\n}\n\n.gc-detail-section.full-width {\n  grid-column: 1 / -1;\n}\n\n.gc-detail-section-title {\n  font-size: 0.8em;\n  font-weight: 700;\n  color: #94a3b8;\n  margin-bottom: 12px;\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.gc-detail-section-title i {\n  color: var(--gc-primary, #ec4899);\n}\n\n.gc-detail-row {\n  display: flex;\n  justify-content: space-between;\n  align-items: baseline;\n  font-size: 0.9em;\n  padding: 6px 0;\n  border-bottom: 1px dashed rgba(255, 255, 255, 0.05);\n}\n\n.gc-detail-row:last-child {\n  border-bottom: none;\n}\n\n.gc-detail-label {\n  color: #64748b;\n}\n\n.gc-detail-value {\n  color: #e2e8f0;\n  font-family: var(--gc-font-mono);\n  font-weight: 500;\n}\n\n/* 历史记录 */\n.gc-history-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.gc-history-item {\n  display: flex;\n  gap: 12px;\n  font-size: 0.9em;\n  padding: 8px 12px;\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 6px;\n  align-items: center;\n}\n\n.gc-history-time {\n  color: #64748b;\n  font-family: var(--gc-font-mono);\n  font-size: 0.85em;\n}\n\n.gc-history-content {\n  flex: 1;\n  display: flex;\n  gap: 10px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  align-items: center;\n}\n\n.gc-history-height {\n  color: #f1f5f9;\n  font-weight: 600;\n}\n\n.gc-history-reason {\n  color: #94a3b8;\n  font-size: 0.9em;\n  opacity: 0.8;\n}\n</style>\n'],sourceRoot:''}]);const s=o},766(e,n,a){var t=a(795);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('010e51b8',t,!1,{ssrId:!0})},795(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-help-content[data-v-2ca1928e]{display:flex;flex-direction:column;gap:20px}.gc-help-section[data-v-2ca1928e]{margin-bottom:8px}.gc-help-section h3[data-v-2ca1928e]{display:flex;align-items:center;gap:8px;font-size:0.95em;font-weight:600;margin-bottom:10px;color:var(--gc-text,#f1f5f9)}.gc-help-section h3 i[data-v-2ca1928e]{color:var(--gc-primary,#f472b6)}.gc-help-section p[data-v-2ca1928e]{font-size:0.85em;color:var(--gc-text-muted,#94a3b8);margin-bottom:8px}.gc-code-block[data-v-2ca1928e]{background:rgba(0,0,0,0.3);border-radius:6px;padding:10px 12px;font-family:\'Monaco\',\'Menlo\',monospace;font-size:0.8em;color:#a5f3fc;overflow-x:auto}.gc-changelog[data-v-2ca1928e]{max-height:200px;overflow-y:auto}.gc-ver-item[data-v-2ca1928e]{padding:8px 0;border-bottom:1px solid var(--gc-border,rgba(255,255,255,0.1))}.gc-ver-item[data-v-2ca1928e]:last-child{border-bottom:none}.gc-ver-item strong[data-v-2ca1928e]{color:var(--gc-primary,#f472b6)}.gc-ver-item ul[data-v-2ca1928e]{margin:6px 0 0 16px;font-size:0.8em;color:var(--gc-text-muted,#94a3b8)}.gc-help-links[data-v-2ca1928e]{margin:0 0 0 16px;font-size:0.85em;color:var(--gc-text-muted,#94a3b8)}.gc-help-links li[data-v-2ca1928e]{margin-bottom:4px}\n','',{version:3,sources:['webpack://./src/ui/panels/HelpPanel.vue'],names:[],mappings:'AA+DA,kCACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,kCACE,iBACF,CAEA,qCACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,gBAAiB,CACjB,eAAgB,CAChB,kBAAmB,CACnB,4BACF,CAEA,uCACE,+BACF,CAEA,oCACE,gBAAiB,CACjB,kCAAoC,CACpC,iBACF,CAEA,gCACE,0BAA8B,CAC9B,iBAAkB,CAClB,iBAAkB,CAClB,sCAAyC,CACzC,eAAgB,CAChB,aAAc,CACd,eACF,CAEA,+BACE,gBAAiB,CACjB,eACF,CAEA,8BACE,aAAc,CACd,8DACF,CAEA,yCACE,kBACF,CAEA,qCACE,+BACF,CAEA,iCACE,mBAAoB,CACpB,eAAgB,CAChB,kCACF,CAEA,gCACE,iBAAkB,CAClB,gBAAiB,CACjB,kCACF,CAEA,mCACE,iBACF',sourcesContent:['<template>\n  <GcOverlay\n    :visible="visible"\n    title="帮助"\n    icon="fa-regular fa-circle-question"\n    @close="$emit(\'close\')"\n  >\n    <div class="gc-help-content">\n      <div class="gc-help-section">\n        <h3><i class="fa-solid fa-rocket"></i> 快速开始</h3>\n        <p>在世界书或提示词中使用 MVU 命令：</p>\n        <div class="gc-code-block">\n          _.set(\'巨大娘.络络.当前身高\', 170)<br>\n          _.set(\'巨大娘.络络.原身高\', 1.65)\n        </div>\n      </div>\n      \n      <div class="gc-help-section">\n        <h3><i class="fa-solid fa-code-branch"></i> 版本信息</h3>\n        <p>当前版本: v{{ version }}</p>\n        <div class="gc-changelog">\n          <div v-for="ver in changelog.slice(0, 3)" :key="ver.version" class="gc-ver-item">\n            <strong>v{{ ver.version }}</strong> - {{ ver.date }}\n            <ul>\n              <li v-for="(c, i) in ver.changes" :key="i">{{ c }}</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n      \n      <div class="gc-help-section">\n        <h3><i class="fa-solid fa-book"></i> 更多帮助</h3>\n        <p>查看项目文档了解更多用法：</p>\n        <ul class="gc-help-links">\n          <li>MVU 变量结构</li>\n          <li>提示词模板系统</li>\n          <li>世界观模板系统</li>\n          <li>损害计算功能</li>\n        </ul>\n      </div>\n    </div>\n  </GcOverlay>\n</template>\n\n<script setup lang="ts">\nimport { GcOverlay } from \'../components\';\n\ndefineProps<{\n  visible: boolean;\n  version: string;\n  changelog: Array<{\n    version: string;\n    date: string;\n    changes: string[];\n  }>;\n}>();\n\ndefineEmits<{\n  (e: \'close\'): void;\n}>();\n<\/script>\n\n<style scoped>\n.gc-help-content {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n\n.gc-help-section {\n  margin-bottom: 8px;\n}\n\n.gc-help-section h3 {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.95em;\n  font-weight: 600;\n  margin-bottom: 10px;\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-help-section h3 i {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-help-section p {\n  font-size: 0.85em;\n  color: var(--gc-text-muted, #94a3b8);\n  margin-bottom: 8px;\n}\n\n.gc-code-block {\n  background: rgba(0, 0, 0, 0.3);\n  border-radius: 6px;\n  padding: 10px 12px;\n  font-family: \'Monaco\', \'Menlo\', monospace;\n  font-size: 0.8em;\n  color: #a5f3fc;\n  overflow-x: auto;\n}\n\n.gc-changelog {\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.gc-ver-item {\n  padding: 8px 0;\n  border-bottom: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n}\n\n.gc-ver-item:last-child {\n  border-bottom: none;\n}\n\n.gc-ver-item strong {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-ver-item ul {\n  margin: 6px 0 0 16px;\n  font-size: 0.8em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-help-links {\n  margin: 0 0 0 16px;\n  font-size: 0.85em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-help-links li {\n  margin-bottom: 4px;\n}\n</style>\n'],sourceRoot:''}]);const s=o},799(e,n,a){var t=a(840);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('16dfe5c4',t,!1,{ssrId:!0})},801(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-card[data-v-98035bae]{background:rgba(0,0,0,0.2);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:10px;overflow:hidden}.gc-card-header[data-v-98035bae]{display:flex;align-items:center;gap:8px;padding:10px 14px;background:rgba(255,255,255,0.02);border-bottom:1px solid var(--gc-border,rgba(255,255,255,0.1));font-weight:500;font-size:0.9em}.gc-card-header i[data-v-98035bae]{color:var(--gc-primary,#f472b6)}.gc-card-body[data-v-98035bae]{padding:14px}\n','',{version:3,sources:['webpack://./src/ui/components/GcCard.vue'],names:[],mappings:'AAsBA,0BACE,0BAA8B,CAC9B,uDAA4D,CAC5D,kBAAmB,CACnB,eACF,CAEA,iCACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,iBAAkB,CAClB,iCAAqC,CACrC,8DAAmE,CACnE,eAAgB,CAChB,eACF,CAEA,mCACE,+BACF,CAEA,+BACE,YACF',sourcesContent:['<template>\n  <div class="gc-card" :class="cardClass">\n    <div v-if="title" class="gc-card-header">\n      <i v-if="icon" :class="icon"></i>\n      <span>{{ title }}</span>\n      <slot name="header-actions"></slot>\n    </div>\n    <div class="gc-card-body">\n      <slot></slot>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\ndefineProps<{\n  title?: string;\n  icon?: string;\n  cardClass?: string;\n}>();\n<\/script>\n\n<style scoped>\n.gc-card {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 10px;\n  overflow: hidden;\n}\n\n.gc-card-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 10px 14px;\n  background: rgba(255, 255, 255, 0.02);\n  border-bottom: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  font-weight: 500;\n  font-size: 0.9em;\n}\n\n.gc-card-header i {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-card-body {\n  padding: 14px;\n}\n</style>\n'],sourceRoot:''}]);const s=o},821(e,n,a){var t=a(934);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('74ede9b3',t,!1,{ssrId:!0})},840(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-debug-section[data-v-075ee580]{padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;margin-bottom:12px}.gc-debug-section[data-v-075ee580]:last-child{margin-bottom:0}.gc-debug-section h3[data-v-075ee580]{display:flex;align-items:center;gap:8px;font-size:0.9em;font-weight:600;margin-bottom:10px;color:var(--gc-text,#f1f5f9)}.gc-debug-section h3 i[data-v-075ee580]{color:var(--gc-primary,#f472b6)}.gc-debug-form[data-v-075ee580]{display:flex;flex-direction:column;gap:10px}.gc-debug-input-row[data-v-075ee580]{display:flex;gap:6px;align-items:center}.gc-debug-input-row .gc-input[data-v-075ee580]{flex:1}.gc-input[data-v-075ee580]{width:100%;padding:6px 10px;background:rgba(0,0,0,0.2);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:6px;color:var(--gc-text,#f1f5f9);font-size:0.85em}.gc-input.sm[data-v-075ee580]{padding:4px 8px;font-size:0.8em}.gc-debug-hint[data-v-075ee580]{display:flex;align-items:flex-start;gap:6px;padding:8px 10px;background:rgba(59,130,246,0.1);border-radius:6px;font-size:0.8em;color:#60a5fa}.gc-debug-hint i[data-v-075ee580]{margin-top:2px}.gc-debug-hint strong.tiny[data-v-075ee580]{color:#60a5fa}.gc-debug-hint strong.giant[data-v-075ee580]{color:var(--gc-primary,#f472b6)}.gc-debug-hint.damage[data-v-075ee580]{background:rgba(239,68,68,0.1);color:#f87171}.gc-debug-hint.muted[data-v-075ee580]{background:rgba(148,163,184,0.1);color:var(--gc-text-muted,#94a3b8)}.gc-debug-btn-row[data-v-075ee580]{display:flex;gap:6px;flex-wrap:wrap}.gc-btn[data-v-075ee580]{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:8px 14px;background:rgba(255,255,255,0.05);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:8px;color:var(--gc-text,#f1f5f9);font-weight:500;font-size:0.85em;cursor:pointer;transition:all 0.2s}.gc-btn[data-v-075ee580]:hover{background:rgba(255,255,255,0.1)}.gc-btn-sm[data-v-075ee580]{padding:6px 10px;font-size:0.8em}.gc-btn.primary[data-v-075ee580]{background:var(--gc-primary,#f472b6);border-color:var(--gc-primary,#f472b6);color:white}.gc-btn.primary[data-v-075ee580]:hover{background:var(--gc-primary-hover,#ec4899)}.gc-btn.danger[data-v-075ee580]{background:rgba(239,68,68,0.1);border-color:rgba(239,68,68,0.3);color:#f87171}.gc-btn.danger[data-v-075ee580]:hover{background:rgba(239,68,68,0.2)}.gc-btn[data-v-075ee580]:disabled{opacity:0.5;cursor:not-allowed}.gc-debug-quick-tests[data-v-075ee580]{display:flex;flex-wrap:wrap;gap:6px}.gc-debug-quick-tests .gc-btn.tiny[data-v-075ee580]{background:rgba(96,165,250,0.1);border-color:rgba(96,165,250,0.3);color:#60a5fa}.gc-debug-quick-tests .gc-btn.tiny[data-v-075ee580]:hover{background:rgba(96,165,250,0.2)}.gc-setting-item[data-v-075ee580]{display:flex;flex-direction:column;gap:6px}.gc-setting-item label[data-v-075ee580]{font-size:0.85em;color:var(--gc-text-muted,#94a3b8)}.gc-actual-damage-form[data-v-075ee580]{display:flex;flex-direction:column;gap:10px;padding:10px;background:rgba(239,68,68,0.05);border-radius:6px;border:1px solid rgba(239,68,68,0.1)}.gc-debug-input-group[data-v-075ee580]{display:flex;flex-direction:column;gap:4px}.gc-debug-input-group label[data-v-075ee580]{font-size:0.8em;color:var(--gc-text-muted,#94a3b8)}.gc-input-suffix[data-v-075ee580]{color:var(--gc-text-muted,#94a3b8);font-size:0.85em;white-space:nowrap}\n','',{version:3,sources:['webpack://./src/ui/features/debug/DebugTestSection.vue'],names:[],mappings:'AA6OA,mCACE,YAAa,CACb,0BAA8B,CAC9B,iBAAkB,CAClB,kBACF,CAEA,8CACE,eACF,CAEA,sCACE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,eAAgB,CAChB,eAAgB,CAChB,kBAAmB,CACnB,4BACF,CAEA,wCACE,+BACF,CAEA,gCACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,qCACE,YAAa,CACb,OAAQ,CACR,kBACF,CAEA,+CACE,MACF,CAEA,2BACE,UAAW,CACX,gBAAiB,CACjB,0BAA8B,CAC9B,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,gBACF,CAEA,8BACE,eAAgB,CAChB,eACF,CAEA,gCACE,YAAa,CACb,sBAAuB,CACvB,OAAQ,CACR,gBAAiB,CACjB,+BAAmC,CACnC,iBAAkB,CAClB,eAAgB,CAChB,aACF,CAEA,kCACE,cACF,CAEA,4CACE,aACF,CAEA,6CACE,+BACF,CAEA,uCACE,8BAAkC,CAClC,aACF,CAEA,sCACE,gCAAoC,CACpC,kCACF,CAEA,mCACE,YAAa,CACb,OAAQ,CACR,cACF,CAEA,yBACE,mBAAoB,CACpB,kBAAmB,CACnB,sBAAuB,CACvB,OAAQ,CACR,gBAAiB,CACjB,iCAAqC,CACrC,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,eAAgB,CAChB,gBAAiB,CACjB,cAAe,CACf,mBACF,CAEA,+BACE,gCACF,CAEA,4BACE,gBAAiB,CACjB,eACF,CAEA,iCACE,oCAAsC,CACtC,sCAAwC,CACxC,WACF,CAEA,uCACE,0CACF,CAEA,gCACE,8BAAkC,CAClC,gCAAoC,CACpC,aACF,CAEA,sCACE,8BACF,CAEA,kCACE,WAAY,CACZ,kBACF,CAEA,uCACE,YAAa,CACb,cAAe,CACf,OACF,CAEA,oDACE,+BAAmC,CACnC,iCAAqC,CACrC,aACF,CAEA,0DACE,+BACF,CAEA,kCACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,wCACE,gBAAiB,CACjB,kCACF,CAEA,wCACE,YAAa,CACb,qBAAsB,CACtB,QAAS,CACT,YAAa,CACb,+BAAmC,CACnC,iBAAkB,CAClB,oCACF,CAEA,uCACE,YAAa,CACb,qBAAsB,CACtB,OACF,CAEA,6CACE,eAAgB,CAChB,kCACF,CAEA,kCACE,kCAAoC,CACpC,gBAAiB,CACjB,kBACF',sourcesContent:['<template>\n  <div class="gc-debug-test-section">\n    \x3c!-- 测试数据注入 --\x3e\n    <div class="gc-debug-section">\n      <h3><i class="fa-solid fa-flask"></i> 测试数据注入</h3>\n      <div class="gc-debug-form">\n        <div class="gc-debug-input-row">\n          <input \n            :value="testName" \n            @input="$emit(\'update:test-name\', ($event.target as HTMLInputElement).value)" \n            type="text" \n            placeholder="角色名" \n            class="gc-input sm" \n          />\n          <input \n            :value="testHeight" \n            @input="$emit(\'update:test-height\', parseFloat(($event.target as HTMLInputElement).value) || 0)" \n            type="number" \n            placeholder="身高(m)" \n            class="gc-input sm" \n          />\n          <input \n            :value="testOriginal" \n            @input="$emit(\'update:test-original\', parseFloat(($event.target as HTMLInputElement).value) || 0)" \n            type="number" \n            placeholder="原高(m)" \n            class="gc-input sm" \n          />\n        </div>\n        <div class="gc-debug-hint">\n          <i class="fa-solid fa-info-circle"></i>\n          <span v-if="testHeight && testOriginal && testHeight < testOriginal">\n            将创建<strong class="tiny">小人</strong>（{{ (testHeight / testOriginal).toFixed(4) }}倍）\n          </span>\n          <span v-else-if="testHeight && testOriginal">\n            将创建<strong class="giant">巨大娘</strong>（{{ (testHeight / testOriginal).toFixed(1) }}倍）\n          </span>\n          <span v-else>输入身高和原高自动判断类型</span>\n        </div>\n        <div class="gc-debug-btn-row">\n          <button class="gc-btn gc-btn-sm primary" @click="$emit(\'inject\')">\n            <i class="fa-solid fa-syringe"></i> 注入测试\n          </button>\n          <button class="gc-btn gc-btn-sm" @click="$emit(\'clear\', testName)" :disabled="!testName">\n            <i class="fa-solid fa-eraser"></i> 清除此角色\n          </button>\n          <button class="gc-btn gc-btn-sm danger" @click="$emit(\'clear\')">\n            <i class="fa-solid fa-trash"></i> 清除全部\n          </button>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- 快捷测试 --\x3e\n    <div class="gc-debug-section">\n      <h3><i class="fa-solid fa-lightbulb"></i> 快捷测试</h3>\n      <div class="gc-debug-quick-tests">\n        <button class="gc-btn gc-btn-sm" @click="$emit(\'quick-test\', { name: \'巨人\', height: 100, original: 1.65 })">\n          巨大娘 100m\n        </button>\n        <button class="gc-btn gc-btn-sm" @click="$emit(\'quick-test\', { name: \'千米级\', height: 1000, original: 1.65 })">\n          千米级 1km\n        </button>\n        <button class="gc-btn gc-btn-sm" @click="$emit(\'quick-test\', { name: \'行星级\', height: 10000000, original: 1.65 })">\n          行星级 10Mm\n        </button>\n        <button class="gc-btn gc-btn-sm tiny" @click="$emit(\'quick-test\', { name: \'小人\', height: 0.01, original: 1.65 })">\n          小人 1cm\n        </button>\n        <button class="gc-btn gc-btn-sm tiny" @click="$emit(\'quick-test\', { name: \'微型\', height: 0.001, original: 1.65 })">\n          微型 1mm\n        </button>\n      </div>\n    </div>\n\n    \x3c!-- 实际损害录入 --\x3e\n    <div class="gc-debug-section">\n      <h3><i class="fa-solid fa-skull"></i> 实际损害录入</h3>\n      <div class="gc-debug-form">\n        <div class="gc-debug-hint damage">\n          <i class="fa-solid fa-info-circle"></i>\n          <span>记录角色在剧情中造成的实际损害</span>\n        </div>\n        \n        <div class="gc-setting-item">\n          <label>选择角色</label>\n          <select v-model="damageTarget" class="gc-input">\n            <option value="">-- 选择角色 --</option>\n            <option \n              v-for="char in giantCharacters" \n              :key="char.name" \n              :value="char.name"\n            >\n              {{ char.name }}\n            </option>\n          </select>\n        </div>\n        \n        <div v-if="damageTarget" class="gc-actual-damage-form">\n          <div class="gc-debug-input-group">\n            <label>累计伤亡</label>\n            <div class="gc-debug-input-row">\n              <input \n                v-model.number="damageForm.totalCasualties" \n                type="number" \n                class="gc-input sm" \n                placeholder="0" \n              />\n              <span class="gc-input-suffix">人</span>\n            </div>\n          </div>\n          \n          <div class="gc-debug-input-group">\n            <label>累计建筑损毁</label>\n            <div class="gc-debug-input-row">\n              <input \n                v-model.number="damageForm.totalBuildings" \n                type="number" \n                class="gc-input sm" \n                placeholder="0" \n              />\n              <span class="gc-input-suffix">栋</span>\n            </div>\n          </div>\n          \n          <div class="gc-debug-input-group">\n            <label>最近行动描述</label>\n            <input \n              v-model="damageForm.lastAction" \n              type="text" \n              class="gc-input" \n              placeholder="如：踩下一脚" \n            />\n          </div>\n          \n          <div class="gc-debug-input-group">\n            <label>最近行动伤亡</label>\n            <div class="gc-debug-input-row">\n              <input \n                v-model.number="damageForm.lastActionCasualties" \n                type="number" \n                class="gc-input sm" \n                placeholder="0" \n              />\n              <span class="gc-input-suffix">人</span>\n            </div>\n          </div>\n          \n          <div class="gc-debug-input-group">\n            <label>备注</label>\n            <input \n              v-model="damageForm.note" \n              type="text" \n              class="gc-input" \n              placeholder="可选备注" \n            />\n          </div>\n          \n          <div class="gc-debug-btn-row">\n            <button class="gc-btn gc-btn-sm primary" @click="saveDamage">\n              <i class="fa-solid fa-save"></i> 保存\n            </button>\n            <button class="gc-btn gc-btn-sm danger" @click="clearDamage">\n              <i class="fa-solid fa-trash"></i> 清除\n            </button>\n          </div>\n        </div>\n        \n        <div v-else class="gc-debug-hint muted">\n          <i class="fa-solid fa-exclamation-circle"></i>\n          <span>请先选择一个巨大娘角色</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { ref, computed } from \'vue\';\nimport type { CharacterData } from \'../../../types\';\n\nconst props = defineProps<{\n  testName: string;\n  testHeight: number;\n  testOriginal: number;\n  characters: CharacterData[];\n}>();\n\nconst emit = defineEmits<{\n  (e: \'update:test-name\', value: string): void;\n  (e: \'update:test-height\', value: number): void;\n  (e: \'update:test-original\', value: number): void;\n  (e: \'inject\'): void;\n  (e: \'clear\', name?: string): void;\n  (e: \'quick-test\', params: { name: string; height: number; original: number }): void;\n  (e: \'save-damage\', params: { name: string; data: typeof damageForm.value }): void;\n  (e: \'clear-damage\', name: string): void;\n}>();\n\nconst damageTarget = ref(\'\');\nconst damageForm = ref({\n  totalCasualties: 0,\n  totalBuildings: 0,\n  lastAction: \'\',\n  lastActionCasualties: 0,\n  note: \'\',\n});\n\nconst giantCharacters = computed(() => \n  props.characters.filter(c => {\n    const scale = c.currentHeight / c.originalHeight;\n    return scale >= 1;\n  })\n);\n\nconst saveDamage = () => {\n  if (!damageTarget.value) return;\n  emit(\'save-damage\', {\n    name: damageTarget.value,\n    data: { ...damageForm.value },\n  });\n};\n\nconst clearDamage = () => {\n  if (!damageTarget.value) return;\n  emit(\'clear-damage\', damageTarget.value);\n  damageForm.value = {\n    totalCasualties: 0,\n    totalBuildings: 0,\n    lastAction: \'\',\n    lastActionCasualties: 0,\n    note: \'\',\n  };\n};\n<\/script>\n\n<style scoped>\n.gc-debug-section {\n  padding: 12px;\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  margin-bottom: 12px;\n}\n\n.gc-debug-section:last-child {\n  margin-bottom: 0;\n}\n\n.gc-debug-section h3 {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.9em;\n  font-weight: 600;\n  margin-bottom: 10px;\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-debug-section h3 i {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-debug-form {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.gc-debug-input-row {\n  display: flex;\n  gap: 6px;\n  align-items: center;\n}\n\n.gc-debug-input-row .gc-input {\n  flex: 1;\n}\n\n.gc-input {\n  width: 100%;\n  padding: 6px 10px;\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 6px;\n  color: var(--gc-text, #f1f5f9);\n  font-size: 0.85em;\n}\n\n.gc-input.sm {\n  padding: 4px 8px;\n  font-size: 0.8em;\n}\n\n.gc-debug-hint {\n  display: flex;\n  align-items: flex-start;\n  gap: 6px;\n  padding: 8px 10px;\n  background: rgba(59, 130, 246, 0.1);\n  border-radius: 6px;\n  font-size: 0.8em;\n  color: #60a5fa;\n}\n\n.gc-debug-hint i {\n  margin-top: 2px;\n}\n\n.gc-debug-hint strong.tiny {\n  color: #60a5fa;\n}\n\n.gc-debug-hint strong.giant {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-debug-hint.damage {\n  background: rgba(239, 68, 68, 0.1);\n  color: #f87171;\n}\n\n.gc-debug-hint.muted {\n  background: rgba(148, 163, 184, 0.1);\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-debug-btn-row {\n  display: flex;\n  gap: 6px;\n  flex-wrap: wrap;\n}\n\n.gc-btn {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  padding: 8px 14px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 8px;\n  color: var(--gc-text, #f1f5f9);\n  font-weight: 500;\n  font-size: 0.85em;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.gc-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.gc-btn-sm {\n  padding: 6px 10px;\n  font-size: 0.8em;\n}\n\n.gc-btn.primary {\n  background: var(--gc-primary, #f472b6);\n  border-color: var(--gc-primary, #f472b6);\n  color: white;\n}\n\n.gc-btn.primary:hover {\n  background: var(--gc-primary-hover, #ec4899);\n}\n\n.gc-btn.danger {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: rgba(239, 68, 68, 0.3);\n  color: #f87171;\n}\n\n.gc-btn.danger:hover {\n  background: rgba(239, 68, 68, 0.2);\n}\n\n.gc-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.gc-debug-quick-tests {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n}\n\n.gc-debug-quick-tests .gc-btn.tiny {\n  background: rgba(96, 165, 250, 0.1);\n  border-color: rgba(96, 165, 250, 0.3);\n  color: #60a5fa;\n}\n\n.gc-debug-quick-tests .gc-btn.tiny:hover {\n  background: rgba(96, 165, 250, 0.2);\n}\n\n.gc-setting-item {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.gc-setting-item label {\n  font-size: 0.85em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-actual-damage-form {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  padding: 10px;\n  background: rgba(239, 68, 68, 0.05);\n  border-radius: 6px;\n  border: 1px solid rgba(239, 68, 68, 0.1);\n}\n\n.gc-debug-input-group {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.gc-debug-input-group label {\n  font-size: 0.8em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-input-suffix {\n  color: var(--gc-text-muted, #94a3b8);\n  font-size: 0.85em;\n  white-space: nowrap;\n}\n</style>\n'],sourceRoot:''}]);const s=o},844(e,n,a){var t=a(585);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('9b712da2',t,!1,{ssrId:!0})},894(e,n,a){var t=a(345);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('85fd753e',t,!1,{ssrId:!0})},901(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-debug-empty[data-v-3eacdf91]{display:flex;flex-direction:column;align-items:center;padding:40px 20px;text-align:center}.gc-debug-empty i[data-v-3eacdf91]{font-size:2.5em;color:var(--gc-text-muted,#94a3b8);margin-bottom:12px}.gc-debug-empty p[data-v-3eacdf91]{font-size:0.95em;margin-bottom:6px}.gc-debug-empty small[data-v-3eacdf91]{font-size:0.8em;color:var(--gc-text-muted,#94a3b8)}.gc-debug-characters[data-v-3eacdf91]{display:flex;flex-direction:column;gap:12px}.gc-debug-char-card[data-v-3eacdf91]{background:rgba(0,0,0,0.2);border-radius:8px;padding:12px;border-left:3px solid transparent}.gc-debug-char-card[data-v-3eacdf91]:hover{background:rgba(0,0,0,0.3)}.gc-debug-char-card.giant[data-v-3eacdf91]{border-left-color:var(--gc-primary,#f472b6)}.gc-debug-char-card.tiny[data-v-3eacdf91]{border-left-color:#60a5fa}.gc-debug-char-header[data-v-3eacdf91]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;padding-bottom:8px;border-bottom:1px solid rgba(255,255,255,0.1)}.gc-debug-char-name[data-v-3eacdf91]{font-weight:600;font-size:0.95em}.gc-debug-char-type[data-v-3eacdf91]{font-size:0.75em;padding:2px 8px;border-radius:4px;background:rgba(255,255,255,0.1)}.gc-debug-char-type.giant[data-v-3eacdf91]{background:rgba(244,114,182,0.2);color:#f472b6}.gc-debug-char-type.tiny[data-v-3eacdf91]{background:rgba(96,165,250,0.2);color:#60a5fa}.gc-debug-char-body[data-v-3eacdf91]{margin-bottom:8px}.gc-debug-char-row[data-v-3eacdf91]{display:flex;justify-content:space-between;align-items:center;font-size:0.8em;padding:3px 0}.gc-debug-char-row span[data-v-3eacdf91]:last-child{text-align:right}.gc-debug-char-row .mono[data-v-3eacdf91]{font-family:\'Monaco\',\'Menlo\',monospace}.gc-debug-char-row .success[data-v-3eacdf91]{color:#34d399}.gc-debug-char-row .warn[data-v-3eacdf91]{color:#fbbf24}.gc-debug-char-row .muted[data-v-3eacdf91]{color:var(--gc-text-muted,#94a3b8)}.gc-debug-char-row .highlight[data-v-3eacdf91]{color:var(--gc-primary,#f472b6)}.gc-debug-char-row .damage[data-v-3eacdf91]{color:#f87171}.gc-debug-char-row .actual-damage[data-v-3eacdf91]{color:#f87171;font-weight:600}.gc-debug-char-row .action[data-v-3eacdf91]{max-width:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:var(--gc-text-muted,#94a3b8)}.gc-debug-char-custom[data-v-3eacdf91],.gc-debug-char-damage[data-v-3eacdf91]{margin-top:8px;padding-top:8px;border-top:1px solid rgba(255,255,255,0.1)}.gc-debug-char-custom-title[data-v-3eacdf91],.gc-debug-char-damage-title[data-v-3eacdf91]{display:flex;align-items:center;gap:6px;font-size:0.8em;font-weight:600;margin-bottom:6px}.gc-debug-char-custom-title[data-v-3eacdf91]{color:#fbbf24}.gc-debug-char-damage-title[data-v-3eacdf91]{color:#f87171}.gc-debug-char-damage.estimate .gc-debug-char-damage-title[data-v-3eacdf91]{color:#60a5fa}.gc-debug-char-damage.actual .gc-debug-char-damage-title[data-v-3eacdf91]{color:#f87171}.gc-debug-char-damage-badge[data-v-3eacdf91]{font-size:0.85em;padding:1px 6px;background:rgba(96,165,250,0.2);color:#60a5fa;border-radius:3px;font-weight:normal}.gc-debug-char-damage-badge.actual[data-v-3eacdf91]{background:rgba(239,68,68,0.2);color:#f87171}.gc-debug-char-no-damage[data-v-3eacdf91]{margin-top:8px;padding:8px 10px;background:rgba(255,255,255,0.05);border-radius:6px;font-size:0.8em;color:var(--gc-text-muted,#94a3b8);display:flex;align-items:center;gap:6px}.gc-debug-char-no-damage i[data-v-3eacdf91]{color:#60a5fa}\n','',{version:3,sources:['webpack://./src/ui/features/debug/DebugCharactersSection.vue'],names:[],mappings:'AA+HA,iCACE,YAAa,CACb,qBAAsB,CACtB,kBAAmB,CACnB,iBAAkB,CAClB,iBACF,CAEA,mCACE,eAAgB,CAChB,kCAAoC,CACpC,kBACF,CAEA,mCACE,gBAAiB,CACjB,iBACF,CAEA,uCACE,eAAgB,CAChB,kCACF,CAEA,sCACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,qCACE,0BAA8B,CAC9B,iBAAkB,CAClB,YAAa,CACb,iCACF,CAEA,2CACE,0BACF,CAEA,2CACE,2CACF,CAEA,0CACE,yBACF,CAEA,uCACE,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,kBAAmB,CACnB,kBAAmB,CACnB,6CACF,CAEA,qCACE,eAAgB,CAChB,gBACF,CAEA,qCACE,gBAAiB,CACjB,eAAgB,CAChB,iBAAkB,CAClB,gCACF,CAEA,2CACE,gCAAoC,CACpC,aACF,CAEA,0CACE,+BAAmC,CACnC,aACF,CAEA,qCACE,iBACF,CAEA,oCACE,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,eAAgB,CAChB,aACF,CAEA,oDACE,gBACF,CAEA,0CACE,sCACF,CAEA,6CACE,aACF,CAEA,0CACE,aACF,CAEA,2CACE,kCACF,CAEA,+CACE,+BACF,CAEA,4CACE,aACF,CAEA,mDACE,aAAc,CACd,eACF,CAEA,4CACE,eAAgB,CAChB,eAAgB,CAChB,sBAAuB,CACvB,kBAAmB,CACnB,kCACF,CAEA,8EAEE,cAAe,CACf,eAAgB,CAChB,0CACF,CAEA,0FAEE,YAAa,CACb,kBAAmB,CACnB,OAAQ,CACR,eAAgB,CAChB,eAAgB,CAChB,iBACF,CAEA,6CACE,aACF,CAEA,6CACE,aACF,CAEA,4EACE,aACF,CAEA,0EACE,aACF,CAEA,6CACE,gBAAiB,CACjB,eAAgB,CAChB,+BAAmC,CACnC,aAAc,CACd,iBAAkB,CAClB,kBACF,CAEA,oDACE,8BAAkC,CAClC,aACF,CAEA,0CACE,cAAe,CACf,gBAAiB,CACjB,iCAAqC,CACrC,iBAAkB,CAClB,eAAgB,CAChB,kCAAoC,CACpC,YAAa,CACb,kBAAmB,CACnB,OACF,CAEA,4CACE,aACF',sourcesContent:['<template>\n  <div class="gc-debug-characters-section">\n    <div v-if="!characters.length" class="gc-debug-empty">\n      <i class="fa-solid fa-users-slash"></i>\n      <p>暂无角色数据</p>\n      <small>在世界书或提示词中设置角色身高后，这里会显示详细信息</small>\n    </div>\n    \n    <div v-else class="gc-debug-characters">\n      <div \n        v-for="char in characters" \n        :key="char.name" \n        class="gc-debug-char-card"\n        :class="{ giant: char.类型 === \'巨大娘\', tiny: char.类型 === \'小人\' }"\n      >\n        <div class="gc-debug-char-header">\n          <span class="gc-debug-char-name">{{ char.name }}</span>\n          <span class="gc-debug-char-type" :class="char.类型 === \'巨大娘\' ? \'giant\' : \'tiny\'">\n            {{ char.类型 }}\n          </span>\n        </div>\n        \n        <div class="gc-debug-char-body">\n          <div class="gc-debug-char-row">\n            <span>身高</span>\n            <span class="mono">{{ char.当前身高_格式化 || `${char.当前身高}m` }}</span>\n          </div>\n          <div class="gc-debug-char-row">\n            <span>原身高</span>\n            <span class="mono">{{ char.原身高 }}m</span>\n          </div>\n          <div class="gc-debug-char-row">\n            <span>倍率</span>\n            <span class="mono">{{ char.倍率?.toFixed(2) }}x</span>\n          </div>\n          <div v-if="char.级别" class="gc-debug-char-row">\n            <span>级别</span>\n            <span class="highlight">{{ char.级别 }}</span>\n          </div>\n          <div class="gc-debug-char-row">\n            <span>计算数据</span>\n            <span :class="char.有计算数据 ? \'success\' : \'warn\'">{{ char.有计算数据 ? \'✅\' : \'❌\' }}</span>\n          </div>\n          <div class="gc-debug-char-row">\n            <span>损害数据</span>\n            <span :class="char.有损害数据 ? \'success\' : \'muted\'">{{ char.有损害数据 ? \'✅\' : \'—\' }}</span>\n          </div>\n          <div class="gc-debug-char-row">\n            <span>历史记录</span>\n            <span>{{ char.有身高历史 ? `${char.历史记录数}条` : \'—\' }}</span>\n          </div>\n        </div>\n        \n        \x3c!-- 自定义部位 --\x3e\n        <div v-if="char.自定义部位 && Object.keys(char.自定义部位).length" class="gc-debug-char-custom">\n          <div class="gc-debug-char-custom-title">\n            <i class="fa-solid fa-bolt"></i> 自定义部位\n          </div>\n          <div v-for="(val, key) in char.自定义部位" :key="key" class="gc-debug-char-row">\n            <span>{{ key }}</span>\n            <span class="mono">{{ val }}m</span>\n          </div>\n        </div>\n        \n        \x3c!-- 预估损害 --\x3e\n        <div v-if="char.预估损害" class="gc-debug-char-damage estimate">\n          <div class="gc-debug-char-damage-title">\n            <i class="fa-solid fa-calculator"></i> 预估损害\n            <span class="gc-debug-char-damage-badge">自动计算</span>\n          </div>\n          <div class="gc-debug-char-row">\n            <span>破坏力等级</span>\n            <span class="damage">{{ char.预估损害.破坏力等级 }}</span>\n          </div>\n          <div class="gc-debug-char-row">\n            <span>单步伤亡</span>\n            <span class="damage">{{ char.预估损害.单步伤亡 }}</span>\n          </div>\n          <div class="gc-debug-char-row">\n            <span>场景</span>\n            <span>{{ char.预估损害.场景 }}</span>\n          </div>\n        </div>\n        \n        \x3c!-- 实际损害 --\x3e\n        <div v-if="char.实际损害" class="gc-debug-char-damage actual">\n          <div class="gc-debug-char-damage-title">\n            <i class="fa-solid fa-skull"></i> 实际损害\n            <span class="gc-debug-char-damage-badge actual">剧情记录</span>\n          </div>\n          <div v-if="char.实际损害.总伤亡人数_格式化" class="gc-debug-char-row">\n            <span>累计伤亡</span>\n            <span class="actual-damage">{{ char.实际损害.总伤亡人数_格式化 }}</span>\n          </div>\n          <div v-if="char.实际损害.总建筑损毁" class="gc-debug-char-row">\n            <span>累计建筑损毁</span>\n            <span class="actual-damage">{{ char.实际损害.总建筑损毁 }}栋</span>\n          </div>\n          <div v-if="char.实际损害.最近行动" class="gc-debug-char-row">\n            <span>最近行动</span>\n            <span class="action">{{ char.实际损害.最近行动 }}</span>\n          </div>\n          <div v-if="char.实际损害.重大事件数" class="gc-debug-char-row">\n            <span>重大事件</span>\n            <span>{{ char.实际损害.重大事件数 }}件</span>\n          </div>\n        </div>\n        \n        \x3c!-- 无损害数据提示 --\x3e\n        <div v-if="!char.预估损害 && !char.实际损害 && char.类型 === \'巨大娘\'" class="gc-debug-char-no-damage">\n          <i class="fa-solid fa-info-circle"></i>\n          <span>启用损害计算后显示预估数据</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport type { DebugCharacterInfo } from \'../../../types\';\n\ndefineProps<{\n  characters: DebugCharacterInfo[];\n}>();\n<\/script>\n\n<style scoped>\n.gc-debug-empty {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 40px 20px;\n  text-align: center;\n}\n\n.gc-debug-empty i {\n  font-size: 2.5em;\n  color: var(--gc-text-muted, #94a3b8);\n  margin-bottom: 12px;\n}\n\n.gc-debug-empty p {\n  font-size: 0.95em;\n  margin-bottom: 6px;\n}\n\n.gc-debug-empty small {\n  font-size: 0.8em;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-debug-characters {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.gc-debug-char-card {\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  padding: 12px;\n  border-left: 3px solid transparent;\n}\n\n.gc-debug-char-card:hover {\n  background: rgba(0, 0, 0, 0.3);\n}\n\n.gc-debug-char-card.giant {\n  border-left-color: var(--gc-primary, #f472b6);\n}\n\n.gc-debug-char-card.tiny {\n  border-left-color: #60a5fa;\n}\n\n.gc-debug-char-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.gc-debug-char-name {\n  font-weight: 600;\n  font-size: 0.95em;\n}\n\n.gc-debug-char-type {\n  font-size: 0.75em;\n  padding: 2px 8px;\n  border-radius: 4px;\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.gc-debug-char-type.giant {\n  background: rgba(244, 114, 182, 0.2);\n  color: #f472b6;\n}\n\n.gc-debug-char-type.tiny {\n  background: rgba(96, 165, 250, 0.2);\n  color: #60a5fa;\n}\n\n.gc-debug-char-body {\n  margin-bottom: 8px;\n}\n\n.gc-debug-char-row {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 0.8em;\n  padding: 3px 0;\n}\n\n.gc-debug-char-row span:last-child {\n  text-align: right;\n}\n\n.gc-debug-char-row .mono {\n  font-family: \'Monaco\', \'Menlo\', monospace;\n}\n\n.gc-debug-char-row .success {\n  color: #34d399;\n}\n\n.gc-debug-char-row .warn {\n  color: #fbbf24;\n}\n\n.gc-debug-char-row .muted {\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-debug-char-row .highlight {\n  color: var(--gc-primary, #f472b6);\n}\n\n.gc-debug-char-row .damage {\n  color: #f87171;\n}\n\n.gc-debug-char-row .actual-damage {\n  color: #f87171;\n  font-weight: 600;\n}\n\n.gc-debug-char-row .action {\n  max-width: 150px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  color: var(--gc-text-muted, #94a3b8);\n}\n\n.gc-debug-char-custom,\n.gc-debug-char-damage {\n  margin-top: 8px;\n  padding-top: 8px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.gc-debug-char-custom-title,\n.gc-debug-char-damage-title {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 0.8em;\n  font-weight: 600;\n  margin-bottom: 6px;\n}\n\n.gc-debug-char-custom-title {\n  color: #fbbf24;\n}\n\n.gc-debug-char-damage-title {\n  color: #f87171;\n}\n\n.gc-debug-char-damage.estimate .gc-debug-char-damage-title {\n  color: #60a5fa;\n}\n\n.gc-debug-char-damage.actual .gc-debug-char-damage-title {\n  color: #f87171;\n}\n\n.gc-debug-char-damage-badge {\n  font-size: 0.85em;\n  padding: 1px 6px;\n  background: rgba(96, 165, 250, 0.2);\n  color: #60a5fa;\n  border-radius: 3px;\n  font-weight: normal;\n}\n\n.gc-debug-char-damage-badge.actual {\n  background: rgba(239, 68, 68, 0.2);\n  color: #f87171;\n}\n\n.gc-debug-char-no-damage {\n  margin-top: 8px;\n  padding: 8px 10px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 6px;\n  font-size: 0.8em;\n  color: var(--gc-text-muted, #94a3b8);\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.gc-debug-char-no-damage i {\n  color: #60a5fa;\n}\n</style>\n'],sourceRoot:''}]);const s=o},907(e,n,a){var t=a(930);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('5219213c',t,!1,{ssrId:!0})},926(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-calc-section[data-v-361696cc]{margin-bottom:20px}.gc-calc-box[data-v-361696cc]{display:flex;align-items:center;gap:12px;padding:6px;background:rgba(0,0,0,0.2);border-radius:14px;border:1px solid var(--gc-border,rgba(255,255,255,0.08))}.gc-input-wrapper[data-v-361696cc]{flex:1;position:relative;display:flex;align-items:center}.gc-input[data-v-361696cc]{width:100%;padding:10px 32px 10px 14px;background:rgba(255,255,255,0.03);border:1px solid transparent;border-radius:10px;color:var(--gc-text,#f8fafc);font-size:0.95em;transition:all 0.2s;font-family:var(--gc-font-mono)}.gc-input[data-v-361696cc]:hover{background:rgba(255,255,255,0.06)}.gc-input[data-v-361696cc]:focus{outline:none;background:rgba(0,0,0,0.3);border-color:var(--gc-primary,#ec4899);box-shadow:0 0 0 3px var(--gc-primary-light,rgba(236,72,153,0.15))}.gc-input[data-v-361696cc]::placeholder{color:var(--gc-text-dim,#64748b);font-family:var(--gc-font-family)}.gc-unit[data-v-361696cc]{position:absolute;right:12px;color:var(--gc-text-dim,#64748b);font-size:0.85em;pointer-events:none;font-weight:500}.gc-operator[data-v-361696cc]{color:var(--gc-text-muted,#94a3b8);font-weight:bold;font-size:1.1em;opacity:0.5}.gc-btn-icon[data-v-361696cc]{width:42px;height:42px;display:flex;align-items:center;justify-content:center;border-radius:10px;border:none;cursor:pointer;transition:all 0.2s cubic-bezier(0.4,0,0.2,1);flex-shrink:0}.gc-btn-icon.primary[data-v-361696cc]{background:var(--gc-primary,#ec4899);color:white;box-shadow:0 4px 12px rgba(236,72,153,0.3)}.gc-btn-icon.primary[data-v-361696cc]:hover{background:var(--gc-primary-hover,#db2777);transform:translateY(-2px);box-shadow:0 6px 16px rgba(236,72,153,0.4)}.gc-btn-icon.primary[data-v-361696cc]:active{transform:translateY(0)}.fade-enter-active[data-v-361696cc],.fade-leave-active[data-v-361696cc]{transition:opacity 0.3s cubic-bezier(0.4,0,0.2,1)}.fade-enter-from[data-v-361696cc],.fade-leave-to[data-v-361696cc]{opacity:0}\n','',{version:3,sources:['webpack://./src/ui/features/QuickCalc.vue'],names:[],mappings:'AAkDA,kCACE,kBACF,CAEA,8BACE,YAAa,CACb,kBAAmB,CACnB,QAAS,CACT,WAAY,CACZ,0BAA8B,CAC9B,kBAAmB,CACnB,wDACF,CAEA,mCACE,MAAO,CACP,iBAAkB,CAClB,YAAa,CACb,kBACF,CAEA,2BACE,UAAW,CACX,2BAA4B,CAC5B,iCAAqC,CACrC,4BAA6B,CAC7B,kBAAmB,CACnB,4BAA8B,CAC9B,gBAAiB,CACjB,mBAAoB,CACpB,+BACF,CAEA,iCACE,iCACF,CAEA,iCACE,YAAa,CACb,0BAA8B,CAC9B,sCAAwC,CACxC,kEACF,CAEA,wCACE,gCAAkC,CAClC,iCACF,CAEA,0BACE,iBAAkB,CAClB,UAAW,CACX,gCAAkC,CAClC,gBAAiB,CACjB,mBAAoB,CACpB,eACF,CAEA,8BACE,kCAAoC,CACpC,gBAAiB,CACjB,eAAgB,CAChB,WACF,CAEA,8BACE,UAAW,CACX,WAAY,CACZ,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,kBAAmB,CACnB,WAAY,CACZ,cAAe,CACf,6CAAiD,CACjD,aACF,CAEA,sCACE,oCAAsC,CACtC,WAAY,CACZ,0CACF,CAEA,4CACE,0CAA4C,CAC5C,0BAA2B,CAC3B,0CACF,CAEA,6CACE,uBACF,CAGA,wEAEE,iDACF,CAEA,kEAEE,SACF',sourcesContent:['<template>\n  <div class="gc-calc-section">\n    <div class="gc-calc-box">\n      <div class="gc-input-wrapper">\n        <input\n          v-model.number="calcHeight"\n          type="number"\n          placeholder="身高(m)"\n          class="gc-input"\n          @keypress.enter="doCalculate"\n        />\n        <span class="gc-unit">m</span>\n      </div>\n      <span class="gc-operator">/</span>\n      <div class="gc-input-wrapper">\n        <input\n          v-model.number="calcOriginal"\n          type="number"\n          placeholder="原高(m)"\n          class="gc-input"\n        />\n        <span class="gc-unit">m</span>\n      </div>\n      <button class="gc-btn-icon primary" @click="doCalculate" title="计算">\n        <i class="fa-solid fa-calculator"></i>\n      </button>\n    </div>\n    \n    \x3c!-- 计算结果 --\x3e\n    <transition name="fade">\n      <Result v-if="calcResult" :result="calcResult" :is-giant="isGiant" @close="clearCalcResult" />\n    </transition>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { useCalculator } from \'../../composables\';\nimport Result from \'../Result.vue\';\n\nconst {\n  calcHeight,\n  calcOriginal,\n  calcResult,\n  isGiant,\n  doCalculate,\n  clearCalcResult,\n} = useCalculator();\n<\/script>\n\n<style scoped>\n.gc-calc-section {\n  margin-bottom: 20px;\n}\n\n.gc-calc-box {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 6px;\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 14px;\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.08));\n}\n\n.gc-input-wrapper {\n  flex: 1;\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.gc-input {\n  width: 100%;\n  padding: 10px 32px 10px 14px;\n  background: rgba(255, 255, 255, 0.03);\n  border: 1px solid transparent;\n  border-radius: 10px;\n  color: var(--gc-text, #f8fafc);\n  font-size: 0.95em;\n  transition: all 0.2s;\n  font-family: var(--gc-font-mono);\n}\n\n.gc-input:hover {\n  background: rgba(255, 255, 255, 0.06);\n}\n\n.gc-input:focus {\n  outline: none;\n  background: rgba(0, 0, 0, 0.3);\n  border-color: var(--gc-primary, #ec4899);\n  box-shadow: 0 0 0 3px var(--gc-primary-light, rgba(236, 72, 153, 0.15));\n}\n\n.gc-input::placeholder {\n  color: var(--gc-text-dim, #64748b);\n  font-family: var(--gc-font-family);\n}\n\n.gc-unit {\n  position: absolute;\n  right: 12px;\n  color: var(--gc-text-dim, #64748b);\n  font-size: 0.85em;\n  pointer-events: none;\n  font-weight: 500;\n}\n\n.gc-operator {\n  color: var(--gc-text-muted, #94a3b8);\n  font-weight: bold;\n  font-size: 1.1em;\n  opacity: 0.5;\n}\n\n.gc-btn-icon {\n  width: 42px;\n  height: 42px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 10px;\n  border: none;\n  cursor: pointer;\n  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n  flex-shrink: 0;\n}\n\n.gc-btn-icon.primary {\n  background: var(--gc-primary, #ec4899);\n  color: white;\n  box-shadow: 0 4px 12px rgba(236, 72, 153, 0.3);\n}\n\n.gc-btn-icon.primary:hover {\n  background: var(--gc-primary-hover, #db2777);\n  transform: translateY(-2px);\n  box-shadow: 0 6px 16px rgba(236, 72, 153, 0.4);\n}\n\n.gc-btn-icon.primary:active {\n  transform: translateY(0);\n}\n\n/* 过渡动画 */\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n</style>\n'],sourceRoot:''}]);const s=o},928(e,n,a){var t=a(275);t.__esModule&&(t=t.default),'string'==typeof t&&(t=[[e.id,t,'']]),t.locals&&(e.exports=t.locals);(0,a(424).A)('4e1fc118',t,!1,{ssrId:!0})},930(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-input-wrapper[data-v-da91aa2a]{position:relative;display:flex;align-items:center}.gc-input[data-v-da91aa2a]{width:100%;padding:6px 10px;background:rgba(0,0,0,0.2);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:6px;color:var(--gc-text,#f1f5f9);font-size:0.9em}.gc-input[data-v-da91aa2a]:focus{outline:none;border-color:var(--gc-primary,#f472b6)}.gc-input.sm[data-v-da91aa2a]{padding:4px 8px;font-size:0.85em}.gc-textarea[data-v-da91aa2a]{width:100%;padding:8px 10px;background:rgba(0,0,0,0.2);border:1px solid var(--gc-border,rgba(255,255,255,0.1));border-radius:6px;color:var(--gc-text,#f1f5f9);font-size:0.9em;resize:vertical;min-height:80px}.gc-input-suffix[data-v-da91aa2a]{color:var(--gc-text-muted,#94a3b8);font-size:0.85em;margin-left:4px}\n','',{version:3,sources:['webpack://./src/ui/components/GcInput.vue'],names:[],mappings:'AA6CA,mCACE,iBAAkB,CAClB,YAAa,CACb,kBACF,CAEA,2BACE,UAAW,CACX,gBAAiB,CACjB,0BAA8B,CAC9B,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,eACF,CAEA,iCACE,YAAa,CACb,sCACF,CAEA,8BACE,eAAgB,CAChB,gBACF,CAEA,8BACE,UAAW,CACX,gBAAiB,CACjB,0BAA8B,CAC9B,uDAA4D,CAC5D,iBAAkB,CAClB,4BAA8B,CAC9B,eAAgB,CAChB,eAAgB,CAChB,eACF,CAEA,kCACE,kCAAoC,CACpC,gBAAiB,CACjB,eACF',sourcesContent:['<template>\n  <div class="gc-input-wrapper" :class="wrapperClass">\n    <input\n      v-if="type !== \'textarea\'"\n      :type="type"\n      class="gc-input"\n      :class="inputClass"\n      :value="modelValue"\n      :placeholder="placeholder"\n      :readonly="readonly"\n      @input="$emit(\'update:modelValue\', ($event.target as HTMLInputElement).value)"\n    />\n    <textarea\n      v-else\n      class="gc-textarea"\n      :class="inputClass"\n      :value="modelValue"\n      :placeholder="placeholder"\n      :readonly="readonly"\n      :rows="rows"\n      @input="$emit(\'update:modelValue\', ($event.target as HTMLTextAreaElement).value)"\n    ></textarea>\n    <span v-if="suffix" class="gc-input-suffix">{{ suffix }}</span>\n  </div>\n</template>\n\n<script setup lang="ts">\ndefineProps<{\n  modelValue: string | number;\n  type?: \'text\' | \'number\' | \'textarea\';\n  placeholder?: string;\n  readonly?: boolean;\n  size?: \'sm\' | \'md\';\n  suffix?: string;\n  rows?: number;\n  wrapperClass?: string;\n  inputClass?: string;\n}>();\n\ndefineEmits<{\n  (e: \'update:modelValue\', value: string | number): void;\n}>();\n<\/script>\n\n<style scoped>\n.gc-input-wrapper {\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.gc-input {\n  width: 100%;\n  padding: 6px 10px;\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 6px;\n  color: var(--gc-text, #f1f5f9);\n  font-size: 0.9em;\n}\n\n.gc-input:focus {\n  outline: none;\n  border-color: var(--gc-primary, #f472b6);\n}\n\n.gc-input.sm {\n  padding: 4px 8px;\n  font-size: 0.85em;\n}\n\n.gc-textarea {\n  width: 100%;\n  padding: 8px 10px;\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--gc-border, rgba(255, 255, 255, 0.1));\n  border-radius: 6px;\n  color: var(--gc-text, #f1f5f9);\n  font-size: 0.9em;\n  resize: vertical;\n  min-height: 80px;\n}\n\n.gc-input-suffix {\n  color: var(--gc-text-muted, #94a3b8);\n  font-size: 0.85em;\n  margin-left: 4px;\n}\n</style>\n'],sourceRoot:''}]);const s=o},934(e,n,a){a.r(n),a.d(n,{default:()=>s});var t=a(699),i=a.n(t),c=a(465),o=a.n(c)()(i());o.push([e.id,'.gc-debug-content[data-v-18dd7d1a]{display:flex;flex-direction:column;gap:12px}.gc-debug-tabs[data-v-18dd7d1a]{display:flex;gap:4px;padding:4px;background:rgba(0,0,0,0.2);border-radius:8px;flex-wrap:wrap}.gc-debug-tab[data-v-18dd7d1a]{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;padding:8px 12px;background:transparent;border:none;border-radius:6px;color:var(--gc-text-muted,#94a3b8);font-size:0.8em;cursor:pointer;transition:all 0.2s}.gc-debug-tab[data-v-18dd7d1a]:hover{background:rgba(255,255,255,0.05);color:var(--gc-text,#f1f5f9)}.gc-debug-tab.active[data-v-18dd7d1a]{background:var(--gc-primary,#f472b6);color:white}.gc-debug-tab-badge[data-v-18dd7d1a]{padding:1px 6px;background:rgba(255,255,255,0.2);border-radius:10px;font-size:0.85em}.gc-debug-tab.active .gc-debug-tab-badge[data-v-18dd7d1a]{background:rgba(255,255,255,0.3)}.gc-debug-tab-content[data-v-18dd7d1a]{padding:8px 0}.gc-btn-link[data-v-18dd7d1a]{background:transparent;border:none;color:var(--gc-text-muted,#94a3b8);cursor:pointer;padding:4px 8px}.gc-btn-link[data-v-18dd7d1a]:hover{color:var(--gc-text,#f1f5f9)}\n','',{version:3,sources:['webpack://./src/ui/panels/DebugPanel.vue'],names:[],mappings:'AAoJA,mCACE,YAAa,CACb,qBAAsB,CACtB,QACF,CAEA,gCACE,YAAa,CACb,OAAQ,CACR,WAAY,CACZ,0BAA8B,CAC9B,iBAAkB,CAClB,cACF,CAEA,+BACE,MAAO,CACP,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,OAAQ,CACR,gBAAiB,CACjB,sBAAuB,CACvB,WAAY,CACZ,iBAAkB,CAClB,kCAAoC,CACpC,eAAgB,CAChB,cAAe,CACf,mBACF,CAEA,qCACE,iCAAqC,CACrC,4BACF,CAEA,sCACE,oCAAsC,CACtC,WACF,CAEA,qCACE,eAAgB,CAChB,gCAAoC,CACpC,kBAAmB,CACnB,gBACF,CAEA,0DACE,gCACF,CAEA,uCACE,aACF,CAEA,8BACE,sBAAuB,CACvB,WAAY,CACZ,kCAAoC,CACpC,cAAe,CACf,eACF,CAEA,oCACE,4BACF',sourcesContent:['<template>\n  <GcOverlay\n    :visible="visible"\n    title="MVU 调试"\n    icon="fa-solid fa-bug"\n    panel-class="gc-debug-panel"\n    @close="$emit(\'close\')"\n  >\n    <template #header-actions>\n      <button class="gc-btn-link" @click="$emit(\'refresh\')" title="刷新状态">\n        <i class="fa-solid fa-rotate"></i>\n      </button>\n    </template>\n\n    <div class="gc-debug-content">\n      \x3c!-- 选项卡导航 --\x3e\n      <div class="gc-debug-tabs">\n        <button \n          class="gc-debug-tab" \n          :class="{ active: activeTab === \'status\' }" \n          @click="activeTab = \'status\'"\n        >\n          <i class="fa-solid fa-satellite-dish"></i> 状态\n        </button>\n        <button \n          class="gc-debug-tab" \n          :class="{ active: activeTab === \'characters\' }" \n          @click="activeTab = \'characters\'"\n        >\n          <i class="fa-solid fa-users"></i> 角色\n          <span v-if="characterCount" class="gc-debug-tab-badge">{{ characterCount }}</span>\n        </button>\n        <button \n          class="gc-debug-tab" \n          :class="{ active: activeTab === \'test\' }" \n          @click="activeTab = \'test\'"\n        >\n          <i class="fa-solid fa-flask"></i> 测试\n        </button>\n        <button \n          class="gc-debug-tab" \n          :class="{ active: activeTab === \'logs\' }" \n          @click="activeTab = \'logs\'"\n        >\n          <i class="fa-solid fa-terminal"></i> 日志\n          <span v-if="logs.length" class="gc-debug-tab-badge">{{ logs.length }}</span>\n        </button>\n        <button \n          class="gc-debug-tab" \n          :class="{ active: activeTab === \'raw\' }" \n          @click="activeTab = \'raw\'"\n        >\n          <i class="fa-solid fa-database"></i> 原始\n        </button>\n      </div>\n\n      \x3c!-- 状态选项卡 --\x3e\n      <div v-if="activeTab === \'status\'" class="gc-debug-tab-content">\n        <DebugStatusSection :mvu-info="mvuInfo" />\n      </div>\n\n      \x3c!-- 角色选项卡 --\x3e\n      <div v-if="activeTab === \'characters\'" class="gc-debug-tab-content">\n        <DebugCharactersSection :characters="debugCharacters" />\n      </div>\n\n      \x3c!-- 测试选项卡 --\x3e\n      <div v-if="activeTab === \'test\'" class="gc-debug-tab-content">\n        <DebugTestSection\n          :test-name="testName"\n          :test-height="testHeight"\n          :test-original="testOriginal"\n          :characters="characters"\n          @update:test-name="$emit(\'update:testName\', $event)"\n          @update:test-height="$emit(\'update:testHeight\', $event)"\n          @update:test-original="$emit(\'update:testOriginal\', $event)"\n          @inject="$emit(\'inject-test\')"\n          @clear="$emit(\'clear-test\', $event)"\n          @quick-test="$emit(\'quick-test\', $event)"\n          @save-damage="$emit(\'save-damage\', $event)"\n          @clear-damage="$emit(\'clear-damage\', $event)"\n        />\n      </div>\n\n      \x3c!-- 日志选项卡 --\x3e\n      <div v-if="activeTab === \'logs\'" class="gc-debug-tab-content">\n        <DebugLogsSection :logs="logs" @clear="$emit(\'clear-logs\')" />\n      </div>\n\n      \x3c!-- 原始数据选项卡 --\x3e\n      <div v-if="activeTab === \'raw\'" class="gc-debug-tab-content">\n        <DebugRawSection :mvu-info="mvuInfo" :settings="settings" />\n      </div>\n    </div>\n  </GcOverlay>\n</template>\n\n<script setup lang="ts">\nimport { ref, computed } from \'vue\';\nimport { GcOverlay } from \'../components\';\nimport DebugStatusSection from \'../features/debug/DebugStatusSection.vue\';\nimport DebugCharactersSection from \'../features/debug/DebugCharactersSection.vue\';\nimport DebugTestSection from \'../features/debug/DebugTestSection.vue\';\nimport DebugLogsSection from \'../features/debug/DebugLogsSection.vue\';\nimport DebugRawSection from \'../features/debug/DebugRawSection.vue\';\nimport type { MvuDebugInfo } from \'../../services/debug\';\nimport type { Settings } from \'../../types\';\nimport type { CharacterData } from \'../../types\';\n\nconst props = defineProps<{\n  visible: boolean;\n  mvuInfo: MvuDebugInfo;\n  logs: Array<{ time: string; message: string; level?: string }>;\n  settings: Settings;\n  characters: CharacterData[];\n  testName: string;\n  testHeight: number;\n  testOriginal: number;\n}>();\n\ndefineEmits<{\n  (e: \'close\'): void;\n  (e: \'refresh\'): void;\n  (e: \'clear-logs\'): void;\n  (e: \'update:testName\', value: string): void;\n  (e: \'update:testHeight\', value: number): void;\n  (e: \'update:testOriginal\', value: number): void;\n  (e: \'inject-test\'): void;\n  (e: \'clear-test\', name?: string): void;\n  (e: \'quick-test\', params: { name: string; height: number; original: number }): void;\n  (e: \'save-damage\', params: { name: string; data: unknown }): void;\n  (e: \'clear-damage\', name: string): void;\n}>();\n\nconst activeTab = ref<\'status\' | \'characters\' | \'test\' | \'logs\' | \'raw\'>(\'status\');\n\nconst characterCount = computed(() => \n  props.mvuInfo.messageVariables?.characterDetails?.length || 0\n);\n\n// 过滤掉类型为 \'未知\' 的角色，用于显示\nconst debugCharacters = computed(() => {\n  const chars = props.mvuInfo.messageVariables?.characterDetails || [];\n  return chars.filter(c => c.类型 !== \'未知\');\n});\n<\/script>\n\n<style scoped>\n.gc-debug-content {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.gc-debug-tabs {\n  display: flex;\n  gap: 4px;\n  padding: 4px;\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  flex-wrap: wrap;\n}\n\n.gc-debug-tab {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  padding: 8px 12px;\n  background: transparent;\n  border: none;\n  border-radius: 6px;\n  color: var(--gc-text-muted, #94a3b8);\n  font-size: 0.8em;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.gc-debug-tab:hover {\n  background: rgba(255, 255, 255, 0.05);\n  color: var(--gc-text, #f1f5f9);\n}\n\n.gc-debug-tab.active {\n  background: var(--gc-primary, #f472b6);\n  color: white;\n}\n\n.gc-debug-tab-badge {\n  padding: 1px 6px;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 10px;\n  font-size: 0.85em;\n}\n\n.gc-debug-tab.active .gc-debug-tab-badge {\n  background: rgba(255, 255, 255, 0.3);\n}\n\n.gc-debug-tab-content {\n  padding: 8px 0;\n}\n\n.gc-btn-link {\n  background: transparent;\n  border: none;\n  color: var(--gc-text-muted, #94a3b8);\n  cursor: pointer;\n  padding: 4px 8px;\n}\n\n.gc-btn-link:hover {\n  color: var(--gc-text, #f1f5f9);\n}\n</style>\n'],sourceRoot:''}]);const s=o},946(e,n){n.A=(e,n)=>{const a=e.__vccOpts||e;for(const[e,t]of n)a[e]=t;return a}}},c={};function o(e){var n=c[e];if(void 0!==n)return n.exports;var a=c[e]={id:e,exports:{}};return i[e](a,a.exports,o),a.exports}o.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return o.d(n,{a:n}),n},o.d=(e,n)=>{for(var a in n)o.o(n,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},o.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),o.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})};const s='2.6.0',r=[{version:'2.6.0',date:'2024-02',changes:['新增：损害计算系统 - 计算巨大娘行动可能造成的破坏','新增：人员伤亡估算（支持10种人口密度场景）','新增：建筑损毁、街道/城区毁坏估算','新增：宏观破坏力计算（城市/国家/大陆/行星/恒星/星系/宇宙级）','新增：特殊物理效应提示（地震、海啸、引力场等）','新增：扩展系统控制面板 - 在角色列表下方统一管理各计算模块','新增：按角色显示损害数据和汇总统计','新增：损害提示词模板，支持自动注入到 AI 提示词','优化：角色卡片展示损害数据详情','优化：支持多巨大娘损害汇总计算']},{version:'2.5.0',date:'2024-02',changes:['新增：单独部位变化功能 - 可为特定部位设置独立尺寸','新增：自定义部位字段支持，允许部位有不同于整体的变化倍率','新增：自定义部位在输出中带有 ⚡ 标记，便于识别','新增：提示词模板支持 {{自定义部位}} 变量','更新：变量更新规则增加单独部位设置说明','优化：身体数据使用格式化后的值显示']},{version:'2.4.0',date:'2024-02',changes:['新增：世界观模板系统 - 支持不同设定下的变化机制','新增：8种内置世界观（现实物理、玄幻修仙、科幻科技、魔法少女等）','新增：世界观快速切换器，一键切换不同设定','新增：世界观详情面板，展示变化机制、身体特性、特殊规则','新增：自定义世界观创建和编辑功能','新增：世界观提示词自动注入到 AI 提示词','优化：提示词模板系统增加世界观类型支持']},{version:'2.3.0',date:'2024-02',changes:['新增：提示词模板管理系统','新增：可自定义、启用/禁用各类提示词模板','新增：支持创建、编辑、删除自定义模板','新增：模板顺序调整功能','新增：内置变量更新规则模板，指导 AI 更新角色数据','新增：模板支持变量插值（如 {{角色名}}、{{身体数据}} 等）','新增：模板数据存储到全局变量，跨聊天持久化','优化：移除旧的自定义提示词头部，改用更灵活的模板系统']},{version:'2.2.0',date:'2024-02',changes:['数据存储：将角色数据存储位置从聊天变量改为楼层变量','数据存储：每条消息可拥有独立的数据快照','调试功能：调试数据也存储在楼层变量中']},{version:'2.1.0',date:'2024-02',changes:['UI重构：全新现代化界面，更优雅简约','UI优化：引入 Font Awesome 图标库','UI优化：面板高度自适应，大屏浏览体验更好','核心优化：内置 MVU 集成，无需额外安装依赖']},{version:'2.0.0',date:'2024-01',changes:['重构：使用 Vue 3 + Pinia 重写 UI','重构：使用 TailwindCSS 编写样式','重构：模块化架构，符合 tavern_helper_template 规范','优化：代码结构更清晰','优化：设置自动持久化到脚本变量']},{version:'1.2.0',date:'2024-01',changes:['重构：迁移到 tavern_helper_template 模板','新增：TypeScript 支持','新增：模块化架构','优化：代码结构和可维护性']},{version:'1.1.0',date:'2024-01',changes:['新增：角色卡片可展开显示详细数据','新增：自定义提示词头部功能','新增：帮助说明和更新日志面板','优化：UI 交互体验']},{version:'1.0.0',date:'2024-01',changes:['初始版本发布','支持巨大化/缩小化身体数据计算','支持相对尺寸参照物计算','支持互动限制检查','MVU 变量集成和提示词注入']}];$(()=>{(function(){if(!document.getElementById('font-awesome-css')){const e=document.createElement('link');e.id='font-awesome-css',e.rel='stylesheet',e.href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css',document.head.appendChild(e)}})(),console.log('[GiantessCalc] 脚本初始化开始...'),console.log('[GiantessCalc] MVU 已通过内置导入初始化'),console.log(`[GiantessCalc] ✅ 脚本预初始化完成 v${s}`)});const l=Vue,d=z,g=['荒野','乡村','郊区','小城市','中等城市','大城市','超大城市中心','东京市中心','香港','马尼拉','住宅内','公寓楼内','办公楼内','体育馆内','巨大娘体内'],A=d.z.object({enabled:d.z.boolean().default(!0),debug:d.z.boolean().default(!1),variablePrefix:d.z.string().default('巨大娘'),autoInject:d.z.boolean().default(!0),injectDepth:d.z.number().default(1),injectInteractionLimits:d.z.boolean().default(!0),precision:d.z.number().default(2),maxHistoryRecords:d.z.number().default(20),showVariableUpdateRules:d.z.boolean().default(!0),showWritingGuidelines:d.z.boolean().default(!1),compactPromptFormat:d.z.boolean().default(!1),injectWorldviewPrompt:d.z.boolean().default(!0),allowPartialScaling:d.z.boolean().default(!1),enableDamageCalculation:d.z.boolean().default(!1),injectDamagePrompt:d.z.boolean().default(!0),damageScenario:d.z.string().default('大城市'),showSpecialEffects:d.z.boolean().default(!0),showDamagePerCharacter:d.z.boolean().default(!0),showDamageSummary:d.z.boolean().default(!0)}).prefault({}),p=n('giantess-calculator-settings',()=>{const e=(0,l.ref)(A.parse(getVariables({type:'script',script_id:getScriptId()})));(0,l.watchEffect)(()=>{insertOrAssignVariables(t(e.value),{type:'script',script_id:getScriptId()})});const n=(0,l.ref)([]),a=(a,...t)=>{if(!e.value.debug)return;const i=(new Date).toLocaleTimeString(),c=t.map(e=>'object'==typeof e?JSON.stringify(e,null,2):String(e)).join(' ');n.value.push({time:i,type:a,message:c}),n.value.length>50&&n.value.shift()};return{settings:e,toggle:()=>{e.value.enabled=!e.value.enabled},log:(...n)=>{e.value.debug&&console.log('[GiantessCalc]',...n)},warn:(...e)=>{console.warn('[GiantessCalc]',...e)},error:(...e)=>{console.error('[GiantessCalc]',...e)},debugLogs:n,debugLog:(...n)=>{e.value.debug&&(console.log('[GiantessCalc]',...n),a('log',...n))},debugWarn:(...e)=>{console.warn('[GiantessCalc]',...e),a('warn',...e)},debugError:(...e)=>{console.error('[GiantessCalc]',...e),a('error',...e)},clearDebugLogs:()=>{n.value=[]}}}),m=1.75,C={身高:1.75,眼睛高度:1.61,肩膀高度:1.4,胸部顶端:1.4,胸部底端:1.23,肚脐高度:1.01,臀部高度:1.01,裆部高度:.86,大腿中部:.66,小腿肚:.45,脚踝高度:.08,大脚趾:.02,小脚趾:.01,足长:.25,足宽:.1,大脚趾长:.045,脚趾缝隙:.008,手掌长:.1,手掌宽:.08,手指长:.08,指尖面积:7e-5,指甲厚度:6e-4,指甲宽度:.01,乳房高度:.14,乳房宽度:.12,乳沟深度:.06,乳头直径:.01,单乳重量:1.06,臀部宽度:.9,臀沟深度:.06,臀部重量:26.5,腰部宽度:.185,肚脐直径:.015,肚脐深度:.015,阴阜高度:.06,阴阜宽度:.11,大阴唇长:.08,大阴唇宽:.035,小阴唇长:.05,阴蒂长:.03,阴道口宽:.025,阴道深度_闭合:.085,阴道深度_扩张:.11,阴道容积_闭合:65e-7,阴道容积_扩张:175e-7,宫颈长:.03,宫颈直径:.022,子宫容积:14e-5,输卵管长:.11,输卵管直径:.0025,头发直径:7e-5,阴毛直径:12e-5,阴毛长:.03,嘴巴宽度:.05,舌头长:.1,舌头宽:.05},u={普通成年人:1.7,普通男性:1.75,普通女性:1.65,小孩:1.2,婴儿:.5,智能手机:.15,硬币直径:.025,硬币厚度:.002,信用卡:.085,易拉罐:.12,矿泉水瓶:.22,篮球:.24,足球:.22,餐桌高度:.75,椅子高度:.45,床长度:2,沙发长度:2.5,轿车长度:4.5,轿车高度:1.5,公交车长度:12,公交车高度:3.2,火车车厢长:25,飞机_客机长:70,航母长度:330,单层楼高:3,两层楼房:7,十层楼房:30,五十层大楼:150,自由女神像:46,埃菲尔铁塔:330,哈利法塔:828,云层高度:2e3,珠穆朗玛峰:8848,臭氧层高度:25e3,国际空间站轨道:4e5,大气层顶端:1e5,月球直径:3474e3,地球直径:12742e3,地月距离:3844e5,太阳直径:1392e6,土星直径:11646e4,木星直径:13982e4,日地距离_1AU:149597870700,光年:9460730472580800,银河系直径:94607304725808e8},b={蚂蚁:.003,蟑螂:.03,蜜蜂:.015,苍蝇:.007,蚊子:.006,跳蚤:.002,螨虫:3e-4,细菌:2e-6},v=[{name:'Mini级',minScale:1,maxScale:10,description:'几米到十几米'},{name:'十倍',minScale:10,maxScale:100,description:'十几米，建筑如玩具'},{name:'Kilo级',minScale:100,maxScale:1e3,description:'百米级，城市踩在脚下'},{name:'千倍',minScale:1e3,maxScale:1e4,description:'公里级，山脉如石子'},{name:'Mega级_万倍',minScale:1e4,maxScale:1e5,description:'十公里级，触及云层'},{name:'Mega级_十万倍',minScale:1e5,maxScale:1e6,description:'百公里级，行星尺度'},{name:'Giga级_百万倍',minScale:1e6,maxScale:1e7,description:'千公里级，星球如玩具'},{name:'Giga级_千万倍',minScale:1e7,maxScale:1e8,description:'万公里级，地球如球'},{name:'Giga级_亿倍',minScale:1e8,maxScale:1e9,description:'十万公里级，地月如近邻'},{name:'Tera级_十亿倍',minScale:1e9,maxScale:1e10,description:'百万公里级，恒星如灯泡'},{name:'Tera级_百亿倍',minScale:1e10,maxScale:1e11,description:'千万公里级，太阳系穿行'},{name:'Tera级_千亿倍',minScale:1e11,maxScale:1e12,description:'AU级，恒星如尘埃'},{name:'星系级_万亿倍',minScale:1e12,maxScale:1e13,description:'10AU级'},{name:'星系级_十万亿倍',minScale:1e13,maxScale:1e16,description:'光年级'},{name:'光年级',minScale:1e16,maxScale:1e21,description:'星云星系'},{name:'宇宙级',minScale:1e21,maxScale:1/0,description:'超越可观测宇宙'}],f=[{name:'十分之一',scale:.1,description:'十几厘米，如宠物'},{name:'百分之一',scale:.01,description:'不到两厘米，如虫子'},{name:'千分之一_毫米级',scale:.001,description:'毫米级，蚂蚁如猛兽'},{name:'万分之一',scale:1e-4,description:'肉眼难见'},{name:'微米级',scale:1e-6,description:'细胞尺度'},{name:'纳米级',scale:1e-9,description:'分子尺度'},{name:'皮米级',scale:1e-12,description:'原子尺度'}];let x=2;function h(e,n=x){const a=Math.pow(10,n);return Math.round(e*a)/a}function B(e,n=!0){const a=Math.abs(e);if(n){const n=9460730472580800,t=149597870700;if(a>=1e3*n)return`${h(e/n)}光年`;if(a>=n)return`${h(e/n,3)}光年`;if(a>=t)return`${h(e/t)}AU`}return a>=1e6||a>=1e3?`${h(e/1e3)}公里`:a>=1?`${h(e)}米`:a>=.01?`${h(100*e)}厘米`:a>=.001?`${h(1e3*e)}毫米`:a>=1e-6?`${h(1e6*e)}微米`:a>=1e-9?`${h(1e9*e)}纳米`:`${h(1e12*e)}皮米`}function E(e){return e>=1e12?`${h(e/1e12)}万亿吨`:e>=1e9?`${h(e/1e9)}十亿吨`:e>=1e6?`${h(e/1e6)}百万吨`:e>=1e3?`${h(e/1e3)}吨`:`${h(e)}千克`}function w(e){return e>=1e9?`${h(e/1e9)}立方公里`:e>=1?`${h(e)}立方米`:e>=.001?`${h(1e3*e)}升`:e>=1e-6?`${h(1e6*e)}毫升`:`${h(1e9*e)}立方毫米`}function y(e){return e>=1e6?`${h(e/1e6)}平方公里`:e>=1?`${h(e)}平方米`:e>=1e-4?`${h(1e4*e)}平方厘米`:`${h(1e6*e)}平方毫米`}function k(e){if(e>=1){for(const n of v)if(e>=n.minScale&&e<n.maxScale)return{...n,type:'giant'};return{name:'宇宙级',description:'超越可观测宇宙',type:'giant'}}for(const n of f)if(e<=10*n.scale&&e>n.scale/10)return{...n,type:'tiny'};return{name:'亚原子级',description:'比原子还小',type:'tiny'}}function V(e,n=1.65,a={}){const t=e/n,i=k(t),c={},o={},s={},r={};for(const[e,i]of Object.entries(C)){if(void 0!==a[e]){const t=a[e],l=t/(i*(n/m));c[e]=t,o[e]=h(l),s[e]=h(t),e.includes('重量')?r[e]=E(t)+' ⚡':e.includes('容积')?r[e]=w(t)+' ⚡':e.includes('面积')?r[e]=y(t)+' ⚡':r[e]=B(t,t>1e10)+' ⚡';continue}if(e.includes('重量')){const a=i*Math.pow(t,3)*(n/m);s[e]=h(a),r[e]=E(a)}else if(e.includes('容积')){const a=i*Math.pow(t,3)*Math.pow(n/m,3);s[e]=h(a,6),r[e]=w(a)}else if(e.includes('面积')){const a=i*Math.pow(t,2)*Math.pow(n/m,2);s[e]=h(a,6),r[e]=y(a)}else{const a=i*t*(n/m);s[e]=h(a),r[e]=B(a,t>1e10)}}const l={},d={};for(const[e,n]of Object.entries(u)){const a=n/t;l[e]=h(a,4),d[e]=B(a,!1)}for(const[e,n]of Object.entries(b)){const a=n/t;l[e]=h(a,8),d[e]=B(a,!1)}const g=function(e,n,a,t){const i=[];return i.push(`【${n.name}】${n.description}`),i.push(''),e<100?(i.push('在她眼中：'),i.push(`- 普通人类：${t.普通成年人}`),i.push(`- 轿车：${t.轿车长度}`),i.push(`- 两层楼房：${t.两层楼房}`)):e<1e4?(i.push('在她眼中：'),i.push(`- 普通人类：${t.普通成年人}`),i.push(`- 十层楼房：${t.十层楼房}`),i.push(`- 埃菲尔铁塔：${t.埃菲尔铁塔}`)):e<1e6?(i.push('在她眼中：'),i.push(`- 珠穆朗玛峰：${t.珠穆朗玛峰}`),i.push(`- 云层：${t.云层高度}`),i.push(`- 国际空间站：${t.国际空间站轨道}`)):e<1e9?(i.push('在她眼中：'),i.push(`- 地球直径：${t.地球直径}`),i.push(`- 月球直径：${t.月球直径}`)):e<1e12?(i.push('在她眼中：'),i.push(`- 太阳直径：${t.太阳直径}`),i.push(`- 地月距离：${t.地月距离}`)):(i.push('在她眼中：'),i.push(`- 日地距离：${t.日地距离_1AU}`),e>1e16&&i.push(`- 银河系：${t.银河系直径}`)),i.push(''),i.push('关键身体数据：'),i.push(`- 身高：${a.身高}`),i.push(`- 足长：${a.足长}`),i.push(`- 手掌：${a.手掌长}`),i.join('\n')}(t,i,r,d);return{原身高:n,当前身高:e,当前身高_格式化:B(e,t>1e10),倍率:h(t),级别:i.name,级别描述:i.description,身体部位:s,身体部位_格式化:r,自定义部位:c,自定义部位_倍率:o,眼中的世界:l,眼中的世界_格式化:d,描述:g,_计算时间:Date.now(),_版本:'1.3'}}function N(e,n=1.7){const a=e/n,t=k(a),i={},c={};for(const[e,n]of Object.entries(C))if(!e.includes('重量')&&!e.includes('容积')&&!e.includes('面积')){const t=n/a;i[e]=h(t),c[e]=B(t,!1)}const o=function(e,n,a){const t=[];return t.push(`【${n.name}】${n.description}`),t.push(''),t.push('正常女性在他眼中：'),t.push(`- 身高：${a.身高}`),t.push(`- 脚掌：${a.足长}`),t.push(`- 脚趾：${a.大脚趾长}`),e<.01&&(t.push(`- 阴毛：${a.阴毛长}`),t.push(`- 毛发直径：${a.头发直径}`)),t.join('\n')}(a,t,c);return{原身高:n,当前身高:e,当前身高_格式化:B(e,!1),倍率:h(a,6),级别:t.name,级别描述:t.description,眼中的巨大娘:i,眼中的巨大娘_格式化:c,描述:o,_计算时间:Date.now(),_版本:'1.2'}}const D={手指撩下巴:{minRatio:.05,description:'需要小者至少有几厘米大，否则手指无法精确操作',alternatives:'可以用指尖轻触、用指甲拨弄'},手掌握住:{minRatio:.01,description:'需要小者有一定大小才能被手掌握住',alternatives:'可以用指尖捏住、放在掌心'},双手捧起:{minRatio:.02,description:'需要小者有足够体积才能双手捧起',alternatives:'可以放在单手掌心、用指尖拿起'},拥抱:{minRatio:.3,description:'需要双方体型相近才能拥抱',alternatives:'可以将小者贴在身上、放在胸口'},亲吻嘴唇:{minRatio:.02,description:'需要小者至少和嘴唇差不多大',alternatives:'可以舔舐、用舌尖触碰、整个含入口中'},踩在脚下_感知:{minRatio:.001,description:'需要小者至少毫米级才能被感知到踩踏感',alternatives:'更小的小人会被完全无视，如同灰尘'},脚趾夹住:{minRatio:.005,description:'需要小者有一定大小才能被脚趾夹住',alternatives:'可以卡在脚趾缝中、粘在脚趾上'},用脚玩弄:{minRatio:.01,description:'需要小者足够大才能被脚有意识地玩弄',alternatives:'可以无意识地踩踏、碾压'},舌头卷起:{minRatio:.005,description:'需要小者有一定大小才能被舌头卷起',alternatives:'可以用唾液粘住、随唾液吞下'},咀嚼:{minRatio:.01,description:'需要小者有一定大小才值得咀嚼',alternatives:'可以直接吞下、随食物一起吞咽'},活吞_有感觉:{minRatio:.005,description:'需要小者至少几毫米才能在吞咽时被感知',alternatives:'更小的会像灰尘一样被无意识吞下'},入阴_有感觉:{minRatio:.005,description:'需要小者至少几毫米才能在阴道内被感知',alternatives:'更小的会完全无感，如同细菌'},入菊_有感觉:{minRatio:.005,description:'需要小者至少几毫米才能在肛门内被感知',alternatives:'更小的会完全无感'},乳沟夹住:{minRatio:.02,description:'需要小者有一定大小才能被乳沟夹住',alternatives:'可以藏在乳沟褶皱中、粘在皮肤上'},肉眼可见:{minRatio:1e-4,description:'需要小者至少0.1毫米才能被肉眼看见',alternatives:'需要放大镜或显微镜才能看到'},清晰辨认面容:{minRatio:.001,description:'需要小者至少1毫米才能辨认面容',alternatives:'只能看到一个小点或模糊轮廓'},听到声音:{minRatio:.001,description:'需要小者至少毫米级才可能发出可听见的声音',alternatives:'声音太小，完全听不到'},正常对话:{minRatio:.05,description:'需要双方体型差距不太大才能正常对话',alternatives:'需要扩音设备或特殊能力才能交流'}};function F(e,n,a){const t=n/e,i=[],c=[],o={};for(const[e,n]of Object.entries(D))t>=n.minRatio?i.push(e):(c.push({action:e,reason:n.description,alternative:n.alternatives}),o[e]=n.alternatives);const s=(e,n=2)=>Math.round(e*Math.pow(10,n))/Math.pow(10,n);return{ratio:t,ratioFormatted:t>=.01?`${s(100*t)}%`:`1/${s(1/t)}`,smallInBigEyes:a(n),possible:i,impossible:c,alternatives:o}}function S(e,n,a){if(0===a.impossible.length)return`${e}与${n}的体型差距不大，可以进行大多数正常互动。`;const t=[];t.push(`【${e}与${n}的互动限制】`),t.push(`体型比例：${n}是${e}的${a.ratioFormatted}`),t.push(`${n}在${e}眼中约${a.smallInBigEyes}大小`),t.push(''),t.push('以下互动在物理上不合理，请避免或使用替代方案：');for(const e of a.impossible)t.push(`- ${e.action}：${e.reason}`),e.alternative&&t.push(`  → 替代：${e.alternative}`);return t.join('\n')}const T={荒野:1,乡村:50,郊区:500,小城市:3e3,中等城市:5e3,大城市:1e4,超大城市中心:25e3,东京市中心:15e3,香港:27e3,马尼拉:43e3,住宅内:4e4,公寓楼内:8e4,办公楼内:1e5,体育馆内:5e5,巨大娘体内:0},j={荒野:0,乡村:20,郊区:200,小城市:500,中等城市:800,大城市:1200,超大城市中心:2e3,住宅内:0,公寓楼内:0,办公楼内:0,体育馆内:0,巨大娘体内:0},I={直径:9461e17,恒星数量:2e11,行星估计:1e11},W={直径:879873e21,星系数量:2e12};function M(e){return e>=1e12?`${h(e/1e12)}万亿`:e>=1e8?`${h(e/1e8)}亿`:e>=1e4?`${h(e/1e4)}万`:e>=1e3?`${h(e/1e3)}千`:`${h(e)}`}function Y(e,n=1.65,a='大城市'){const t=e/n,i=e/7,c=i*(.4*i),o=c/1e6,s=Math.sqrt(c),r={足迹面积:c,足迹面积_格式化:y(c),足迹直径:s,足迹直径_格式化:B(s)},l=o*(T[a]||T['大城市']),d=.2*l,g=o*(j[a]||j['大城市']),A=.5*g,p=o/.01;let m=0,C='无';o>=.05&&(m=o/1,C=m<1?'部分城区':m<5?'多个城区':'大片城区');const b={小人伤亡:{最小估计:d,最大估计:l,格式化:(x=d,E=l,x===E?M(x)+'人':E<10?`${h(x)}-${h(E)}人`:`${M(x)}-${M(E)}人`),描述:(f=(d+l)/2,f<1?'基本无伤亡':f<10?'少量伤亡':f<100?'数十人伤亡':f<1e3?'数百人伤亡':f<1e4?'数千人伤亡，相当于一场严重事故':f<1e5?'数万人伤亡，相当于一场大型灾难':f<1e6?'数十万人伤亡，相当于一场毁灭性灾难':f<1e7?'数百万人伤亡，相当于一座大城市人口':f<1e8?'数千万人伤亡，相当于一个中等国家人口':f<1e9?'数亿人伤亡，相当于一个大国人口':'数十亿人伤亡，人类文明级别灾难')},建筑损毁:{最小估计:A,最大估计:g,格式化:g<1?'不到1栋':`${M(A)}-${M(g)}栋`,描述:(v=(A+g)/2,v<1?'基本无损坏':v<10?'少量建筑损毁':v<100?'数十栋建筑损毁':v<1e3?'数百栋建筑损毁，约等于一个小区':v<1e4?'数千栋建筑损毁，约等于一个城区':v<1e5?'数万栋建筑损毁，约等于一座城市':'数十万栋以上建筑损毁，多座城市被夷平')},街道损毁:{数量:p,格式化:p<1?'不到1条':`约${M(p)}条`},城区损毁:{数量:m,格式化:m<.1?'微乎其微':`约${h(m,1)}个`,等级:C}};var v,f,x,E;const w={};for(const[e,n]of Object.entries(T)){const a=o*n*.5;w[e]={伤亡:a,格式化:M(a)+'人'}}const k=function(e,n){if(e<1e4)return null;const a={等级:'city',等级名称:'城市级',描述:'',城市:null,国家:null,大陆:null,行星:null,恒星:null,星系:null};if(n>=1){const e=n/200;e>=.01&&(a.城市={数量:e,格式化:e>=1?`${h(e)}座城市`:`${h(100*e)}%的城市`})}const t=1e5;if(n>=1e4){const e=n/t;a.等级='country',a.等级名称='国家级',a.国家={数量:e,格式化:e>=1?`${h(e)}个国家`:`${h(100*e)}%的国家领土`}}const i=3e7;if(n>=3e6){const e=n/i;a.等级='continent',a.等级名称='大陆级',a.大陆={数量:e,格式化:e>=1?`${h(e)}个大陆`:`${h(100*e)}%的大陆`}}if(e>=.1*u.地球直径){const n=e/u.地球直径;a.等级='planet',a.等级名称='行星级',a.行星={数量:Math.pow(n,3),格式化:n>=1?`可轻易摧毁${h(Math.pow(n,3))}个地球大小的行星`:'可严重破坏行星表面'}}if(e>=.1*u.太阳直径){const n=e/u.太阳直径;a.等级='star',a.等级名称='恒星级',a.恒星={数量:Math.pow(n,3),格式化:n>=1?`可摧毁${M(Math.pow(n,3))}个太阳大小的恒星`:'可严重影响恒星'}}const c=I.直径;if(e>=.001*c){const n=e/c;a.等级='galaxy',a.等级名称='星系级';const t=I.恒星数量*Math.pow(n,3);a.星系={数量:n>=1?Math.pow(n,3):n,格式化:n>=1?`可摧毁${M(Math.pow(n,3))}个银河系大小的星系`:`一步可毁灭${M(t)}颗恒星`}}return e>=.01*W.直径&&(a.等级='universe',a.等级名称='宇宙级',a.描述='已超越可观测宇宙尺度，破坏力无法估量'),a.描述||(a.描述=`达到${a.等级名称}破坏力`),a}(e,o),{level:V,description:N}=(D=e)<10?{level:'微型',description:'可造成局部破坏，类似小型事故'}:D<100?{level:'建筑级',description:'可轻易破坏建筑物'}:D<1e3?{level:'街区级',description:'一步可跨越多个街区'}:D<1e4?{level:'城区级',description:'行走即可摧毁整个城区'}:D<1e5?{level:'城市级',description:'一脚可踏平一座城市'}:D<1e6?{level:'国家级',description:'跨步可横跨国家'}:D<u.地球直径?{level:'大陆级',description:'可轻易横跨大陆'}:D<u.太阳直径?{level:'行星级',description:'行星如玩具般大小'}:D<u.日地距离_1AU?{level:'恒星级',description:'恒星如灯泡般大小'}:D<u.光年?{level:'星系级',description:'可在星系间穿行'}:{level:'宇宙级',description:'超越已知宇宙尺度'};var D;const F=function(e){const n=[];return e>=100&&n.push('脚步引发局部地震'),e>=1e3&&(n.push('行走产生强风暴'),n.push('脚步可引发海啸')),e>=1e4&&(n.push('身体影响局部天气'),n.push('呼吸产生飓风')),e>=1e5&&(n.push('头部进入云层/平流层'),n.push('体温影响区域气候')),e>=1e6&&(n.push('身体产生可观测引力场'),n.push('可能影响地球自转')),e>=u.地球直径&&(n.push('质量可能形成行星级引力'),n.push('存在即可改变轨道')),e>=u.太阳直径&&(n.push('质量接近或超过恒星'),n.push('可能引发核聚变反应')),e>=u.日地距离_1AU&&n.push('引力可撕裂星系结构'),n}(e);return{身高:e,身高_格式化:B(e,t>1e10),倍率:h(t),足迹:r,单步损害:b,各场景伤亡:w,宏观破坏:k,破坏力等级:V,破坏力描述:N,特殊效应:F,_计算时间:Date.now()}}function O(e,n){const a=[];if(a.push(`【${e}的破坏力数据】`),a.push(`当前身高：${n.身高_格式化}（${n.倍率}倍）`),a.push(`破坏力等级：${n.破坏力等级} - ${n.破坏力描述}`),a.push(''),a.push('【足迹影响】'),a.push(`- 足迹面积：${n.足迹.足迹面积_格式化}`),a.push(`- 足迹直径：${n.足迹.足迹直径_格式化}`),a.push(''),a.push('【每一步可能造成的损害】（大城市场景）'),a.push(`- 人员伤亡：${n.单步损害.小人伤亡.格式化}`),a.push(`  ${n.单步损害.小人伤亡.描述}`),a.push(`- 建筑损毁：${n.单步损害.建筑损毁.格式化}`),a.push(`  ${n.单步损害.建筑损毁.描述}`),a.push(`- 街道损毁：${n.单步损害.街道损毁.格式化}`),n.单步损害.城区损毁.数量>0&&a.push(`- 城区损毁：${n.单步损害.城区损毁.格式化}（${n.单步损害.城区损毁.等级}）`),n.宏观破坏&&(a.push(''),a.push(`【宏观破坏力】${n.宏观破坏.等级名称}`),n.宏观破坏.城市&&a.push(`- 城市毁灭：${n.宏观破坏.城市.格式化}`),n.宏观破坏.国家&&a.push(`- 国家毁灭：${n.宏观破坏.国家.格式化}`),n.宏观破坏.大陆&&a.push(`- 大陆毁灭：${n.宏观破坏.大陆.格式化}`),n.宏观破坏.行星&&a.push(`- 行星破坏：${n.宏观破坏.行星.格式化}`),n.宏观破坏.恒星&&a.push(`- 恒星破坏：${n.宏观破坏.恒星.格式化}`),n.宏观破坏.星系&&a.push(`- 星系破坏：${n.宏观破坏.星系.格式化}`)),n.特殊效应.length>0){a.push(''),a.push('【特殊物理效应】');for(const e of n.特殊效应)a.push(`- ${e}`)}return a.join('\n')}function P(e){const n=[];return n.push(`破坏力:${e.破坏力等级}`),n.push(`足迹:${e.足迹.足迹面积_格式化}`),n.push(`单步伤亡:${e.单步损害.小人伤亡.格式化}`),n.push(`建筑损毁:${e.单步损害.建筑损毁.格式化}`),e.宏观破坏&&n.push(`宏观:${e.宏观破坏.等级名称}`),e.特殊效应.length>0&&n.push(`效应:${e.特殊效应.slice(0,2).join('/')}`),n.join(' | ')}function R(e){return e>=1.5?'giant':e<=.8?'tiny':'normal'}function U(e,n,a){return e/n>=1?V(e,n,a):N(e,n)}function q(e,n,a='大城市'){return e/n<1?null:Y(e,n,a)}function G(e,n){let a,t;e.height>=n.height?(a=e,t=n):(a=n,t=e);const i=F(a.height,t.height,B);return{大者:a.name,小者:t.name,...i,提示:S(a.name,t.name,i)}}function L(e,n){return e.replace(/\{\{(\w+)\}\}/g,(e,a)=>{const t=n[a];return void 0!==t?String(t):e})}function H(e,n,a,t={}){const i=[];if('身体部位_格式化'in n&&n.身体部位_格式化)for(const[e,a]of Object.entries(n.身体部位_格式化))i.push(`- ${e}: ${a}`);let c='';if('自定义部位'in n&&n.自定义部位){const e=Object.entries(n.自定义部位);if(e.length>0){const a=['\n**⚡ 自定义部位**（与整体倍率不同）'],t=n.自定义部位_倍率||{};for(const[n,i]of e){const e=t[n]?`（${t[n]}倍）`:'';a.push(`- ${n}: ${B(i)} ${e}`)}c=a.join('\n')}}const o=[];if('眼中的世界_格式化'in n&&n.眼中的世界_格式化)for(const[e,a]of Object.entries(n.眼中的世界_格式化))o.push(`- ${e}: ${a}`);const s=t.worldview?function(e){const n=[];if(n.push(`# 世界观设定：${e.name}`),n.push(''),n.push(e.description),n.push(''),n.push('## 变化机制'),n.push(e.mechanism),n.push(''),n.push('## 身体特性'),n.push(e.bodyCharacteristics),n.push(''),e.limitations.length>0&&'无'!==e.limitations[0]){n.push('## 限制与代价');for(const a of e.limitations)n.push(`- ${a}`);n.push('')}if(e.specialRules.length>0){n.push('## 特殊规则');for(const a of e.specialRules)n.push(`- ${a}`);n.push('')}if(e.writingTips.length>0){n.push('## 写作建议');for(const a of e.writingTips)n.push(`- ${a}`)}return n.join('\n')}(t.worldview):'';let r='';return t.damageData&&t.enableDamageCalculation&&(r=t.compactPromptFormat?P(t.damageData):O(e,t.damageData)),{角色名:e,当前身高:n.当前身高,当前身高_格式化:n.当前身高_格式化,原身高:a,原身高_格式化:B(a),倍率:n.倍率,级别:n.级别,描述:n.描述,身体数据:i.join('\n')||'（无数据）',自定义部位:c,相对参照:o.join('\n')||'（无数据）',互动限制列表:'',世界观提示词:s,世界观名称:t.worldview?.name||'',损害数据:r}}const Q=[{id:'header',name:'头部说明',description:'提示词的开头部分',enabled:!0,order:0,type:'header',builtin:!0,content:'【巨大娘/小人 数据参考】\n\n以下是当前场景中角色的尺寸数据，请在描写时参考这些数据保持一致性。'},{id:'character-data',name:'角色数据',description:'每个角色的身体数据（自动生成）',enabled:!0,order:10,type:'character',builtin:!0,content:'## {{角色名}}\n\n**基础信息**\n- 当前身高：{{当前身高_格式化}}（{{倍率}}倍，{{级别}}）\n- 原始身高：{{原身高_格式化}}\n\n**身体数据**\n{{身体数据}}\n{{自定义部位}}\n**相对参照**\n{{相对参照}}\n\n{{描述}}'},{id:'interaction-limits',name:'互动限制',description:'角色之间的互动限制说明',enabled:!0,order:20,type:'interaction',builtin:!0,content:'---\n\n# 互动物理限制\n\n以下互动在当前体型差距下**物理上不合理**，请避免或使用替代方案：\n\n{{互动限制列表}}'},{id:'variable-update-rules',name:'变量更新规则',description:'指导 AI 如何更新角色数据变量',enabled:!0,order:30,type:'rules',builtin:!0,content:'---\n\n# 变量更新规则\n\n当角色身高发生变化时，请在回复末尾使用以下格式更新数据：\n\n```\n_.set(\'巨大娘.{{角色名}}.当前身高\', {{新身高数值}});\n_.set(\'巨大娘.{{角色名}}.变化原因\', \'{{变化原因}}\');\n_.set(\'巨大娘.{{角色名}}.变化时间\', \'{{当前时间点}}\');\n```\n\n**单独部位变化**（可选）：\n如果某个部位单独变化（如胸部、脚掌等），使用以下格式：\n\n```\n_.set(\'巨大娘.{{角色名}}.自定义部位.乳房高度\', {{尺寸米}});\n_.set(\'巨大娘.{{角色名}}.自定义部位.足长\', {{尺寸米}});\n```\n\n**场景设置**（可选）：\n当场景发生变化时，可以设置当前场景以更准确地计算损害数据：\n\n```\n_.set(\'巨大娘._场景.当前场景\', \'{{场景名称}}\');\n_.set(\'巨大娘._场景.场景原因\', \'{{为什么在这个场景}}\');\n```\n\n可用场景列表：\n- **户外场景**：荒野、乡村、郊区、小城市、中等城市、大城市、超大城市中心、东京市中心、香港、马尼拉\n- **室内场景**：住宅内、公寓楼内、办公楼内、体育馆内\n- **特殊场景**：巨大娘体内（小人进入巨大娘身体内部）\n\n**注意事项**：\n- 身高和部位尺寸单位均为**米**，如 170米 写作 `170`，1.7公里 写作 `1700`\n- 变化原因应简短描述导致身高变化的原因\n- 变化时间可以是故事中的时间点描述\n- 自定义部位会独立计算倍率，未设置的部位按整体倍率缩放\n- 场景设置会影响损害计算的人口密度和建筑密度'},{id:'worldview',name:'世界观设定',description:'当前世界观的变化机制和特殊规则（自动生成）',enabled:!0,order:35,type:'worldview',builtin:!0,content:'{{世界观提示词}}'},{id:'damage-calculation',name:'损害计算',description:'每个角色行动可能造成的破坏数据',enabled:!0,order:25,type:'damage',builtin:!0,requiresFeature:'damageCalculation',content:'---\n\n# 破坏力数据\n\n{{损害数据}}'},{id:'writing-guidelines',name:'写作指南',description:'针对巨大娘/小人场景的写作建议',enabled:!1,order:40,type:'footer',builtin:!0,content:'---\n\n# 写作建议\n\n1. **尺度感知**：注意描写时的比例关系，小人在巨大娘眼中可能只是一个小点\n2. **感官差异**：巨大娘可能听不到小人的声音，小人可能被巨大娘的脚步声震耳欲聋\n3. **互动真实性**：考虑物理上是否可行，避免不合理的互动描写\n4. **视角切换**：可以在巨大娘视角和小人视角之间切换，增加沉浸感'}],Z='giantessCalc_promptTemplates',X=n('giantess-calculator-prompts',()=>{const e=(0,l.ref)((()=>{const e=getVariables({type:'global'}),n=e?.[Z];if(n&&Array.isArray(n)){const e=Q.filter(e=>e.builtin).map(e=>e.id),a=n.filter(n=>!e.includes(n.id)),t=n.filter(n=>e.includes(n.id));return[...Q.filter(e=>e.builtin).map(e=>{const n=t.find(n=>n.id===e.id);return n?{...e,enabled:n.enabled,order:n.order,content:n.content}:e}),...a].sort((e,n)=>e.order-n.order)}return[...Q]})());(0,l.watchEffect)(()=>{insertOrAssignVariables({[Z]:t(e.value)},{type:'global'})});const n=(0,l.computed)(()=>e.value.filter(e=>e.enabled).sort((e,n)=>e.order-n.order));return{templates:e,enabledTemplates:n,toggleTemplate:n=>{const a=e.value.find(e=>e.id===n);a&&(a.enabled=!a.enabled)},updateTemplate:(n,a)=>{const t=e.value.findIndex(e=>e.id===n);-1!==t&&(e.value[t]={...e.value[t],...a})},addTemplate:n=>{const a=Math.max(...e.value.map(e=>e.order),0);e.value.push({...n,id:`custom-${Date.now()}`,order:a+10,builtin:!1})},removeTemplate:n=>{const a=e.value.find(e=>e.id===n);a&&!a.builtin&&(e.value=e.value.filter(e=>e.id!==n))},resetToDefaults:()=>{e.value=[...Q]},moveTemplate:(n,a)=>{const t=[...e.value].sort((e,n)=>e.order-n.order),i=t.findIndex(e=>e.id===n);if(-1===i)return;if('up'===a&&0===i)return;if('down'===a&&i===t.length-1)return;const c='up'===a?i-1:i+1,o=t[i].order;t[i].order=t[c].order,t[c].order=o},getTemplate:n=>e.value.find(e=>e.id===n)}}),J=[{id:'realistic-physics',name:'现实物理',icon:'fa-solid fa-atom',description:'遵循物理定律的硬核设定，身体素质随体型指数增长',mechanism:'巨大化/缩小化遵循物理定律：\n- 身高变为N倍时，体重变为N³倍\n- 力量与肌肉横截面积成正比（N²倍）\n- 相对力量随体型增大而降低（力量/体重 = 1/N）\n- 代谢率、散热等受到平方立方定律影响',bodyCharacteristics:'体型变化后的身体特征：\n- 巨大化：相对力量下降，但绝对力量极强；需要更多食物和氧气；体温调节困难\n- 缩小化：相对力量增强，可以举起相对体重更重的物体；但绝对力量很弱\n- 骨骼密度、肌肉结构会有相应变化以支撑新体型',limitations:['巨大化超过一定程度会有骨骼支撑问题','超小体型会有体温维持困难','需要与体型匹配的食物和水','无法随意控制变化程度'],specialRules:['小人可能被踩踏时受到物理伤害','巨人的每一步都会造成地震效果','声音传播受体型影响，小人说话巨人可能听不见'],writingTips:['注意描写重量感和震动感','考虑温度差异（小人体温流失快）','描写呼吸、心跳等生理差异','小人视角注意空气流动、气味等感知差异'],builtin:!0,allowPartialScaling:!1},{id:'fantasy-cultivation',name:'玄幻修仙',icon:'fa-solid fa-yin-yang',description:'通过灵气、法术或法宝实现体型变化，不受物理定律约束',mechanism:'体型变化通过修仙手段实现：\n- 服用丹药（巨人丸、缩小丹等）\n- 修炼特殊功法（天地同寿诀、芥子纳须弥等）\n- 使用法宝（如缩地成寸镜、万丈金身符）\n- 先天神通（妖族/神族特有能力）',bodyCharacteristics:'灵气护体下的身体特征：\n- 身体强度与修为相关，而非单纯体型\n- 可以通过灵气维持正常代谢\n- 神识/灵觉可以弥补感官的不足\n- 可能有特殊体质（如天生神力、不坏金身）',limitations:['需要消耗灵气/法力维持变化','可能有时间限制或冷却时间','受修为境界限制变化程度','特定材料的法宝/丹药才能触发'],specialRules:['高修为者可以保护小人不受物理伤害','可以通过神识交流，不受声音限制','灵气护盾可以防止被踩死','储物空间可以安全存放小人'],writingTips:['描写灵气流动的感觉','注意修为差距带来的压制感','可以加入灵宠/契约的设定','体型变化可以结合阵法、秘境等场景'],builtin:!0,allowPartialScaling:!0,typicalPartOverrides:{乳房高度:1.5,乳房宽度:1.5,臀部宽度:1.3}},{id:'sci-fi-tech',name:'科幻科技',icon:'fa-solid fa-microchip',description:'通过纳米技术、基因改造或缩放射线等科技手段实现',mechanism:'科技手段实现体型变化：\n- 皮姆粒子/缩放射线直接改变原子间距\n- 纳米机器人重构身体结构\n- 基因改造激活特殊生长因子\n- 虚拟现实/意识上传改变感知尺度',bodyCharacteristics:'科技增强下的身体特征：\n- 纳米机器维持身体机能稳定\n- 植入芯片可以通讯和定位\n- 外骨骼或力场可以增强防护\n- 可能有能量护盾保护',limitations:['需要能源供给（电池、反应堆等）','设备故障可能导致变化失控','可能有副作用需要定期检查','EMP或特定频率可能干扰'],specialRules:['纳米机器人可以提供即时翻译和放大通讯','力场护盾可以保护小人','可以通过芯片感知小人的生命体征','急救纳米可以修复受伤的小人'],writingTips:['加入科技感的描写（全息投影、数据流等）','可以有系统界面、数值显示','考虑科技伦理和社会影响','可能有企业、政府等组织介入'],builtin:!0,allowPartialScaling:!0},{id:'magical-girl',name:'魔法少女',icon:'fa-solid fa-wand-magic-sparkles',description:'通过变身魔法实现，通常有华丽的变身过程和时间限制',mechanism:'魔法变身机制：\n- 使用魔法道具（变身器、魔杖等）触发变身\n- 念诵咒语或进行特定动作\n- 强烈情感触发觉醒\n- 与魔法生物契约获得力量',bodyCharacteristics:'魔法变身后的身体特征：\n- 获得魔法强化的身体\n- 通常会有服装变化（魔法少女服装）\n- 可能有翅膀、光环等装饰\n- 身体曲线可能更加突出',limitations:['变身有时间限制','魔力耗尽会强制解除变身','变身需要特定条件或道具','可能被特定手段封印能力'],specialRules:['魔法可以创造安全空间保护小人','可以用魔法与小人心灵感应','治愈魔法可以恢复受伤的小人','可以将小人变成可爱的配饰携带'],writingTips:['加入华丽的变身场景描写','可以有可爱的魔法宠物角色','注重情感和羁绊的描写','可以加入敌对势力或怪物'],builtin:!0,allowPartialScaling:!0,typicalPartOverrides:{乳房高度:1.3,乳房宽度:1.3,臀部宽度:1.2,腰部宽度:.9}},{id:'monster-girl',name:'怪物娘',icon:'fa-solid fa-dragon',description:'作为特殊种族天生拥有巨大体型，是种族特性而非后天变化',mechanism:'种族特性说明：\n- 天生为巨大种族（巨人族、龙娘、泰坦等）\n- 或天生为微小种族（妖精、小人国居民等）\n- 体型是稳定的种族特征\n- 可能可以通过特殊能力暂时改变',bodyCharacteristics:'种族身体特征：\n- 身体结构适应了该体型（骨骼更强壮等）\n- 可能有种族特有器官（翅膀、尾巴、角等）\n- 新陈代谢与体型匹配\n- 寿命可能与人类不同',limitations:['体型相对固定，难以大幅改变','可能有种族弱点','繁殖可能有种族限制','社会地位可能受种族影响'],specialRules:['对小型生物有天生的保护本能','可能有种族间的契约或主从关系','某些种族有吞食或收养小人的习俗','跨种族恋爱可能有社会阻力'],writingTips:['注重种族文化和习俗的描写','可以加入种族间的矛盾或联盟','描写种族特有的身体部位','考虑不同种族的生活方式差异'],builtin:!0,allowPartialScaling:!1},{id:'supernatural',name:'超自然',icon:'fa-solid fa-ghost',description:'神力、诅咒、许愿等超自然力量导致的体型变化',mechanism:'超自然变化来源：\n- 神灵赐福或诅咒\n- 许愿（灯神、流星、神龙等）\n- 神器/圣物的力量\n- 恶魔契约\n- 精神力/念力觉醒',bodyCharacteristics:'超自然力量下的身体特征：\n- 身体可能违反物理定律（如飘浮、穿透等）\n- 可能有神圣/邪恶的气息\n- 外表可能有特殊标记（如发光、阴影等）\n- 可能有不老不死等特性',limitations:['可能有诅咒代价（如每次变化减少寿命）','可能需要特定条件维持（如月圆之夜）','可能被特定力量克制（如圣水、符咒）','契约可能有隐藏条款'],specialRules:['神力可以完全保护契约者','可能有命运牵绊等设定','可以通过仪式赋予小人保护','可能有预言或使命需要完成'],writingTips:['可以加入神秘主义元素','描写超自然力量的视觉效果','可以有宗教或神话背景','注意塑造超自然存在的威严感或恐怖感'],builtin:!0,allowPartialScaling:!0},{id:'dream-fantasy',name:'梦境幻想',icon:'fa-solid fa-cloud-moon',description:'在梦境、幻想空间或精神世界中的体型变化，不受现实约束',mechanism:'梦境/幻想世界规则：\n- 进入他人或共享梦境空间\n- 精神世界具象化\n- 虚拟现实全沉浸体验\n- 想象力直接塑造现实',bodyCharacteristics:'梦境中的身体特征：\n- 身体可以随意变形\n- 不会真正受伤（但可能有心理影响）\n- 可以拥有任何想象中的能力\n- 外表可以随心情变化',limitations:['醒来后一切重置','梦境可能不稳定','可能受到梦魇/他人干扰','过度沉浸可能影响现实感知'],specialRules:['在梦中不会真正死亡','可以创造任何想要的场景','情感会直接影响梦境环境','梦境中的时间流速可能不同'],writingTips:['可以有超现实的场景描写','加入象征性和隐喻元素','描写梦境特有的模糊感和跳跃感','可以探索潜意识和内心欲望'],builtin:!0,allowPartialScaling:!0},{id:'fetish-pure',name:'纯粹幻想',icon:'fa-solid fa-heart',description:'不考虑设定合理性，专注于场景和感官体验的纯粹描写',mechanism:'无需解释的幻想世界：\n- 体型变化自然发生，无需理由\n- 不需要考虑物理合理性\n- 专注于场景和感受\n- 一切为了满足幻想',bodyCharacteristics:'理想化的身体特征：\n- 完美的身材比例\n- 不会有任何不适感（除非剧情需要）\n- 身体柔韧性和耐久性超常\n- 感官被大幅强化',limitations:['无'],specialRules:['小人永远不会真正受伤（除非剧情需要）','可以进行任何想象中的互动','感官体验被大幅强化','一切以满足幻想为优先'],writingTips:['专注于感官细节的描写','不需要解释设定，直接进入场景','充分描写身体接触的感受','可以加入大量的感官形容词'],builtin:!0,allowPartialScaling:!0,typicalPartOverrides:{乳房高度:1.5,乳房宽度:1.5,臀部宽度:1.4,足长:1.1}}],K='giantessCalc_worldviews',ee='giantessCalc_currentWorldview',ne=n('giantess-calculator-worldviews',()=>{const e=(0,l.ref)((()=>{const e=getVariables({type:'global'}),n=e?.[K];if(n&&Array.isArray(n)){const e=J.filter(e=>e.builtin).map(e=>e.id),a=n.filter(n=>!e.includes(n.id)),t=n.filter(n=>e.includes(n.id));return[...J.filter(e=>e.builtin).map(e=>{const n=t.find(n=>n.id===e.id);return n?{...e,allowPartialScaling:n.allowPartialScaling,typicalPartOverrides:n.typicalPartOverrides}:e}),...a]}return[...J]})()),n=(0,l.ref)((()=>{const e=getVariables({type:'global'}),n=e?.[ee];return n||'realistic-physics'})()),a=(0,l.computed)(()=>e.value.find(e=>e.id===n.value)||e.value[0]||J[0]);(0,l.watchEffect)(()=>{insertOrAssignVariables({[K]:t(e.value),[ee]:n.value},{type:'global'})});return{worldviews:e,currentWorldviewId:n,currentWorldview:a,setCurrentWorldview:a=>{e.value.some(e=>e.id===a)&&(n.value=a)},addWorldview:n=>{e.value.push({...n,id:`custom-${Date.now()}`,builtin:!1})},updateWorldview:(n,a)=>{const t=e.value.findIndex(e=>e.id===n);-1!==t&&(e.value[t]={...e.value[t],...a})},removeWorldview:a=>{const t=e.value.find(e=>e.id===a);t&&!t.builtin&&(e.value=e.value.filter(e=>e.id!==a),n.value===a&&(n.value='realistic-physics'))},resetToDefaults:()=>{e.value=[...J],n.value='realistic-physics'},getWorldview:n=>e.value.find(e=>e.id===n)}});let ae=null;function te(e,n=1){return ae&&(uninjectPrompts([ae]),ae=null),ae=`giantess-data-${Date.now()}`,injectPrompts([{id:ae,role:'system',position:'in_chat',depth:n,content:e,should_scan:!1}]),ae}function ie(e,n){const{characters:a,interactionList:t,allDamages:i,settings:c}=n;switch(e.type){case'header':case'footer':return e.content;case'character':return 0===a.length?null:a.map(n=>L(e.content,n.context)).join('\n\n');case'interaction':if(0===t.length||!c.injectInteractionLimits)return null;const n=function(e){const n=[];for(const a of e)if(0!==a.impossible.length){n.push(`### ${a.大者} ↔ ${a.小者}`),n.push('');for(const e of a.impossible)n.push(`- **${e.action}**：${e.reason}`),e.alternative&&n.push(`  - 替代方案：${e.alternative}`);n.push('')}return n.join('\n')}(t);return L(e.content,{互动限制列表:n});case'rules':if(0===a.length||!c.showVariableUpdateRules)return null;const o=a[0]?.context||{角色名:'角色名'};return L(e.content,o);case'worldview':if(!c.injectWorldviewPrompt||0===a.length)return null;const s=a[0]?.context||{};return L(e.content,s);case'damage':if(!c.enableDamageCalculation||!c.injectDamagePrompt||0===i.length)return null;const r=function(e,n={}){const{showPerCharacter:a=!0,showSummary:t=!0,compact:i=!1}=n,c=[];if(0===e.length)return'';if(a)for(const{name:n,damageData:a}of e)i?(c.push(`## ${n}`),c.push(P(a))):c.push(O(n,a)),c.push('');if(t&&e.length>1){let n=0,a=0,t=0,i=0,o='';const s=new Set;for(const{damageData:c}of e){n+=c.单步损害.小人伤亡.最小估计,a+=c.单步损害.小人伤亡.最大估计,t+=c.单步损害.建筑损毁.最小估计,i+=c.单步损害.建筑损毁.最大估计,(!o||c.破坏力等级>o)&&(o=c.破坏力等级);for(const e of c.特殊效应)s.add(e)}if(c.push('---'),c.push(''),c.push('## 总计损害（所有巨大娘）'),c.push(''),c.push(`- 参与角色数：${e.length}`),c.push(`- 单步总伤亡：${Math.round(n)}-${Math.round(a)}人`),c.push(`- 单步总建筑损毁：${Math.round(t)}-${Math.round(i)}栋`),c.push(`- 最高破坏力等级：${o}`),s.size>0){c.push(''),c.push('**综合物理效应**：');for(const e of s)c.push(`- ${e}`)}}return c.join('\n')}(i,{showPerCharacter:c.showDamagePerCharacter,showSummary:c.showDamageSummary,compact:c.compactPromptFormat});return r?L(e.content,{损害数据:r}):null;default:return null}}function ce(e,n,a,t,i='',c=''){const o=`stat_data.${n}.${a}._身高历史`;let s=_.get(e,o)||[];const r=s[s.length-1],l=r?r.身高:null;if(l===t)return;const d={身高:t,身高_格式化:B(t,t>1e10),时间戳:Date.now(),时间点:c||(new Date).toLocaleString(),原因:i,变化:l?t>l?'增大':'缩小':void 0,变化倍率:l?Math.round(t/l*100)/100:void 0};s.push(d);const g=p().settings.maxHistoryRecords;s.length>g&&(s=s.slice(-g)),_.set(e,o,s)}const oe=new class{extensions=new Map;enabledSet=new Set;initialized=!1;register(e){if(this.extensions.has(e.id))console.warn(`[ExtensionManager] Extension ${e.id} already registered`);else{this.extensions.set(e.id,e),console.log(`[ExtensionManager] Registered extension: ${e.id}`);try{e.onInit?.()}catch(n){console.error(`[ExtensionManager] Failed to init extension ${e.id}:`,n)}}}get(e){return this.extensions.get(e)}getAll(){return Array.from(this.extensions.values())}getEnabled(){return this.getAll().filter(e=>this.enabledSet.has(e.id))}enable(e){const n=this.extensions.get(e);if(n){if(n.dependencies)for(const a of n.dependencies)if(!this.isEnabled(a))return void console.warn(`[ExtensionManager] Cannot enable ${e}: dependency ${a} not enabled`);if(!this.enabledSet.has(e)){this.enabledSet.add(e),console.log(`[ExtensionManager] Enabled extension: ${e}`);try{n.onEnable?.()}catch(n){console.error(`[ExtensionManager] Failed to enable extension ${e}:`,n),this.enabledSet.delete(e)}}}else console.warn(`[ExtensionManager] Extension ${e} not found`)}disable(e){const n=this.extensions.get(e);if(n){for(const[n,a]of this.extensions)if(a.dependencies?.includes(e)&&this.isEnabled(n))return void console.warn(`[ExtensionManager] Cannot disable ${e}: ${n} depends on it`);if(this.enabledSet.has(e)){this.enabledSet.delete(e),console.log(`[ExtensionManager] Disabled extension: ${e}`);try{n.onDisable?.()}catch(n){console.error(`[ExtensionManager] Failed to disable extension ${e}:`,n)}}}}isEnabled(e){return this.enabledSet.has(e)}toggle(e){return this.isEnabled(e)?(this.disable(e),!1):(this.enable(e),this.isEnabled(e))}triggerCharacterUpdate(e,n){const a={};for(const t of this.getEnabled())if(t.onCharacterUpdate)try{const i=t.onCharacterUpdate(e,n);i&&'object'==typeof i&&Object.assign(a,i)}catch(e){console.error(`[ExtensionManager] Error in ${t.id}.onCharacterUpdate:`,e)}return a}triggerBeforePromptInject(e){let n=e;for(const e of this.getEnabled())if(e.onBeforePromptInject)try{n=e.onBeforePromptInject(n)}catch(n){console.error(`[ExtensionManager] Error in ${e.id}.onBeforePromptInject:`,n)}return n}triggerAfterPromptInject(e){for(const n of this.getEnabled())if(n.onAfterPromptInject)try{n.onAfterPromptInject(e)}catch(e){console.error(`[ExtensionManager] Error in ${n.id}.onAfterPromptInject:`,e)}}collectPromptTemplates(){const e=[];for(const n of this.getEnabled())if(n.getPromptTemplates)try{const a=n.getPromptTemplates();e.push(...a)}catch(e){console.error(`[ExtensionManager] Error in ${n.id}.getPromptTemplates:`,e)}return e}collectSettingsComponents(){const e=new Map;for(const n of this.getEnabled())if(n.getSettingsComponent)try{const a=n.getSettingsComponent();e.set(n.id,a)}catch(e){console.error(`[ExtensionManager] Error in ${n.id}.getSettingsComponent:`,e)}return e}collectCharacterCardExtras(){const e=new Map;for(const n of this.getEnabled())if(n.getCharacterCardExtra)try{const a=n.getCharacterCardExtra();e.set(n.id,a)}catch(e){console.error(`[ExtensionManager] Error in ${n.id}.getCharacterCardExtra:`,e)}return e}collectDebugPanelExtras(){const e=new Map;for(const n of this.getEnabled())if(n.getDebugPanelExtra)try{const a=n.getDebugPanelExtra();e.set(n.id,a)}catch(e){console.error(`[ExtensionManager] Error in ${n.id}.getDebugPanelExtra:`,e)}return e}getEnabledIds(){return Array.from(this.enabledSet)}restoreEnabledIds(e){for(const n of e)this.extensions.has(n)&&this.enable(n)}initDefaults(){if(!this.initialized){this.initialized=!0;for(const e of this.extensions.values())e.defaultEnabled&&this.enable(e.id)}}getExtensionInfo(e){const n=this.extensions.get(e);if(!n)return null;let a=!0;for(const[n,t]of this.extensions)if(t.dependencies?.includes(e)&&this.isEnabled(n)){a=!1;break}return{extension:n,enabled:this.isEnabled(e),canDisable:a}}getAllExtensionInfo(){return this.getAll().map(e=>this.getExtensionInfo(e.id)).filter(Boolean)}},se={id:'damage-calculation',name:'损害计算',description:'计算巨大娘行动可能造成的破坏（伤亡、建筑损毁等）',icon:'fa-solid fa-explosion',defaultEnabled:!1,onInit(){console.log('[DamageExtension] 初始化')},onEnable(){console.log('[DamageExtension] 损害计算已启用')},onDisable(){console.log('[DamageExtension] 损害计算已禁用')},onCharacterUpdate(e,n){if(n.倍率<1)return;const a=p();let t=a.settings.damageScenario;try{const e=getVariables({type:'message',message_id:'latest'}),n=a.settings.variablePrefix,i=_.get(e,`stat_data.${n}._场景`);i?.当前场景&&(t=i.当前场景)}catch{}try{const n=Y(e.currentHeight,e.originalHeight,t);return console.log(`[DamageExtension] 已计算 ${e.name} 的损害数据:`,{破坏力等级:n.破坏力等级,场景:t}),{_损害数据:n}}catch(e){return void console.error('[DamageExtension] 计算损害数据失败:',e)}},getPromptTemplates:()=>[{id:'damage-calculation',name:'损害计算',description:'每个角色行动可能造成的破坏数据',enabled:!0,order:25,type:'damage',builtin:!0,requiresFeature:'damageCalculation',content:'---\n\n# 破坏力数据\n\n{{损害数据}}'},{id:'damage-rules',name:'损害描写指南',description:'指导 AI 如何描写破坏场景',enabled:!1,order:90,type:'footer',builtin:!0,requiresFeature:'damageCalculation',content:'## 破坏描写指南\n\n在描写巨大娘造成的破坏时，请注意：\n\n1. **规模感**：根据破坏力等级，准确描写破坏范围\n2. **细节描写**：\n   - 建筑级：描写建筑如何倒塌、碎片如何飞散\n   - 城区级：描写整片区域如何被夷平\n   - 城市级及以上：描写宏观视角的毁灭景象\n3. **特殊效应**：根据身高等级，描写相应的物理效应（地震、海啸等）\n4. **伤亡描写**：根据场景和密度，合理描写人员伤亡情况\n5. **情感基调**：根据世界观设定，调整描写的情感基调'}]};function re(){oe.register(se),console.log('[Extensions] 已注册所有内置扩展');try{p().settings.enableDamageCalculation&&oe.enable('damage-calculation'),oe.initDefaults(),console.log('[Extensions] 扩展系统初始化完成')}catch(e){console.error('[Extensions] 初始化失败:',e)}}function le(e,n){const a=p(),t=ue();if(a.debugLog('📥 收到 MVU 变量更新事件'),a.debugLog('变量快照:',{stat_data:_.get(e,'stat_data'),hasPrefix:!!_.get(e,`stat_data.${a.settings.variablePrefix}`)}),!a.settings.enabled)return void a.debugLog('⏸️ 脚本已禁用，跳过处理');const i=a.settings.variablePrefix,c=_.get(e,`stat_data.${i}`);if(!c)return void a.debugLog(`⚠️ 未找到数据路径: stat_data.${i}`);a.debugLog(`✅ 找到巨大娘数据，角色数: ${Object.keys(c).filter(e=>!e.startsWith('_')).length}`);let o=!1;const s=[];for(const[n,r]of Object.entries(c)){if(n.startsWith('_'))continue;const c=de(e,i,n,r,a,t);c.updated&&(o=!0),c.characterInfo&&s.push(c.characterInfo)}if(s.length>=2&&a.settings.injectInteractionLimits){const n=function(e){const n={};for(let a=0;a<e.length;a++)for(let t=a+1;t<e.length;t++){const i=G(e[a],e[t]);n[`${i.大者}_${i.小者}`]=i}return n}(s);_.set(e,`stat_data.${i}._互动限制`,n),a.debugLog(`🤝 已计算 ${s.length} 个角色的互动限制`)}if(o&&a.settings.autoInject){!function(e){const n=p(),a=X(),t=ne(),i=a.enabledTemplates;if(0===i.length)return!1;const c=[],o=t.currentWorldview,s=[],r=[];for(const[a,t]of Object.entries(e)){if(a.startsWith('_'))continue;const e=t._计算数据,i=t._损害数据,c=t.原身高||t.原始身高||1.65;if(e){const t=H(a,e,c,{damageData:i,worldview:o,enableDamageCalculation:n.settings.enableDamageCalculation,compactPromptFormat:n.settings.compactPromptFormat});s.push({name:a,context:t,originalHeight:c,damageData:i}),i&&r.push({name:a,damageData:i})}}const l=e._互动限制,d=[];if(l)for(const e of Object.values(l))e.impossible&&e.impossible.length>0&&d.push({大者:e.大者,小者:e.小者,impossible:e.impossible});for(const e of i){const a=ie(e,{characters:s,interactionList:d,allDamages:r,currentWorldview:o,settings:n.settings});a&&c.push(a)}if(0===c.length)return!1;const g=n.settings.compactPromptFormat?'\n':'\n\n';te(c.join(g),n.settings.injectDepth),n.log('已注入提示词')}(_.get(e,`stat_data.${i}`)),a.debugLog('💉 已注入提示词')}a.debugLog('✨ 变量更新处理完成',{更新数:o?'有更新':'无更新',角色总数:s.length})}function de(e,n,a,t,i,c){const o=t.当前身高||t.身高,s=t.原身高||t.原始身高||1.65,r=t._计算数据,l=t.变化原因||'',d=t.变化时间||'',g=t.自定义部位||{};if(!o||!function(e,n){const a=e.当前身高||e.身高;if(!a)return!1;if(!n)return!0;if(n.当前身高!==a)return!0;const t=e.自定义部位||{},i=n.自定义部位||{};return JSON.stringify(t)!==JSON.stringify(i)}(t,r))return o?{updated:!1,characterInfo:{name:a,height:o}}:{updated:!1,characterInfo:null};i.debugLog(`🔄 检测到 ${a} 数据变化:`,{新身高:o,原身高:s,旧计算数据:r?'有':'无',变化原因:l||'未指定',变化时间:d||'未指定',自定义部位:Object.keys(g).length>0?g:'无'}),ce(e,n,a,o,l,d),i.debugLog('📝 已记录身高历史');const A=o/s>=1?V(o,s,g):N(o,s);_.set(e,`stat_data.${n}.${a}._计算数据`,A),i.debugLog(`📊 已计算 ${a} 的数据:`,{级别:A.级别,倍率:A.倍率,当前身高_格式化:A.当前身高_格式化});const p={name:a,currentHeight:o,originalHeight:s,changeReason:l,changeTime:d,calcData:A,history:[]},m=oe.triggerCharacterUpdate(p,A);if(Object.keys(m).length>0)for(const[t,c]of Object.entries(m))_.set(e,`stat_data.${n}.${a}.${t}`,c),i.debugLog(`🔌 扩展数据已写入: ${t}`);const C=_.get(e,`stat_data.${n}.${a}._损害数据`);return c.setCharacter(a,{...p,damageData:C}),i.debugLog('👤 已更新角色 Store'),{updated:!0,characterInfo:{name:a,height:o}}}function ge(e,n,a,t){const i=n._计算数据,c=n._损害数据,o=n._实际损害,s=n._身高历史,r=n.当前身高||n.身高,l=n.原身高||n.原始身高||1.65,d=r?r/l:void 0;return{name:e,当前身高:r,当前身高_格式化:i?.当前身高_格式化,原身高:l,倍率:i?.倍率,级别:i?.级别,类型:void 0===d?'未知':d>=1?'巨大娘':'小人',有计算数据:!!i,有损害数据:!!c,有实际损害:!!o,有身高历史:!!s&&s.length>0,历史记录数:s?.length,自定义部位:n.自定义部位,预估损害:c?{破坏力等级:c.破坏力等级,单步伤亡:c.单步损害.小人伤亡.格式化,场景:t?.当前场景||a}:void 0,实际损害:o?{总伤亡人数:o.总伤亡人数,总伤亡人数_格式化:o.总伤亡人数?(g=o.总伤亡人数,(g>=1e8?`${(g/1e8).toFixed(1)}亿`:g>=1e4?`${(g/1e4).toFixed(1)}万`:g>=1e3?`${(g/1e3).toFixed(1)}千`:Math.round(g).toString())+'人'):void 0,总建筑损毁:o.总建筑损毁,最近行动:o.最近行动?.描述,重大事件数:o.重大事件?.length}:void 0};var g}function Ae(){const e=p(),n=ne(),a=e.settings.variablePrefix;try{const t=getVariables({type:'message',message_id:'latest'}),i=getVariables({type:'script',script_id:getScriptId()}),c=_.get(t,`stat_data.${a}`),o=_.get(t,`stat_data.${a}._场景`),s=_.get(t,`stat_data.${a}._互动限制`),r=[];if(c)for(const[n,a]of Object.entries(c))n.startsWith('_')||r.push(ge(n,a,e.settings.damageScenario,o));const l=o?.当前场景||e.settings.damageScenario,d=o?.当前场景?'MVU变量':'默认设置';return{mvuAvailable:'undefined'!=typeof Mvu,mvuVersion:'undefined'!=typeof Mvu?Mvu.version??null:null,prefix:a,settings:{enabled:e.settings.enabled,autoInject:e.settings.autoInject,enableDamageCalculation:e.settings.enableDamageCalculation,damageScenario:e.settings.damageScenario,injectWorldviewPrompt:e.settings.injectWorldviewPrompt},scenario:{current:l,source:d,reason:o?.场景原因},worldview:{id:n.currentWorldviewId,name:n.currentWorldview.name},messageVariables:{hasStatData:!!_.get(t,'stat_data'),hasGiantessData:!!c,hasScenarioData:!!o,hasInteractionData:!!s,giantessCharacters:r.map(e=>e.name),characterDetails:r,rawData:c},scriptVariables:i,timestamp:(new Date).toISOString()}}catch(t){return{error:String(t),mvuAvailable:'undefined'!=typeof Mvu,mvuVersion:null,prefix:a,settings:{enabled:e.settings.enabled,autoInject:e.settings.autoInject,enableDamageCalculation:e.settings.enableDamageCalculation,damageScenario:e.settings.damageScenario,injectWorldviewPrompt:e.settings.injectWorldviewPrompt},scenario:{current:e.settings.damageScenario,source:'默认设置'},worldview:{id:n.currentWorldviewId,name:n.currentWorldview.name},messageVariables:{hasStatData:!1,hasGiantessData:!1,hasScenarioData:!1,hasInteractionData:!1,giantessCharacters:[],characterDetails:[],rawData:null},scriptVariables:null,timestamp:(new Date).toISOString()}}}function pe(e,n,a=1.65){const t=p(),i=ue(),c=t.settings.variablePrefix,o=n/a,s=o<1;t.debugLog(`🧪 注入测试数据: ${e}`,{height:n,originalHeight:a,scale:o.toFixed(4),type:s?'小人':'巨大娘'});try{const o=getVariables({type:'message',message_id:'latest'});_.set(o,`stat_data.${c}.${e}.当前身高`,n),_.set(o,`stat_data.${c}.${e}.原身高`,a),_.set(o,`stat_data.${c}.${e}.变化原因`,`调试测试(${s?'小人':'巨大娘'})`),_.set(o,`stat_data.${c}.${e}.变化时间`,(new Date).toLocaleString());const r=s?N(n,a):V(n,a);if(_.set(o,`stat_data.${c}.${e}._计算数据`,r),t.debugLog(`📊 已计算 ${e} 的数据:`,{级别:r.级别,倍率:r.倍率,当前身高_格式化:r.当前身高_格式化}),t.settings.enableDamageCalculation&&!s){const i=_.get(o,`stat_data.${c}._场景`),s=i?.当前场景||t.settings.damageScenario,r=Y(n,a,s);_.set(o,`stat_data.${c}.${e}._损害数据`,r),t.debugLog(`💥 已计算 ${e} 的损害数据:`,{破坏力等级:r.破坏力等级,单步伤亡:r.单步损害.小人伤亡.格式化,场景:s})}return ce(o,c,e,n,`调试测试(${s?'小人':'巨大娘'})`,(new Date).toLocaleString()),t.debugLog('📝 已记录身高历史'),insertOrAssignVariables(o,{type:'message',message_id:'latest'}),i.setCharacter(e,{name:e,currentHeight:n,originalHeight:a,changeReason:`调试测试(${s?'小人':'巨大娘'})`,changeTime:(new Date).toLocaleString(),calcData:r,damageData:_.get(o,`stat_data.${c}.${e}._损害数据`),history:[]}),t.debugLog('👤 已更新角色 Store'),t.debugLog('✅ 测试数据已注入并计算完成'),{success:!0,data:_.get(o,`stat_data.${c}.${e}`),isTiny:s}}catch(e){return t.debugError('❌ 注入测试数据失败:',e),{success:!1,error:String(e)}}}function me(e){const n=p(),a=ue(),t=n.settings.variablePrefix;n.debugLog('🗑️ 清除测试数据'+(e?`: ${e}`:' (全部)'));try{const i={type:'message',message_id:'latest'};if(e){deleteVariable(`stat_data.${t}.${e}`,i).delete_occurred?n.debugLog(`✅ 已清除角色: ${e}`):n.debugLog(`⚠️ 角色不存在: ${e}`),a.removeCharacter(e)}else{deleteVariable(`stat_data.${t}`,i).delete_occurred?n.debugLog('✅ 已清除所有巨大娘数据'):n.debugLog('⚠️ 无数据需要清除'),a.clear()}return{success:!0}}catch(e){return n.debugError('❌ 清除测试数据失败:',e),{success:!1,error:String(e)}}}const Ce=n('giantess-characters-base',()=>{const e=(0,l.ref)(new Map);return{characters:e,setCharacter:(n,a)=>{e.value.set(n,a)},getCharacter:n=>e.value.get(n),removeCharacter:n=>{e.value.delete(n)},clear:()=>{e.value.clear()},getCharacterNames:()=>Array.from(e.value.keys()),getAllCharacters:()=>Array.from(e.value.values()),updateCharacter:(n,a)=>{const t=e.value.get(n);t&&e.value.set(n,{...t,...a})},addHistory:(n,a,t=20)=>{const i=e.value.get(n);if(i){const c=[...i.history||[],a];c.length>t&&c.splice(0,c.length-t),e.value.set(n,{...i,history:c})}},getAllCharacterInfo:()=>Array.from(e.value.values()).map(e=>({name:e.name,height:e.currentHeight,calcData:e.calcData,damageData:e.damageData})),getDamageSummary:(n='大城市')=>{let a=0,t=0,i=0,c=0,o=0,s=0;for(const[,n]of e.value){n.damageData&&(a+=n.damageData.单步损害.小人伤亡.最小估计,t+=n.damageData.单步损害.小人伤亡.最大估计,i+=n.damageData.单步损害.建筑损毁.最小估计,c+=n.damageData.单步损害.建筑损毁.最大估计);const e=n.currentHeight/n.originalHeight;e>1?o++:e<1&&s++}return{giantCount:o,tinyCount:s,totalCasualties:{min:a,max:t},totalBuildings:{min:i,max:c},scenario:n}}}}),ue=n('giantess-characters',()=>{const e=Ce(),n=p();return{characters:e.characters,setCharacter:e.setCharacter,getCharacter:e.getCharacter,removeCharacter:e.removeCharacter,clear:e.clear,getCharacterNames:e.getCharacterNames,getAllCharacters:e.getAllCharacters,updateCharacter:e.updateCharacter,addHistory:e.addHistory,getAllCharacterInfo:e.getAllCharacterInfo,getDamageSummary:e.getDamageSummary,addCharacter:(a,t,i,c,o,s,r)=>{const l=function(e,n,a={}){const t=e/n,i=R(t);if('normal'===i)return{type:i,scale:t,calcData:null,damageData:null};const c=U(e,n,a.customParts);let o=null;return a.enableDamage&&'giant'===i&&(o=Y(e,n,a.damageScenario||'大城市')),{type:i,scale:t,calcData:c,damageData:o}}(t,i,{customParts:s,enableDamage:n.settings.enableDamageCalculation,damageScenario:n.settings.damageScenario}),d=e.getCharacter(a),g=d?.history||[],A={height:t,heightFormatted:B(t,t>1e10),time:o||(new Date).toLocaleString(),reason:c||''};g.push(A);const p=n.settings.maxHistoryRecords;g.length>p&&g.splice(0,g.length-p);const m=r||d?.actualDamage;e.setCharacter(a,{name:a,currentHeight:t,originalHeight:i,changeReason:c,changeTime:o,calcData:l.calcData||void 0,damageData:l.damageData||void 0,actualDamage:m,history:g})},refresh:()=>{const e=function(e){const n=p(),a=ue();try{const t=getVariables({type:'message',message_id:'latest'}),i=_.get(t,`stat_data.${e}`);if(!i)return n.debugLog('未找到巨大娘数据（楼层变量）'),0;let c=0;for(const[e,t]of Object.entries(i)){if(e.startsWith('_'))continue;if('object'!=typeof t||null===t)continue;const i=t,o=i.当前身高||i.身高,s=i.原身高||i.原始身高||1.65;if(o&&o>0){const t=o/s,r=t>=1?V(o,s,i.自定义部位):N(o,s);let l;n.settings.enableDamageCalculation&&t>=1&&(l=Y(o,s,n.settings.damageScenario)),a.setCharacter(e,{name:e,currentHeight:o,originalHeight:s,changeReason:i.变化原因,changeTime:i.变化时间,calcData:r,damageData:l,actualDamage:i._实际损害,history:[]}),c++}}return n.debugLog(`已刷新 ${c} 个角色数据`),c}catch(e){return n.debugError('刷新角色数据失败:',e),0}}(n.settings.variablePrefix);e>0&&n.log('已刷新角色数据，共',e,'个角色')},recalculateDamage:a=>{const t=a||n.settings.damageScenario;for(const[n,a]of e.characters){const i=q(a.currentHeight,a.originalHeight,t);i&&e.updateCharacter(n,{damageData:i})}}}}),be=['checked'],ve=(0,l.defineComponent)({__name:'GcSwitch',props:{modelValue:{type:Boolean},size:{}},emits:['update:modelValue'],setup:e=>(n,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('input',{type:'checkbox',class:(0,l.normalizeClass)(['gc-switch',{sm:'sm'===e.size}]),checked:e.modelValue,onChange:a[0]||(a[0]=e=>n.$emit('update:modelValue',e.target.checked))},null,42,be))});o(601);var fe=o(946);const xe=(0,fe.A)(ve,[['__scopeId','data-v-03ff4c3e']]),he=['type','value','placeholder','readonly'],Be=['value','placeholder','readonly','rows'],Ee={key:2,class:'gc-input-suffix'};Boolean;o(907);const we=['disabled'],ye=(0,l.defineComponent)({__name:'GcButton',props:{variant:{},size:{},icon:{},active:{type:Boolean},disabled:{type:Boolean}},emits:['click'],setup:e=>(n,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('button',{class:(0,l.normalizeClass)(['gc-btn',[e.variant&&`gc-btn-${e.variant}`,e.size&&`gc-btn-${e.size}`,{active:e.active,disabled:e.disabled}]]),disabled:e.disabled,onClick:a[0]||(a[0]=e=>n.$emit('click',e))},[e.icon?((0,l.openBlock)(),(0,l.createElementBlock)('i',{key:0,class:(0,l.normalizeClass)(e.icon)},null,2)):(0,l.createCommentVNode)('v-if',!0),(0,l.renderSlot)(n.$slots,'default')],10,we))});o(566);const ke=(0,fe.A)(ye,[['__scopeId','data-v-7bc235a6']]),Ve={class:'gc-overlay-header'},Ne={class:'gc-header-actions-inner'},De={class:'gc-overlay-content'},Fe=(0,l.defineComponent)({__name:'GcOverlay',props:{visible:{type:Boolean},title:{},icon:{},panelClass:{}},emits:['close'],setup:e=>(n,a)=>e.visible?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:(0,l.normalizeClass)(['gc-overlay-panel',e.panelClass])},[(0,l.createElementVNode)('div',Ve,[(0,l.createElementVNode)('span',null,[e.icon?((0,l.openBlock)(),(0,l.createElementBlock)('i',{key:0,class:(0,l.normalizeClass)(e.icon)},null,2)):(0,l.createCommentVNode)('v-if',!0),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e.title),1)]),(0,l.createElementVNode)('div',Ne,[(0,l.renderSlot)(n.$slots,'header-actions'),(0,l.createElementVNode)('button',{class:'gc-close-btn',onClick:a[0]||(a[0]=e=>n.$emit('close'))},[...a[1]||(a[1]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-xmark'},null,-1)])])])]),(0,l.createElementVNode)('div',De,[(0,l.renderSlot)(n.$slots,'default')])],2)):(0,l.createCommentVNode)('v-if',!0)});o(844);const Se=(0,fe.A)(Fe,[['__scopeId','data-v-01d31954']]);o(690);const ze=(0,l.defineComponent)({__name:'GcBadge',props:{variant:{},size:{}},setup:e=>(n,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('span',{class:(0,l.normalizeClass)(['gc-badge',[e.variant,e.size]])},[(0,l.renderSlot)(n.$slots,'default')],2))});o(339);const $e=(0,fe.A)(ze,[['__scopeId','data-v-8712d0e8']]),_e={class:'gc-settings-list'},Te={class:'gc-setting-item'},je=['value'],Ie={class:'gc-setting-item'},We={class:'gc-input-spinner'},Me=['value'],Ye={class:'gc-setting-toggle'},Oe={class:'gc-setting-toggle'},Pe={class:'gc-setting-toggle'},Re={class:'gc-setting-toggle'},Ue={class:'gc-setting-toggle'},qe=(0,l.defineComponent)({__name:'SettingsPanel',props:{visible:{type:Boolean},settings:{}},emits:['close','update:setting'],setup(e,{emit:n}){const a=e,t=n,i=(e,n)=>{t('update:setting',e,n)},c=()=>{a.settings.injectDepth>0&&i('injectDepth',a.settings.injectDepth-1)},o=()=>{a.settings.injectDepth<10&&i('injectDepth',a.settings.injectDepth+1)};return(n,a)=>((0,l.openBlock)(),(0,l.createBlock)((0,l.unref)(Se),{visible:e.visible,title:'设置',icon:'fa-solid fa-gear',onClose:a[6]||(a[6]=e=>n.$emit('close'))},{default:(0,l.withCtx)(()=>[(0,l.createElementVNode)('div',_e,[(0,l.createElementVNode)('div',Te,[a[7]||(a[7]=(0,l.createElementVNode)('label',null,'变量前缀',-1)),(0,l.createElementVNode)('input',{value:e.settings.variablePrefix,onInput:a[0]||(a[0]=e=>i('variablePrefix',e.target.value)),type:'text',class:'gc-input sm',placeholder:'巨大娘'},null,40,je)]),(0,l.createElementVNode)('div',Ie,[a[8]||(a[8]=(0,l.createElementVNode)('label',null,'注入深度',-1)),(0,l.createElementVNode)('div',We,[(0,l.createElementVNode)('button',{onClick:c},'-'),(0,l.createElementVNode)('input',{value:e.settings.injectDepth,type:'number',readonly:''},null,8,Me),(0,l.createElementVNode)('button',{onClick:o},'+')])]),(0,l.createElementVNode)('div',Ye,[a[9]||(a[9]=(0,l.createElementVNode)('label',null,[(0,l.createElementVNode)('span',null,'自动注入提示词'),(0,l.createElementVNode)('small',null,'数据变化时自动更新 Prompt')],-1)),(0,l.createVNode)((0,l.unref)(xe),{'model-value':e.settings.autoInject,'onUpdate:modelValue':a[1]||(a[1]=e=>i('autoInject',e))},null,8,['model-value'])]),(0,l.createElementVNode)('div',Oe,[a[10]||(a[10]=(0,l.createElementVNode)('label',null,[(0,l.createElementVNode)('span',null,'注入互动限制'),(0,l.createElementVNode)('small',null,'检查物理上不可能的互动')],-1)),(0,l.createVNode)((0,l.unref)(xe),{'model-value':e.settings.injectInteractionLimits,'onUpdate:modelValue':a[2]||(a[2]=e=>i('injectInteractionLimits',e))},null,8,['model-value'])]),(0,l.createElementVNode)('div',Pe,[a[11]||(a[11]=(0,l.createElementVNode)('label',null,[(0,l.createElementVNode)('span',null,'调试模式'),(0,l.createElementVNode)('small',null,'在控制台输出详细日志')],-1)),(0,l.createVNode)((0,l.unref)(xe),{'model-value':e.settings.debug,'onUpdate:modelValue':a[3]||(a[3]=e=>i('debug',e))},null,8,['model-value'])]),(0,l.createElementVNode)('div',Re,[a[12]||(a[12]=(0,l.createElementVNode)('label',null,[(0,l.createElementVNode)('span',null,'显示变量更新规则'),(0,l.createElementVNode)('small',null,'指导 AI 如何更新身高变量')],-1)),(0,l.createVNode)((0,l.unref)(xe),{'model-value':e.settings.showVariableUpdateRules,'onUpdate:modelValue':a[4]||(a[4]=e=>i('showVariableUpdateRules',e))},null,8,['model-value'])]),(0,l.createElementVNode)('div',Ue,[a[13]||(a[13]=(0,l.createElementVNode)('label',null,[(0,l.createElementVNode)('span',null,'紧凑提示词格式'),(0,l.createElementVNode)('small',null,'减少提示词中的空行')],-1)),(0,l.createVNode)((0,l.unref)(xe),{'model-value':e.settings.compactPromptFormat,'onUpdate:modelValue':a[5]||(a[5]=e=>i('compactPromptFormat',e))},null,8,['model-value'])])])]),_:1},8,['visible']))}});o(490);const Ge=(0,fe.A)(qe,[['__scopeId','data-v-eb968c1a']]),Le={class:'gc-help-content'},He={class:'gc-help-section'},Qe={class:'gc-changelog'},Ze=(0,l.defineComponent)({__name:'HelpPanel',props:{visible:{type:Boolean},version:{},changelog:{}},emits:['close'],setup:e=>(n,a)=>((0,l.openBlock)(),(0,l.createBlock)((0,l.unref)(Se),{visible:e.visible,title:'帮助',icon:'fa-regular fa-circle-question',onClose:a[0]||(a[0]=e=>n.$emit('close'))},{default:(0,l.withCtx)(()=>[(0,l.createElementVNode)('div',Le,[a[2]||(a[2]=(0,l.createElementVNode)('div',{class:'gc-help-section'},[(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-rocket'}),(0,l.createTextVNode)(' 快速开始')]),(0,l.createElementVNode)('p',null,'在世界书或提示词中使用 MVU 命令：'),(0,l.createElementVNode)('div',{class:'gc-code-block'},[(0,l.createTextVNode)(' _.set(\'巨大娘.络络.当前身高\', 170)'),(0,l.createElementVNode)('br'),(0,l.createTextVNode)(' _.set(\'巨大娘.络络.原身高\', 1.65) ')])],-1)),(0,l.createElementVNode)('div',He,[a[1]||(a[1]=(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-code-branch'}),(0,l.createTextVNode)(' 版本信息')],-1)),(0,l.createElementVNode)('p',null,'当前版本: v'+(0,l.toDisplayString)(e.version),1),(0,l.createElementVNode)('div',Qe,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.changelog.slice(0,3),e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.version,class:'gc-ver-item'},[(0,l.createElementVNode)('strong',null,'v'+(0,l.toDisplayString)(e.version),1),(0,l.createTextVNode)(' - '+(0,l.toDisplayString)(e.date)+' ',1),(0,l.createElementVNode)('ul',null,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.changes,(e,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('li',{key:n},(0,l.toDisplayString)(e),1))),128))])]))),128))])]),a[3]||(a[3]=(0,l.createElementVNode)('div',{class:'gc-help-section'},[(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-book'}),(0,l.createTextVNode)(' 更多帮助')]),(0,l.createElementVNode)('p',null,'查看项目文档了解更多用法：'),(0,l.createElementVNode)('ul',{class:'gc-help-links'},[(0,l.createElementVNode)('li',null,'MVU 变量结构'),(0,l.createElementVNode)('li',null,'提示词模板系统'),(0,l.createElementVNode)('li',null,'世界观模板系统'),(0,l.createElementVNode)('li',null,'损害计算功能')])],-1))])]),_:1},8,['visible']))});o(766);const Xe=(0,fe.A)(Ze,[['__scopeId','data-v-2ca1928e']]),Je={class:'gc-worldview-content'},Ke={class:'gc-worldview-selector'},en={class:'gc-worldview-current'},nn={class:'gc-worldview-current-info'},an={class:'gc-worldview-name'},tn={class:'gc-worldview-desc'},cn={class:'gc-worldview-list'},on=['onClick'],sn={class:'gc-worldview-item-info'},rn={class:'gc-worldview-item-name'},ln={key:0,class:'fa-solid fa-check gc-worldview-check'},dn={key:0,class:'gc-worldview-details'},gn={class:'gc-worldview-section'},An={class:'gc-worldview-text'},pn={class:'gc-worldview-section'},mn={class:'gc-worldview-text'},Cn={key:0,class:'gc-worldview-section'},un={class:'gc-worldview-list-items'},bn={key:1,class:'gc-worldview-section'},vn={class:'gc-worldview-list-items'},fn={key:2,class:'gc-worldview-section'},xn={class:'gc-worldview-list-items'},hn={class:'gc-worldview-section gc-worldview-options'},Bn={class:'gc-setting-toggle'},En={class:'gc-setting-toggle'},wn={key:3,class:'gc-worldview-actions'},yn={class:'gc-worldview-editor'},kn={class:'gc-editor-header'},Vn={class:'gc-editor-title'},Nn={class:'gc-editor-form'},Dn={class:'gc-setting-item'},Fn={class:'gc-setting-item'},Sn={class:'gc-setting-item'},zn={class:'gc-setting-item'},$n={class:'gc-setting-item'},_n={class:'gc-editor-actions'},Tn=(0,l.defineComponent)({__name:'WorldviewPanel',props:{visible:{type:Boolean},worldviews:{},currentWorldviewId:{},currentWorldview:{},settings:{}},emits:['close','reset','select','create','update','delete','update:setting'],setup(e,{emit:n}){const a=e,t=n,i=(0,l.ref)(!1),c=(0,l.ref)(null),o=(0,l.ref)({name:'',icon:'fa-solid fa-star',description:'',mechanism:'',bodyCharacteristics:'',limitations:[],specialRules:[],writingTips:[]}),s=(0,l.computed)(()=>{const e=a.currentWorldview?.limitations;return e&&e.length>0&&'无'!==e[0]}),r=()=>{c.value=null,o.value={name:'',icon:'fa-solid fa-star',description:'',mechanism:'',bodyCharacteristics:'',limitations:[],specialRules:[],writingTips:[]},i.value=!0},d=()=>{a.currentWorldview&&(c.value=a.currentWorldview,o.value={name:a.currentWorldview.name,icon:a.currentWorldview.icon,description:a.currentWorldview.description,mechanism:a.currentWorldview.mechanism,bodyCharacteristics:a.currentWorldview.bodyCharacteristics,limitations:[...a.currentWorldview.limitations],specialRules:[...a.currentWorldview.specialRules],writingTips:[...a.currentWorldview.writingTips]},i.value=!0)},g=()=>{i.value=!1,c.value=null},A=()=>{if(!o.value.name.trim())return void toastr.warning('请输入世界观名称');const e={name:o.value.name.trim(),icon:o.value.icon.trim()||'fa-solid fa-star',description:o.value.description.trim(),mechanism:o.value.mechanism.trim(),bodyCharacteristics:o.value.bodyCharacteristics.trim(),limitations:o.value.limitations.filter(e=>e.trim()),specialRules:o.value.specialRules.filter(e=>e.trim()),writingTips:o.value.writingTips.filter(e=>e.trim())};c.value?t('update',c.value.id,e):t('create',e),i.value=!1,c.value=null},p=()=>{i.value&&g(),t('close')};return(n,a)=>((0,l.openBlock)(),(0,l.createBlock)((0,l.unref)(Se),{visible:e.visible,title:'世界观设定',icon:e.currentWorldview?.icon||'fa-solid fa-globe','panel-class':'gc-worldview-panel',onClose:p},{'header-actions':(0,l.withCtx)(()=>[(0,l.createElementVNode)('button',{class:'gc-btn-link',onClick:a[0]||(a[0]=e=>n.$emit('reset')),title:'重置为默认'},[...a[9]||(a[9]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-rotate-left'},null,-1)])])]),default:(0,l.withCtx)(()=>[(0,l.createElementVNode)('div',Je,[(0,l.createCommentVNode)(' 当前世界观选择 '),(0,l.createElementVNode)('div',Ke,[(0,l.createElementVNode)('div',en,[(0,l.createElementVNode)('div',nn,[(0,l.createElementVNode)('i',{class:(0,l.normalizeClass)([e.currentWorldview?.icon,'gc-worldview-icon'])},null,2),(0,l.createElementVNode)('div',null,[(0,l.createElementVNode)('div',an,(0,l.toDisplayString)(e.currentWorldview?.name),1),(0,l.createElementVNode)('div',tn,(0,l.toDisplayString)(e.currentWorldview?.description),1)])])]),(0,l.createCommentVNode)(' 世界观快速切换列表 '),(0,l.createElementVNode)('div',cn,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.worldviews,t=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t.id,class:(0,l.normalizeClass)(['gc-worldview-item',{active:t.id===e.currentWorldviewId,builtin:t.builtin}]),onClick:e=>n.$emit('select',t.id)},[(0,l.createElementVNode)('i',{class:(0,l.normalizeClass)([t.icon,'gc-worldview-item-icon'])},null,2),(0,l.createElementVNode)('div',sn,[(0,l.createElementVNode)('span',rn,(0,l.toDisplayString)(t.name),1),t.builtin?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createBlock)((0,l.unref)($e),{key:0,variant:'custom',size:'sm'},{default:(0,l.withCtx)(()=>[...a[10]||(a[10]=[(0,l.createTextVNode)('自定义',-1)])]),_:1}))]),t.id===e.currentWorldviewId?((0,l.openBlock)(),(0,l.createElementBlock)('i',ln)):(0,l.createCommentVNode)('v-if',!0)],10,on))),128))])]),(0,l.createCommentVNode)(' 当前世界观详情 '),i.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' 编辑世界观 '),(0,l.createElementVNode)('div',yn,[(0,l.createElementVNode)('div',kn,[(0,l.createElementVNode)('button',{class:'gc-btn-link',onClick:g},[...a[21]||(a[21]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-arrow-left'},null,-1),(0,l.createTextVNode)(' 返回 ',-1)])]),(0,l.createElementVNode)('span',Vn,(0,l.toDisplayString)(c.value?'编辑世界观':'新建世界观'),1)]),(0,l.createElementVNode)('div',Nn,[(0,l.createElementVNode)('div',Dn,[a[22]||(a[22]=(0,l.createElementVNode)('label',null,'名称 *',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[4]||(a[4]=e=>o.value.name=e),type:'text',class:'gc-input',placeholder:'世界观名称'},null,512),[[l.vModelText,o.value.name]])]),(0,l.createElementVNode)('div',Fn,[a[23]||(a[23]=(0,l.createElementVNode)('label',null,'图标 (Font Awesome class)',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[5]||(a[5]=e=>o.value.icon=e),type:'text',class:'gc-input',placeholder:'fa-solid fa-atom'},null,512),[[l.vModelText,o.value.icon]])]),(0,l.createElementVNode)('div',Sn,[a[24]||(a[24]=(0,l.createElementVNode)('label',null,'描述',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[6]||(a[6]=e=>o.value.description=e),type:'text',class:'gc-input',placeholder:'简短描述'},null,512),[[l.vModelText,o.value.description]])]),(0,l.createElementVNode)('div',zn,[a[25]||(a[25]=(0,l.createElementVNode)('label',null,'变化机制',-1)),(0,l.withDirectives)((0,l.createElementVNode)('textarea',{'onUpdate:modelValue':a[7]||(a[7]=e=>o.value.mechanism=e),class:'gc-textarea',rows:'4',placeholder:'描述体型变化的机制...'},null,512),[[l.vModelText,o.value.mechanism]])]),(0,l.createElementVNode)('div',$n,[a[26]||(a[26]=(0,l.createElementVNode)('label',null,'身体特性',-1)),(0,l.withDirectives)((0,l.createElementVNode)('textarea',{'onUpdate:modelValue':a[8]||(a[8]=e=>o.value.bodyCharacteristics=e),class:'gc-textarea',rows:'4',placeholder:'描述变化后的身体特征...'},null,512),[[l.vModelText,o.value.bodyCharacteristics]])]),(0,l.createElementVNode)('div',_n,[(0,l.createVNode)((0,l.unref)(ke),{onClick:g},{default:(0,l.withCtx)(()=>[...a[27]||(a[27]=[(0,l.createTextVNode)('取消',-1)])]),_:1}),(0,l.createVNode)((0,l.unref)(ke),{variant:'primary',onClick:A},{default:(0,l.withCtx)(()=>[...a[28]||(a[28]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-save'},null,-1),(0,l.createTextVNode)(' 保存 ',-1)])]),_:1})])])])],2112)):((0,l.openBlock)(),(0,l.createElementBlock)('div',dn,[(0,l.createElementVNode)('div',gn,[a[11]||(a[11]=(0,l.createElementVNode)('h4',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-gears'}),(0,l.createTextVNode)(' 变化机制')],-1)),(0,l.createElementVNode)('div',An,(0,l.toDisplayString)(e.currentWorldview?.mechanism),1)]),(0,l.createElementVNode)('div',pn,[a[12]||(a[12]=(0,l.createElementVNode)('h4',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-person'}),(0,l.createTextVNode)(' 身体特性')],-1)),(0,l.createElementVNode)('div',mn,(0,l.toDisplayString)(e.currentWorldview?.bodyCharacteristics),1)]),s.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Cn,[a[13]||(a[13]=(0,l.createElementVNode)('h4',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-triangle-exclamation'}),(0,l.createTextVNode)(' 限制与代价')],-1)),(0,l.createElementVNode)('ul',un,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.currentWorldview?.limitations,(e,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('li',{key:n},(0,l.toDisplayString)(e),1))),128))])])):(0,l.createCommentVNode)('v-if',!0),e.currentWorldview?.specialRules?.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',bn,[a[14]||(a[14]=(0,l.createElementVNode)('h4',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-star'}),(0,l.createTextVNode)(' 特殊规则')],-1)),(0,l.createElementVNode)('ul',vn,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.currentWorldview?.specialRules,(e,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('li',{key:n},(0,l.toDisplayString)(e),1))),128))])])):(0,l.createCommentVNode)('v-if',!0),e.currentWorldview?.writingTips?.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',fn,[a[15]||(a[15]=(0,l.createElementVNode)('h4',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-pen-fancy'}),(0,l.createTextVNode)(' 写作建议')],-1)),(0,l.createElementVNode)('ul',xn,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.currentWorldview?.writingTips,(e,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('li',{key:n},(0,l.toDisplayString)(e),1))),128))])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 世界观设置选项 '),(0,l.createElementVNode)('div',hn,[a[18]||(a[18]=(0,l.createElementVNode)('h4',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-sliders'}),(0,l.createTextVNode)(' 世界观选项')],-1)),(0,l.createElementVNode)('div',Bn,[a[16]||(a[16]=(0,l.createElementVNode)('label',null,[(0,l.createElementVNode)('span',null,'注入世界观提示词'),(0,l.createElementVNode)('small',null,'将世界观设定注入到 AI 提示词中')],-1)),(0,l.createVNode)((0,l.unref)(xe),{'model-value':e.settings.injectWorldviewPrompt,'onUpdate:modelValue':a[1]||(a[1]=e=>n.$emit('update:setting','injectWorldviewPrompt',e))},null,8,['model-value'])]),(0,l.createElementVNode)('div',En,[a[17]||(a[17]=(0,l.createElementVNode)('label',null,[(0,l.createElementVNode)('span',null,'允许身体部位独立变化'),(0,l.createElementVNode)('small',null,'特定部位可以有不同的缩放倍率')],-1)),(0,l.createVNode)((0,l.unref)(xe),{'model-value':e.settings.allowPartialScaling,'onUpdate:modelValue':a[2]||(a[2]=e=>n.$emit('update:setting','allowPartialScaling',e))},null,8,['model-value'])])]),e.currentWorldview?.builtin?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',wn,[(0,l.createVNode)((0,l.unref)(ke),{onClick:d},{default:(0,l.withCtx)(()=>[...a[19]||(a[19]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-pen'},null,-1),(0,l.createTextVNode)(' 编辑',-1)])]),_:1}),(0,l.createVNode)((0,l.unref)(ke),{variant:'danger',onClick:a[3]||(a[3]=a=>n.$emit('delete',e.currentWorldview?.id,e.currentWorldview?.name))},{default:(0,l.withCtx)(()=>[...a[20]||(a[20]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-trash'},null,-1),(0,l.createTextVNode)(' 删除 ',-1)])]),_:1})]))])),(0,l.createCommentVNode)(' 新建世界观按钮 '),i.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createBlock)((0,l.unref)(ke),{key:2,class:'gc-add-template-btn',onClick:r},{default:(0,l.withCtx)(()=>[...a[29]||(a[29]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-plus'},null,-1),(0,l.createTextVNode)(' 新建自定义世界观 ',-1)])]),_:1}))])]),_:1},8,['visible','icon']))}});o(134);const jn=(0,fe.A)(Tn,[['__scopeId','data-v-3554c17a']]),In={class:'gc-prompts-content'},Wn={key:0,class:'gc-prompts-list'},Mn={class:'gc-prompt-toggle'},Yn=['onClick'],On={class:'gc-prompt-name'},Pn={class:'gc-prompt-type'},Rn={class:'gc-prompt-desc'},Un={class:'gc-prompt-actions'},qn={class:'gc-prompt-order-btns'},Gn=['onClick'],Ln=['onClick'],Hn=['onClick'],Qn=['onClick'],Zn={class:'gc-prompt-editor'},Xn={class:'gc-editor-form'},Jn={class:'gc-setting-item'},Kn={class:'gc-setting-item'},ea={class:'gc-setting-item'},na={class:'gc-setting-item'},aa={class:'gc-setting-toggle'},ta={class:'gc-editor-actions'},ia={class:'gc-prompt-editor'},ca={class:'gc-editor-header'},oa={class:'gc-editor-title'},sa={class:'gc-editor-form'},ra={class:'gc-setting-item'},la=['disabled'],da={class:'gc-setting-item'},ga={class:'gc-setting-item'},Aa={class:'gc-editor-actions'},pa=(0,l.defineComponent)({__name:'PromptsPanel',props:{visible:{type:Boolean},templates:{}},emits:['close','reset','toggle','move','delete','create','save'],setup(e,{emit:n}){const a=n,t=(0,l.ref)(!1),i=(0,l.ref)(null),c=(0,l.ref)({name:'',description:'',content:'',type:'footer',enabled:!0}),o=()=>{c.value={name:'',description:'',content:'',type:'footer',enabled:!0},t.value=!0},s=()=>{t.value=!1},r=()=>{c.value.name.trim()?(a('create',{name:c.value.name.trim(),description:c.value.description.trim(),content:c.value.content,type:c.value.type,enabled:c.value.enabled}),t.value=!1):toastr.warning('请输入模板名称')},d=e=>{i.value={...e}},g=()=>{i.value=null},A=()=>{i.value&&(a('save',i.value),i.value=null)},p=()=>{t.value&&(t.value=!1),i.value&&(i.value=null),a('close')};return(n,a)=>((0,l.openBlock)(),(0,l.createBlock)((0,l.unref)(Se),{visible:e.visible,title:'提示词管理',icon:'fa-solid fa-file-lines','panel-class':'gc-prompts-panel',onClose:p},{'header-actions':(0,l.withCtx)(()=>[(0,l.createElementVNode)('button',{class:'gc-btn-link',onClick:a[0]||(a[0]=e=>n.$emit('reset')),title:'重置为默认'},[...a[9]||(a[9]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-rotate-left'},null,-1)])])]),default:(0,l.withCtx)(()=>[(0,l.createElementVNode)('div',In,[(0,l.createCommentVNode)(' 模板列表 '),i.value||t.value?t.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' 新建模板 '),(0,l.createElementVNode)('div',Zn,[(0,l.createElementVNode)('div',{class:'gc-editor-header'},[(0,l.createElementVNode)('button',{class:'gc-btn-link',onClick:s},[...a[18]||(a[18]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-arrow-left'},null,-1),(0,l.createTextVNode)(' 返回列表 ',-1)])]),a[19]||(a[19]=(0,l.createElementVNode)('span',{class:'gc-editor-title'},'新建模板',-1))]),(0,l.createElementVNode)('div',Xn,[(0,l.createElementVNode)('div',Jn,[a[20]||(a[20]=(0,l.createElementVNode)('label',null,'模板名称 *',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>c.value.name=e),type:'text',class:'gc-input',placeholder:'输入模板名称'},null,512),[[l.vModelText,c.value.name]])]),(0,l.createElementVNode)('div',Kn,[a[21]||(a[21]=(0,l.createElementVNode)('label',null,'描述',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>c.value.description=e),type:'text',class:'gc-input',placeholder:'简短描述模板用途'},null,512),[[l.vModelText,c.value.description]])]),(0,l.createElementVNode)('div',ea,[a[23]||(a[23]=(0,l.createElementVNode)('label',null,'模板类型',-1)),(0,l.withDirectives)((0,l.createElementVNode)('select',{'onUpdate:modelValue':a[3]||(a[3]=e=>c.value.type=e),class:'gc-input'},[...a[22]||(a[22]=[(0,l.createElementVNode)('option',{value:'header'},'header - 头部说明',-1),(0,l.createElementVNode)('option',{value:'character'},'character - 角色数据（为每个角色生成）',-1),(0,l.createElementVNode)('option',{value:'interaction'},'interaction - 互动限制',-1),(0,l.createElementVNode)('option',{value:'rules'},'rules - 规则说明',-1),(0,l.createElementVNode)('option',{value:'footer'},'footer - 尾部补充',-1)])],512),[[l.vModelSelect,c.value.type]])]),(0,l.createElementVNode)('div',na,[a[24]||(a[24]=(0,l.createElementVNode)('label',null,'模板内容',-1)),a[25]||(a[25]=(0,l.createElementVNode)('div',{class:'gc-editor-hint'},[(0,l.createTextVNode)(' 支持变量: '),(0,l.createElementVNode)('code',null,'{{角色名}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{当前身高_格式化}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{倍率}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{级别}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{描述}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{身体数据}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{相对参照}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{互动限制列表}}')],-1)),(0,l.withDirectives)((0,l.createElementVNode)('textarea',{'onUpdate:modelValue':a[4]||(a[4]=e=>c.value.content=e),class:'gc-textarea gc-editor-textarea',rows:'10',placeholder:'输入模板内容...'},null,512),[[l.vModelText,c.value.content]])]),(0,l.createElementVNode)('div',aa,[a[26]||(a[26]=(0,l.createElementVNode)('label',null,[(0,l.createElementVNode)('span',null,'默认启用')],-1)),(0,l.createVNode)((0,l.unref)(xe),{modelValue:c.value.enabled,'onUpdate:modelValue':a[5]||(a[5]=e=>c.value.enabled=e)},null,8,['modelValue'])]),(0,l.createElementVNode)('div',ta,[(0,l.createVNode)((0,l.unref)(ke),{onClick:s},{default:(0,l.withCtx)(()=>[...a[27]||(a[27]=[(0,l.createTextVNode)('取消',-1)])]),_:1}),(0,l.createVNode)((0,l.unref)(ke),{variant:'primary',onClick:r},{default:(0,l.withCtx)(()=>[...a[28]||(a[28]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-plus'},null,-1),(0,l.createTextVNode)(' 创建模板 ',-1)])]),_:1})])])])],2112)):i.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' 模板编辑 '),(0,l.createElementVNode)('div',ia,[(0,l.createElementVNode)('div',ca,[(0,l.createElementVNode)('button',{class:'gc-btn-link',onClick:g},[...a[29]||(a[29]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-arrow-left'},null,-1),(0,l.createTextVNode)(' 返回列表 ',-1)])]),(0,l.createElementVNode)('span',oa,'编辑: '+(0,l.toDisplayString)(i.value.name),1)]),(0,l.createElementVNode)('div',sa,[(0,l.createElementVNode)('div',ra,[a[30]||(a[30]=(0,l.createElementVNode)('label',null,'模板名称',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[6]||(a[6]=e=>i.value.name=e),type:'text',class:'gc-input',disabled:i.value.builtin},null,8,la),[[l.vModelText,i.value.name]])]),(0,l.createElementVNode)('div',da,[a[31]||(a[31]=(0,l.createElementVNode)('label',null,'描述',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[7]||(a[7]=e=>i.value.description=e),type:'text',class:'gc-input'},null,512),[[l.vModelText,i.value.description]])]),(0,l.createElementVNode)('div',ga,[a[32]||(a[32]=(0,l.createElementVNode)('label',null,'模板内容',-1)),a[33]||(a[33]=(0,l.createElementVNode)('div',{class:'gc-editor-hint'},[(0,l.createTextVNode)(' 支持变量: '),(0,l.createElementVNode)('code',null,'{{角色名}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{当前身高_格式化}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{倍率}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{级别}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{描述}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{身体数据}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{相对参照}}'),(0,l.createTextVNode)(),(0,l.createElementVNode)('code',null,'{{互动限制列表}}')],-1)),(0,l.withDirectives)((0,l.createElementVNode)('textarea',{'onUpdate:modelValue':a[8]||(a[8]=e=>i.value.content=e),class:'gc-textarea gc-editor-textarea',rows:'12'},null,512),[[l.vModelText,i.value.content]])]),(0,l.createElementVNode)('div',Aa,[(0,l.createVNode)((0,l.unref)(ke),{onClick:g},{default:(0,l.withCtx)(()=>[...a[34]||(a[34]=[(0,l.createTextVNode)('取消',-1)])]),_:1}),(0,l.createVNode)((0,l.unref)(ke),{variant:'primary',onClick:A},{default:(0,l.withCtx)(()=>[...a[35]||(a[35]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-save'},null,-1),(0,l.createTextVNode)(' 保存 ',-1)])]),_:1})])])])],2112)):(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',Wn,[a[17]||(a[17]=(0,l.createElementVNode)('div',{class:'gc-prompts-hint'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-info-circle'}),(0,l.createElementVNode)('span',null,'启用/禁用模板来自定义注入的提示词内容，点击模板可编辑')],-1)),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.templates,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:(0,l.normalizeClass)(['gc-prompt-item',{disabled:!e.enabled,builtin:e.builtin}])},[(0,l.createElementVNode)('div',Mn,[(0,l.createVNode)((0,l.unref)(xe),{'model-value':e.enabled,size:'sm','onUpdate:modelValue':a=>n.$emit('toggle',e.id)},null,8,['model-value','onUpdate:modelValue'])]),(0,l.createElementVNode)('div',{class:'gc-prompt-info',onClick:n=>d(e)},[(0,l.createElementVNode)('div',On,[(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(e.name),1),e.builtin?((0,l.openBlock)(),(0,l.createBlock)((0,l.unref)($e),{key:0,size:'sm'},{default:(0,l.withCtx)(()=>[...a[10]||(a[10]=[(0,l.createTextVNode)('内置',-1)])]),_:1})):((0,l.openBlock)(),(0,l.createBlock)((0,l.unref)($e),{key:1,variant:'custom',size:'sm'},{default:(0,l.withCtx)(()=>[...a[11]||(a[11]=[(0,l.createTextVNode)('自定义',-1)])]),_:1})),(0,l.createElementVNode)('span',Pn,(0,l.toDisplayString)(e.type),1)]),(0,l.createElementVNode)('div',Rn,(0,l.toDisplayString)(e.description),1)],8,Yn),(0,l.createElementVNode)('div',Un,[(0,l.createElementVNode)('div',qn,[(0,l.createElementVNode)('button',{class:'gc-btn-icon-xs',onClick:a=>n.$emit('move',e.id,'up'),title:'上移'},[...a[12]||(a[12]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-chevron-up'},null,-1)])],8,Gn),(0,l.createElementVNode)('button',{class:'gc-btn-icon-xs',onClick:a=>n.$emit('move',e.id,'down'),title:'下移'},[...a[13]||(a[13]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-chevron-down'},null,-1)])],8,Ln)]),(0,l.createElementVNode)('button',{class:'gc-btn-icon-sm',onClick:n=>d(e),title:'编辑'},[...a[14]||(a[14]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-pen'},null,-1)])],8,Hn),e.builtin?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'gc-btn-icon-sm danger',onClick:a=>n.$emit('delete',e.id,e.name),title:'删除'},[...a[15]||(a[15]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-trash'},null,-1)])],8,Qn))])],2))),128)),(0,l.createVNode)((0,l.unref)(ke),{class:'gc-add-template-btn',onClick:o},{default:(0,l.withCtx)(()=>[...a[16]||(a[16]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-plus'},null,-1),(0,l.createTextVNode)(' 新建自定义模板 ',-1)])]),_:1})]))])]),_:1},8,['visible']))}});o(681);const ma=(0,fe.A)(pa,[['__scopeId','data-v-16fdb386']]),Ca={class:'gc-debug-status-section'},ua={class:'gc-debug-section'},ba={class:'gc-debug-status'},va={class:'gc-debug-row'},fa={key:0,class:'gc-debug-row'},xa={class:'gc-debug-value'},ha={class:'gc-debug-row'},Ba={class:'gc-debug-value mono'},Ea={class:'gc-debug-section'},wa={class:'gc-debug-status'},ya={class:'gc-debug-row'},ka={class:'gc-debug-row'},Va={class:'gc-debug-row'},Na={class:'gc-debug-row'},Da={class:'gc-debug-row'},Fa={class:'gc-debug-value'},Sa={class:'gc-debug-section'},za={class:'gc-debug-status'},$a={class:'gc-debug-row'},_a={class:'gc-debug-row'},Ta={class:'gc-debug-row'},ja={class:'gc-debug-row'},Ia={class:'gc-debug-section'},Wa={class:'gc-debug-status'},Ma={class:'gc-debug-row'},Ya={class:'gc-debug-value'},Oa={class:'gc-debug-row'},Pa={key:0,class:'gc-debug-row'},Ra={class:'gc-debug-value'},Ua={class:'gc-debug-row'},qa={class:'gc-debug-value highlight'},Ga=(0,l.defineComponent)({__name:'DebugStatusSection',props:{mvuInfo:{}},setup:e=>(n,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Ca,[(0,l.createCommentVNode)(' MVU 状态 '),(0,l.createElementVNode)('div',ua,[a[3]||(a[3]=(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-satellite-dish'}),(0,l.createTextVNode)(' MVU 连接')],-1)),(0,l.createElementVNode)('div',ba,[(0,l.createElementVNode)('div',va,[a[0]||(a[0]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'MVU 可用',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['gc-debug-value',e.mvuInfo.mvuAvailable?'success':'error'])},(0,l.toDisplayString)(e.mvuInfo.mvuAvailable?'✅ 是':'❌ 否'),3)]),e.mvuInfo.mvuVersion?((0,l.openBlock)(),(0,l.createElementBlock)('div',fa,[a[1]||(a[1]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'MVU 版本',-1)),(0,l.createElementVNode)('span',xa,(0,l.toDisplayString)(e.mvuInfo.mvuVersion),1)])):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('div',ha,[a[2]||(a[2]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'变量前缀',-1)),(0,l.createElementVNode)('span',Ba,(0,l.toDisplayString)(e.mvuInfo.prefix),1)])])]),(0,l.createCommentVNode)(' 数据状态 '),(0,l.createElementVNode)('div',Ea,[a[9]||(a[9]=(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-database'}),(0,l.createTextVNode)(' 数据状态')],-1)),(0,l.createElementVNode)('div',wa,[(0,l.createElementVNode)('div',ya,[a[4]||(a[4]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'stat_data',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['gc-debug-value',e.mvuInfo.messageVariables?.hasStatData?'success':'warn'])},(0,l.toDisplayString)(e.mvuInfo.messageVariables?.hasStatData?'✅ 有':'⚠️ 无'),3)]),(0,l.createElementVNode)('div',ka,[a[5]||(a[5]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'巨大娘数据',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['gc-debug-value',e.mvuInfo.messageVariables?.hasGiantessData?'success':'warn'])},(0,l.toDisplayString)(e.mvuInfo.messageVariables?.hasGiantessData?'✅ 有':'⚠️ 无'),3)]),(0,l.createElementVNode)('div',Va,[a[6]||(a[6]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'场景数据',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['gc-debug-value',e.mvuInfo.messageVariables?.hasScenarioData?'success':'muted'])},(0,l.toDisplayString)(e.mvuInfo.messageVariables?.hasScenarioData?'✅ 有':'— 无'),3)]),(0,l.createElementVNode)('div',Na,[a[7]||(a[7]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'互动限制',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['gc-debug-value',e.mvuInfo.messageVariables?.hasInteractionData?'success':'muted'])},(0,l.toDisplayString)(e.mvuInfo.messageVariables?.hasInteractionData?'✅ 有':'— 无'),3)]),(0,l.createElementVNode)('div',Da,[a[8]||(a[8]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'角色数量',-1)),(0,l.createElementVNode)('span',Fa,(0,l.toDisplayString)(e.mvuInfo.messageVariables?.characterDetails?.length||0),1)])])]),(0,l.createCommentVNode)(' 当前设置 '),(0,l.createElementVNode)('div',Sa,[a[14]||(a[14]=(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-sliders'}),(0,l.createTextVNode)(' 当前配置')],-1)),(0,l.createElementVNode)('div',za,[(0,l.createElementVNode)('div',$a,[a[10]||(a[10]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'脚本启用',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['gc-debug-value',e.mvuInfo.settings?.enabled?'success':'warn'])},(0,l.toDisplayString)(e.mvuInfo.settings?.enabled?'✅ 是':'⚠️ 否'),3)]),(0,l.createElementVNode)('div',_a,[a[11]||(a[11]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'自动注入',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['gc-debug-value',e.mvuInfo.settings?.autoInject?'success':'muted'])},(0,l.toDisplayString)(e.mvuInfo.settings?.autoInject?'✅ 开':'— 关'),3)]),(0,l.createElementVNode)('div',Ta,[a[12]||(a[12]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'损害计算',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['gc-debug-value',e.mvuInfo.settings?.enableDamageCalculation?'success':'muted'])},(0,l.toDisplayString)(e.mvuInfo.settings?.enableDamageCalculation?'✅ 开':'— 关'),3)]),(0,l.createElementVNode)('div',ja,[a[13]||(a[13]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'世界观注入',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['gc-debug-value',e.mvuInfo.settings?.injectWorldviewPrompt?'success':'muted'])},(0,l.toDisplayString)(e.mvuInfo.settings?.injectWorldviewPrompt?'✅ 开':'— 关'),3)])])]),(0,l.createCommentVNode)(' 场景与世界观 '),(0,l.createElementVNode)('div',Ia,[a[19]||(a[19]=(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-globe'}),(0,l.createTextVNode)(' 场景与世界观')],-1)),(0,l.createElementVNode)('div',Wa,[(0,l.createElementVNode)('div',Ma,[a[15]||(a[15]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'当前场景',-1)),(0,l.createElementVNode)('span',Ya,(0,l.toDisplayString)(e.mvuInfo.scenario?.current),1)]),(0,l.createElementVNode)('div',Oa,[a[16]||(a[16]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'场景来源',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['gc-debug-value','MVU变量'===e.mvuInfo.scenario?.source?'highlight':'muted'])},(0,l.toDisplayString)(e.mvuInfo.scenario?.source),3)]),e.mvuInfo.scenario?.reason?((0,l.openBlock)(),(0,l.createElementBlock)('div',Pa,[a[17]||(a[17]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'场景原因',-1)),(0,l.createElementVNode)('span',Ra,(0,l.toDisplayString)(e.mvuInfo.scenario.reason),1)])):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('div',Ua,[a[18]||(a[18]=(0,l.createElementVNode)('span',{class:'gc-debug-label'},'当前世界观',-1)),(0,l.createElementVNode)('span',qa,(0,l.toDisplayString)(e.mvuInfo.worldview?.name),1)])])])]))});o(894);const La=(0,fe.A)(Ga,[['__scopeId','data-v-91dab098']]),Ha={class:'gc-debug-characters-section'},Qa={key:0,class:'gc-debug-empty'},Za={key:1,class:'gc-debug-characters'},Xa={class:'gc-debug-char-header'},Ja={class:'gc-debug-char-name'},Ka={class:'gc-debug-char-body'},et={class:'gc-debug-char-row'},nt={class:'mono'},at={class:'gc-debug-char-row'},tt={class:'mono'},it={class:'gc-debug-char-row'},ct={class:'mono'},ot={key:0,class:'gc-debug-char-row'},st={class:'highlight'},rt={class:'gc-debug-char-row'},lt={class:'gc-debug-char-row'},dt={class:'gc-debug-char-row'},gt={key:0,class:'gc-debug-char-custom'},At={class:'mono'},pt={key:1,class:'gc-debug-char-damage estimate'},mt={class:'gc-debug-char-row'},Ct={class:'damage'},ut={class:'gc-debug-char-row'},bt={class:'damage'},vt={class:'gc-debug-char-row'},ft={key:2,class:'gc-debug-char-damage actual'},xt={key:0,class:'gc-debug-char-row'},ht={class:'actual-damage'},Bt={key:1,class:'gc-debug-char-row'},Et={class:'actual-damage'},wt={key:2,class:'gc-debug-char-row'},yt={class:'action'},kt={key:3,class:'gc-debug-char-row'},Vt={key:3,class:'gc-debug-char-no-damage'},Nt=(0,l.defineComponent)({__name:'DebugCharactersSection',props:{characters:{}},setup:e=>(n,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Ha,[e.characters.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',Za,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.characters,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.name,class:(0,l.normalizeClass)(['gc-debug-char-card',{giant:'巨大娘'===e.类型,tiny:'小人'===e.类型}])},[(0,l.createElementVNode)('div',Xa,[(0,l.createElementVNode)('span',Ja,(0,l.toDisplayString)(e.name),1),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['gc-debug-char-type','巨大娘'===e.类型?'giant':'tiny'])},(0,l.toDisplayString)(e.类型),3)]),(0,l.createElementVNode)('div',Ka,[(0,l.createElementVNode)('div',et,[a[1]||(a[1]=(0,l.createElementVNode)('span',null,'身高',-1)),(0,l.createElementVNode)('span',nt,(0,l.toDisplayString)(e.当前身高_格式化||`${e.当前身高}m`),1)]),(0,l.createElementVNode)('div',at,[a[2]||(a[2]=(0,l.createElementVNode)('span',null,'原身高',-1)),(0,l.createElementVNode)('span',tt,(0,l.toDisplayString)(e.原身高)+'m',1)]),(0,l.createElementVNode)('div',it,[a[3]||(a[3]=(0,l.createElementVNode)('span',null,'倍率',-1)),(0,l.createElementVNode)('span',ct,(0,l.toDisplayString)(e.倍率?.toFixed(2))+'x',1)]),e.级别?((0,l.openBlock)(),(0,l.createElementBlock)('div',ot,[a[4]||(a[4]=(0,l.createElementVNode)('span',null,'级别',-1)),(0,l.createElementVNode)('span',st,(0,l.toDisplayString)(e.级别),1)])):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('div',rt,[a[5]||(a[5]=(0,l.createElementVNode)('span',null,'计算数据',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(e.有计算数据?'success':'warn')},(0,l.toDisplayString)(e.有计算数据?'✅':'❌'),3)]),(0,l.createElementVNode)('div',lt,[a[6]||(a[6]=(0,l.createElementVNode)('span',null,'损害数据',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(e.有损害数据?'success':'muted')},(0,l.toDisplayString)(e.有损害数据?'✅':'—'),3)]),(0,l.createElementVNode)('div',dt,[a[7]||(a[7]=(0,l.createElementVNode)('span',null,'历史记录',-1)),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(e.有身高历史?`${e.历史记录数}条`:'—'),1)])]),(0,l.createCommentVNode)(' 自定义部位 '),e.自定义部位&&Object.keys(e.自定义部位).length?((0,l.openBlock)(),(0,l.createElementBlock)('div',gt,[a[8]||(a[8]=(0,l.createElementVNode)('div',{class:'gc-debug-char-custom-title'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-bolt'}),(0,l.createTextVNode)(' 自定义部位 ')],-1)),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.自定义部位,(e,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:n,class:'gc-debug-char-row'},[(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(n),1),(0,l.createElementVNode)('span',At,(0,l.toDisplayString)(e)+'m',1)]))),128))])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 预估损害 '),e.预估损害?((0,l.openBlock)(),(0,l.createElementBlock)('div',pt,[a[12]||(a[12]=(0,l.createElementVNode)('div',{class:'gc-debug-char-damage-title'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-calculator'}),(0,l.createTextVNode)(' 预估损害 '),(0,l.createElementVNode)('span',{class:'gc-debug-char-damage-badge'},'自动计算')],-1)),(0,l.createElementVNode)('div',mt,[a[9]||(a[9]=(0,l.createElementVNode)('span',null,'破坏力等级',-1)),(0,l.createElementVNode)('span',Ct,(0,l.toDisplayString)(e.预估损害.破坏力等级),1)]),(0,l.createElementVNode)('div',ut,[a[10]||(a[10]=(0,l.createElementVNode)('span',null,'单步伤亡',-1)),(0,l.createElementVNode)('span',bt,(0,l.toDisplayString)(e.预估损害.单步伤亡),1)]),(0,l.createElementVNode)('div',vt,[a[11]||(a[11]=(0,l.createElementVNode)('span',null,'场景',-1)),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(e.预估损害.场景),1)])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 实际损害 '),e.实际损害?((0,l.openBlock)(),(0,l.createElementBlock)('div',ft,[a[17]||(a[17]=(0,l.createElementVNode)('div',{class:'gc-debug-char-damage-title'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-skull'}),(0,l.createTextVNode)(' 实际损害 '),(0,l.createElementVNode)('span',{class:'gc-debug-char-damage-badge actual'},'剧情记录')],-1)),e.实际损害.总伤亡人数_格式化?((0,l.openBlock)(),(0,l.createElementBlock)('div',xt,[a[13]||(a[13]=(0,l.createElementVNode)('span',null,'累计伤亡',-1)),(0,l.createElementVNode)('span',ht,(0,l.toDisplayString)(e.实际损害.总伤亡人数_格式化),1)])):(0,l.createCommentVNode)('v-if',!0),e.实际损害.总建筑损毁?((0,l.openBlock)(),(0,l.createElementBlock)('div',Bt,[a[14]||(a[14]=(0,l.createElementVNode)('span',null,'累计建筑损毁',-1)),(0,l.createElementVNode)('span',Et,(0,l.toDisplayString)(e.实际损害.总建筑损毁)+'栋',1)])):(0,l.createCommentVNode)('v-if',!0),e.实际损害.最近行动?((0,l.openBlock)(),(0,l.createElementBlock)('div',wt,[a[15]||(a[15]=(0,l.createElementVNode)('span',null,'最近行动',-1)),(0,l.createElementVNode)('span',yt,(0,l.toDisplayString)(e.实际损害.最近行动),1)])):(0,l.createCommentVNode)('v-if',!0),e.实际损害.重大事件数?((0,l.openBlock)(),(0,l.createElementBlock)('div',kt,[a[16]||(a[16]=(0,l.createElementVNode)('span',null,'重大事件',-1)),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(e.实际损害.重大事件数)+'件',1)])):(0,l.createCommentVNode)('v-if',!0)])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 无损害数据提示 '),e.预估损害||e.实际损害||'巨大娘'!==e.类型?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',Vt,[...a[18]||(a[18]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-info-circle'},null,-1),(0,l.createElementVNode)('span',null,'启用损害计算后显示预估数据',-1)])]))],2))),128))])):((0,l.openBlock)(),(0,l.createElementBlock)('div',Qa,[...a[0]||(a[0]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-users-slash'},null,-1),(0,l.createElementVNode)('p',null,'暂无角色数据',-1),(0,l.createElementVNode)('small',null,'在世界书或提示词中设置角色身高后，这里会显示详细信息',-1)])]))]))});o(202);const Dt=(0,fe.A)(Nt,[['__scopeId','data-v-3eacdf91']]),Ft={class:'gc-debug-test-section'},St={class:'gc-debug-section'},zt={class:'gc-debug-form'},$t={class:'gc-debug-input-row'},_t=['value'],Tt=['value'],jt=['value'],It={class:'gc-debug-hint'},Wt={key:0},Mt={key:1},Yt={key:2},Ot={class:'gc-debug-btn-row'},Pt=['disabled'],Rt={class:'gc-debug-section'},Ut={class:'gc-debug-quick-tests'},qt={class:'gc-debug-section'},Gt={class:'gc-debug-form'},Lt={class:'gc-setting-item'},Ht=['value'],Qt={key:0,class:'gc-actual-damage-form'},Zt={class:'gc-debug-input-group'},Xt={class:'gc-debug-input-row'},Jt={class:'gc-debug-input-group'},Kt={class:'gc-debug-input-row'},ei={class:'gc-debug-input-group'},ni={class:'gc-debug-input-group'},ai={class:'gc-debug-input-row'},ti={class:'gc-debug-input-group'},ii={key:1,class:'gc-debug-hint muted'},ci=(0,l.defineComponent)({__name:'DebugTestSection',props:{testName:{},testHeight:{},testOriginal:{},characters:{}},emits:['update:test-name','update:test-height','update:test-original','inject','clear','quick-test','save-damage','clear-damage'],setup(e,{emit:n}){const a=e,t=n,i=(0,l.ref)(''),c=(0,l.ref)({totalCasualties:0,totalBuildings:0,lastAction:'',lastActionCasualties:0,note:''}),o=(0,l.computed)(()=>a.characters.filter(e=>e.currentHeight/e.originalHeight>=1)),s=()=>{i.value&&t('save-damage',{name:i.value,data:{...c.value}})},r=()=>{i.value&&(t('clear-damage',i.value),c.value={totalCasualties:0,totalBuildings:0,lastAction:'',lastActionCasualties:0,note:''})};return(n,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Ft,[(0,l.createCommentVNode)(' 测试数据注入 '),(0,l.createElementVNode)('div',St,[a[25]||(a[25]=(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-flask'}),(0,l.createTextVNode)(' 测试数据注入')],-1)),(0,l.createElementVNode)('div',zt,[(0,l.createElementVNode)('div',$t,[(0,l.createElementVNode)('input',{value:e.testName,onInput:a[0]||(a[0]=e=>n.$emit('update:test-name',e.target.value)),type:'text',placeholder:'角色名',class:'gc-input sm'},null,40,_t),(0,l.createElementVNode)('input',{value:e.testHeight,onInput:a[1]||(a[1]=e=>n.$emit('update:test-height',parseFloat(e.target.value)||0)),type:'number',placeholder:'身高(m)',class:'gc-input sm'},null,40,Tt),(0,l.createElementVNode)('input',{value:e.testOriginal,onInput:a[2]||(a[2]=e=>n.$emit('update:test-original',parseFloat(e.target.value)||0)),type:'number',placeholder:'原高(m)',class:'gc-input sm'},null,40,jt)]),(0,l.createElementVNode)('div',It,[a[21]||(a[21]=(0,l.createElementVNode)('i',{class:'fa-solid fa-info-circle'},null,-1)),e.testHeight&&e.testOriginal&&e.testHeight<e.testOriginal?((0,l.openBlock)(),(0,l.createElementBlock)('span',Wt,[a[17]||(a[17]=(0,l.createTextVNode)(' 将创建',-1)),a[18]||(a[18]=(0,l.createElementVNode)('strong',{class:'tiny'},'小人',-1)),(0,l.createTextVNode)('（'+(0,l.toDisplayString)((e.testHeight/e.testOriginal).toFixed(4))+'倍） ',1)])):e.testHeight&&e.testOriginal?((0,l.openBlock)(),(0,l.createElementBlock)('span',Mt,[a[19]||(a[19]=(0,l.createTextVNode)(' 将创建',-1)),a[20]||(a[20]=(0,l.createElementVNode)('strong',{class:'giant'},'巨大娘',-1)),(0,l.createTextVNode)('（'+(0,l.toDisplayString)((e.testHeight/e.testOriginal).toFixed(1))+'倍） ',1)])):((0,l.openBlock)(),(0,l.createElementBlock)('span',Yt,'输入身高和原高自动判断类型'))]),(0,l.createElementVNode)('div',Ot,[(0,l.createElementVNode)('button',{class:'gc-btn gc-btn-sm primary',onClick:a[3]||(a[3]=e=>n.$emit('inject'))},[...a[22]||(a[22]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-syringe'},null,-1),(0,l.createTextVNode)(' 注入测试 ',-1)])]),(0,l.createElementVNode)('button',{class:'gc-btn gc-btn-sm',onClick:a[4]||(a[4]=a=>n.$emit('clear',e.testName)),disabled:!e.testName},[...a[23]||(a[23]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-eraser'},null,-1),(0,l.createTextVNode)(' 清除此角色 ',-1)])],8,Pt),(0,l.createElementVNode)('button',{class:'gc-btn gc-btn-sm danger',onClick:a[5]||(a[5]=e=>n.$emit('clear'))},[...a[24]||(a[24]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-trash'},null,-1),(0,l.createTextVNode)(' 清除全部 ',-1)])])])])]),(0,l.createCommentVNode)(' 快捷测试 '),(0,l.createElementVNode)('div',Rt,[a[26]||(a[26]=(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-lightbulb'}),(0,l.createTextVNode)(' 快捷测试')],-1)),(0,l.createElementVNode)('div',Ut,[(0,l.createElementVNode)('button',{class:'gc-btn gc-btn-sm',onClick:a[6]||(a[6]=e=>n.$emit('quick-test',{name:'巨人',height:100,original:1.65}))},' 巨大娘 100m '),(0,l.createElementVNode)('button',{class:'gc-btn gc-btn-sm',onClick:a[7]||(a[7]=e=>n.$emit('quick-test',{name:'千米级',height:1e3,original:1.65}))},' 千米级 1km '),(0,l.createElementVNode)('button',{class:'gc-btn gc-btn-sm',onClick:a[8]||(a[8]=e=>n.$emit('quick-test',{name:'行星级',height:1e7,original:1.65}))},' 行星级 10Mm '),(0,l.createElementVNode)('button',{class:'gc-btn gc-btn-sm tiny',onClick:a[9]||(a[9]=e=>n.$emit('quick-test',{name:'小人',height:.01,original:1.65}))},' 小人 1cm '),(0,l.createElementVNode)('button',{class:'gc-btn gc-btn-sm tiny',onClick:a[10]||(a[10]=e=>n.$emit('quick-test',{name:'微型',height:.001,original:1.65}))},' 微型 1mm ')])]),(0,l.createCommentVNode)(' 实际损害录入 '),(0,l.createElementVNode)('div',qt,[a[41]||(a[41]=(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-skull'}),(0,l.createTextVNode)(' 实际损害录入')],-1)),(0,l.createElementVNode)('div',Gt,[a[40]||(a[40]=(0,l.createElementVNode)('div',{class:'gc-debug-hint damage'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-info-circle'}),(0,l.createElementVNode)('span',null,'记录角色在剧情中造成的实际损害')],-1)),(0,l.createElementVNode)('div',Lt,[a[28]||(a[28]=(0,l.createElementVNode)('label',null,'选择角色',-1)),(0,l.withDirectives)((0,l.createElementVNode)('select',{'onUpdate:modelValue':a[11]||(a[11]=e=>i.value=e),class:'gc-input'},[a[27]||(a[27]=(0,l.createElementVNode)('option',{value:''},'-- 选择角色 --',-1)),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('option',{key:e.name,value:e.name},(0,l.toDisplayString)(e.name),9,Ht))),128))],512),[[l.vModelSelect,i.value]])]),i.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Qt,[(0,l.createElementVNode)('div',Zt,[a[30]||(a[30]=(0,l.createElementVNode)('label',null,'累计伤亡',-1)),(0,l.createElementVNode)('div',Xt,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[12]||(a[12]=e=>c.value.totalCasualties=e),type:'number',class:'gc-input sm',placeholder:'0'},null,512),[[l.vModelText,c.value.totalCasualties,void 0,{number:!0}]]),a[29]||(a[29]=(0,l.createElementVNode)('span',{class:'gc-input-suffix'},'人',-1))])]),(0,l.createElementVNode)('div',Jt,[a[32]||(a[32]=(0,l.createElementVNode)('label',null,'累计建筑损毁',-1)),(0,l.createElementVNode)('div',Kt,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[13]||(a[13]=e=>c.value.totalBuildings=e),type:'number',class:'gc-input sm',placeholder:'0'},null,512),[[l.vModelText,c.value.totalBuildings,void 0,{number:!0}]]),a[31]||(a[31]=(0,l.createElementVNode)('span',{class:'gc-input-suffix'},'栋',-1))])]),(0,l.createElementVNode)('div',ei,[a[33]||(a[33]=(0,l.createElementVNode)('label',null,'最近行动描述',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[14]||(a[14]=e=>c.value.lastAction=e),type:'text',class:'gc-input',placeholder:'如：踩下一脚'},null,512),[[l.vModelText,c.value.lastAction]])]),(0,l.createElementVNode)('div',ni,[a[35]||(a[35]=(0,l.createElementVNode)('label',null,'最近行动伤亡',-1)),(0,l.createElementVNode)('div',ai,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[15]||(a[15]=e=>c.value.lastActionCasualties=e),type:'number',class:'gc-input sm',placeholder:'0'},null,512),[[l.vModelText,c.value.lastActionCasualties,void 0,{number:!0}]]),a[34]||(a[34]=(0,l.createElementVNode)('span',{class:'gc-input-suffix'},'人',-1))])]),(0,l.createElementVNode)('div',ti,[a[36]||(a[36]=(0,l.createElementVNode)('label',null,'备注',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[16]||(a[16]=e=>c.value.note=e),type:'text',class:'gc-input',placeholder:'可选备注'},null,512),[[l.vModelText,c.value.note]])]),(0,l.createElementVNode)('div',{class:'gc-debug-btn-row'},[(0,l.createElementVNode)('button',{class:'gc-btn gc-btn-sm primary',onClick:s},[...a[37]||(a[37]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-save'},null,-1),(0,l.createTextVNode)(' 保存 ',-1)])]),(0,l.createElementVNode)('button',{class:'gc-btn gc-btn-sm danger',onClick:r},[...a[38]||(a[38]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-trash'},null,-1),(0,l.createTextVNode)(' 清除 ',-1)])])])])):((0,l.openBlock)(),(0,l.createElementBlock)('div',ii,[...a[39]||(a[39]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-exclamation-circle'},null,-1),(0,l.createElementVNode)('span',null,'请先选择一个巨大娘角色',-1)])]))])])]))}});o(799);const oi=(0,fe.A)(ci,[['__scopeId','data-v-075ee580']]),si={class:'gc-debug-logs-section'},ri={class:'gc-debug-logs-header'},li={class:'gc-debug-logs'},di={class:'gc-log-time'},gi={class:'gc-log-msg'},Ai={key:0,class:'gc-debug-empty'},pi=(0,l.defineComponent)({__name:'DebugLogsSection',props:{logs:{}},emits:['clear'],setup:e=>(n,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',si,[(0,l.createElementVNode)('div',ri,[a[2]||(a[2]=(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-terminal'}),(0,l.createTextVNode)(' 调试日志')],-1)),(0,l.createElementVNode)('button',{class:'gc-btn-link',onClick:a[0]||(a[0]=e=>n.$emit('clear')),title:'清空日志'},[...a[1]||(a[1]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-trash'},null,-1)])])]),(0,l.createElementVNode)('div',li,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.logs,(e,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:n,class:(0,l.normalizeClass)(['gc-debug-log-item',e.level])},[(0,l.createElementVNode)('span',di,(0,l.toDisplayString)(e.time),1),(0,l.createElementVNode)('span',gi,(0,l.toDisplayString)(e.message),1)],2))),128)),e.logs.length?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',Ai,[...a[3]||(a[3]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-terminal'},null,-1),(0,l.createElementVNode)('p',null,'暂无日志',-1),(0,l.createElementVNode)('small',null,'开启调试模式后操作会记录在这里',-1)])]))])]))});o(152);const mi=(0,fe.A)(pi,[['__scopeId','data-v-4e1480de']]),Ci={class:'gc-debug-raw-section'},ui={class:'gc-debug-section'},bi={class:'gc-debug-json'},vi={class:'gc-debug-section'},fi={class:'gc-debug-json'},xi=(0,l.defineComponent)({__name:'DebugRawSection',props:{mvuInfo:{},settings:{}},setup:e=>(n,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Ci,[(0,l.createElementVNode)('div',ui,[a[0]||(a[0]=(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-database'}),(0,l.createTextVNode)(' MVU 原始数据')],-1)),(0,l.createElementVNode)('pre',bi,(0,l.toDisplayString)(JSON.stringify(e.mvuInfo.messageVariables,null,2)),1)]),(0,l.createElementVNode)('div',vi,[a[1]||(a[1]=(0,l.createElementVNode)('h3',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-cog'}),(0,l.createTextVNode)(' 当前设置')],-1)),(0,l.createElementVNode)('pre',fi,(0,l.toDisplayString)(JSON.stringify(e.settings,null,2)),1)])]))});o(153);const hi=(0,fe.A)(xi,[['__scopeId','data-v-22b96ac2']]),Bi={class:'gc-debug-content'},Ei={class:'gc-debug-tabs'},wi={key:0,class:'gc-debug-tab-badge'},yi={key:0,class:'gc-debug-tab-badge'},ki={key:0,class:'gc-debug-tab-content'},Vi={key:1,class:'gc-debug-tab-content'},Ni={key:2,class:'gc-debug-tab-content'},Di={key:3,class:'gc-debug-tab-content'},Fi={key:4,class:'gc-debug-tab-content'},Si=(0,l.defineComponent)({__name:'DebugPanel',props:{visible:{type:Boolean},mvuInfo:{},logs:{},settings:{},characters:{},testName:{},testHeight:{},testOriginal:{}},emits:['close','refresh','clear-logs','update:testName','update:testHeight','update:testOriginal','inject-test','clear-test','quick-test','save-damage','clear-damage'],setup(e){const n=e,a=(0,l.ref)('status'),t=(0,l.computed)(()=>n.mvuInfo.messageVariables?.characterDetails?.length||0),i=(0,l.computed)(()=>(n.mvuInfo.messageVariables?.characterDetails||[]).filter(e=>'未知'!==e.类型));return(n,c)=>((0,l.openBlock)(),(0,l.createBlock)((0,l.unref)(Se),{visible:e.visible,title:'MVU 调试',icon:'fa-solid fa-bug','panel-class':'gc-debug-panel',onClose:c[15]||(c[15]=e=>n.$emit('close'))},{'header-actions':(0,l.withCtx)(()=>[(0,l.createElementVNode)('button',{class:'gc-btn-link',onClick:c[0]||(c[0]=e=>n.$emit('refresh')),title:'刷新状态'},[...c[16]||(c[16]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-rotate'},null,-1)])])]),default:(0,l.withCtx)(()=>[(0,l.createElementVNode)('div',Bi,[(0,l.createCommentVNode)(' 选项卡导航 '),(0,l.createElementVNode)('div',Ei,[(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['gc-debug-tab',{active:'status'===a.value}]),onClick:c[1]||(c[1]=e=>a.value='status')},[...c[17]||(c[17]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-satellite-dish'},null,-1),(0,l.createTextVNode)(' 状态 ',-1)])],2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['gc-debug-tab',{active:'characters'===a.value}]),onClick:c[2]||(c[2]=e=>a.value='characters')},[c[18]||(c[18]=(0,l.createElementVNode)('i',{class:'fa-solid fa-users'},null,-1)),c[19]||(c[19]=(0,l.createTextVNode)(' 角色 ',-1)),t.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',wi,(0,l.toDisplayString)(t.value),1)):(0,l.createCommentVNode)('v-if',!0)],2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['gc-debug-tab',{active:'test'===a.value}]),onClick:c[3]||(c[3]=e=>a.value='test')},[...c[20]||(c[20]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-flask'},null,-1),(0,l.createTextVNode)(' 测试 ',-1)])],2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['gc-debug-tab',{active:'logs'===a.value}]),onClick:c[4]||(c[4]=e=>a.value='logs')},[c[21]||(c[21]=(0,l.createElementVNode)('i',{class:'fa-solid fa-terminal'},null,-1)),c[22]||(c[22]=(0,l.createTextVNode)(' 日志 ',-1)),e.logs.length?((0,l.openBlock)(),(0,l.createElementBlock)('span',yi,(0,l.toDisplayString)(e.logs.length),1)):(0,l.createCommentVNode)('v-if',!0)],2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['gc-debug-tab',{active:'raw'===a.value}]),onClick:c[5]||(c[5]=e=>a.value='raw')},[...c[23]||(c[23]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-database'},null,-1),(0,l.createTextVNode)(' 原始 ',-1)])],2)]),(0,l.createCommentVNode)(' 状态选项卡 '),'status'===a.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',ki,[(0,l.createVNode)(La,{'mvu-info':e.mvuInfo},null,8,['mvu-info'])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 角色选项卡 '),'characters'===a.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Vi,[(0,l.createVNode)(Dt,{characters:i.value},null,8,['characters'])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 测试选项卡 '),'test'===a.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ni,[(0,l.createVNode)(oi,{'test-name':e.testName,'test-height':e.testHeight,'test-original':e.testOriginal,characters:e.characters,'onUpdate:testName':c[6]||(c[6]=e=>n.$emit('update:testName',e)),'onUpdate:testHeight':c[7]||(c[7]=e=>n.$emit('update:testHeight',e)),'onUpdate:testOriginal':c[8]||(c[8]=e=>n.$emit('update:testOriginal',e)),onInject:c[9]||(c[9]=e=>n.$emit('inject-test')),onClear:c[10]||(c[10]=e=>n.$emit('clear-test',e)),onQuickTest:c[11]||(c[11]=e=>n.$emit('quick-test',e)),onSaveDamage:c[12]||(c[12]=e=>n.$emit('save-damage',e)),onClearDamage:c[13]||(c[13]=e=>n.$emit('clear-damage',e))},null,8,['test-name','test-height','test-original','characters'])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 日志选项卡 '),'logs'===a.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Di,[(0,l.createVNode)(mi,{logs:e.logs,onClear:c[14]||(c[14]=e=>n.$emit('clear-logs'))},null,8,['logs'])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 原始数据选项卡 '),'raw'===a.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Fi,[(0,l.createVNode)(hi,{'mvu-info':e.mvuInfo,settings:e.settings},null,8,['mvu-info','settings'])])):(0,l.createCommentVNode)('v-if',!0)])]),_:1},8,['visible']))}});o(821);const zi=(0,fe.A)(Si,[['__scopeId','data-v-18dd7d1a']]),$i={class:'gc-extensions'},_i={class:'gc-extension-list'},Ti={class:'gc-extension-item core'},ji={class:'gc-extension-info'},Ii={class:'gc-extension-name'},Wi={class:'gc-extension-info'},Mi={class:'gc-extension-name'},Yi={class:'gc-extension-toggle'},Oi={key:0,class:'gc-expand-icon'},Pi={key:0,class:'gc-extension-settings'},Ri={class:'gc-setting-item'},Ui=['value'],qi=['value'],Gi={class:'gc-setting-toggle'},Li={class:'gc-setting-toggle'},Hi={class:'gc-setting-toggle'},Qi={class:'gc-setting-toggle'},Zi={key:0,class:'gc-damage-preview'},Xi={class:'gc-damage-preview-content'},Ji={class:'gc-damage-stat'},Ki={class:'gc-damage-value'},ec={class:'gc-damage-stat'},nc={class:'gc-damage-value casualties'},ac={class:'gc-damage-stat'},tc={class:'gc-damage-value buildings'},ic=(0,l.defineComponent)({__name:'ExtensionsPanel',props:{settings:{},damageSummary:{},damageScenarios:{}},emits:['toggle-damage','update:setting'],setup(e){const n=e,a=(0,l.ref)(!1),t=(0,l.ref)(!0);(0,l.watch)(()=>n.settings.enableDamageCalculation,e=>{e&&(t.value=!0)});const i=e=>{if(!e)return'-';const n=e=>e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toString();return`${n(e.min)} - ${n(e.max)}`};return(n,c)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',$i,[(0,l.createElementVNode)('div',{class:'gc-section-header clickable',onClick:c[0]||(c[0]=e=>a.value=!a.value)},[c[9]||(c[9]=(0,l.createElementVNode)('div',{class:'gc-header-left'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-puzzle-piece'}),(0,l.createElementVNode)('span',null,'扩展系统')],-1)),(0,l.createElementVNode)('i',{class:(0,l.normalizeClass)(['fa-solid gc-chevron',a.value?'fa-chevron-right':'fa-chevron-down'])},null,2)]),(0,l.createVNode)(l.Transition,{name:'slide',persisted:''},{default:(0,l.withCtx)(()=>[(0,l.withDirectives)((0,l.createElementVNode)('div',_i,[(0,l.createCommentVNode)(' 核心计算（始终开启） '),(0,l.createElementVNode)('div',Ti,[c[13]||(c[13]=(0,l.createElementVNode)('div',{class:'gc-extension-icon'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-calculator'})],-1)),(0,l.createElementVNode)('div',ji,[(0,l.createElementVNode)('div',Ii,[c[11]||(c[11]=(0,l.createTextVNode)(' 基础计算 ',-1)),(0,l.createVNode)((0,l.unref)($e),{size:'sm'},{default:(0,l.withCtx)(()=>[...c[10]||(c[10]=[(0,l.createTextVNode)('核心',-1)])]),_:1})]),c[12]||(c[12]=(0,l.createElementVNode)('div',{class:'gc-extension-desc'},'身体数据计算、相对尺寸参照',-1))]),c[14]||(c[14]=(0,l.createElementVNode)('div',{class:'gc-extension-toggle'},[(0,l.createElementVNode)('span',{class:'gc-always-on'},'始终开启')],-1))]),(0,l.createCommentVNode)(' 损害计算（可开关） '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['gc-extension-item',{active:e.settings.enableDamageCalculation,clickable:e.settings.enableDamageCalculation}]),onClick:c[3]||(c[3]=n=>e.settings.enableDamageCalculation?t.value=!t.value:null)},[c[18]||(c[18]=(0,l.createElementVNode)('div',{class:'gc-extension-icon damage'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-explosion'})],-1)),(0,l.createElementVNode)('div',Wi,[(0,l.createElementVNode)('div',Mi,[c[16]||(c[16]=(0,l.createTextVNode)(' 损害计算 ',-1)),e.settings.enableDamageCalculation?((0,l.openBlock)(),(0,l.createBlock)((0,l.unref)($e),{key:0,variant:'success',size:'sm'},{default:(0,l.withCtx)(()=>[...c[15]||(c[15]=[(0,l.createTextVNode)('已启用',-1)])]),_:1})):(0,l.createCommentVNode)('v-if',!0)]),c[17]||(c[17]=(0,l.createElementVNode)('div',{class:'gc-extension-desc'},'计算巨大娘行动可能造成的破坏',-1))]),(0,l.createElementVNode)('div',Yi,[(0,l.createElementVNode)('div',{onClick:c[2]||(c[2]=(0,l.withModifiers)(()=>{},['stop'])),class:'gc-switch-wrapper'},[(0,l.createVNode)((0,l.unref)(xe),{'model-value':e.settings.enableDamageCalculation,'onUpdate:modelValue':c[1]||(c[1]=e=>n.$emit('toggle-damage',e))},null,8,['model-value'])]),e.settings.enableDamageCalculation?((0,l.openBlock)(),(0,l.createElementBlock)('div',Oi,[(0,l.createElementVNode)('i',{class:(0,l.normalizeClass)(['fa-solid',t.value?'fa-chevron-up':'fa-chevron-down'])},null,2)])):(0,l.createCommentVNode)('v-if',!0)])],2),(0,l.createCommentVNode)(' 损害计算设置 '),(0,l.createVNode)(l.Transition,{name:'slide'},{default:(0,l.withCtx)(()=>[e.settings.enableDamageCalculation&&t.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Pi,[(0,l.createElementVNode)('div',Ri,[c[19]||(c[19]=(0,l.createElementVNode)('label',null,'默认场景',-1)),(0,l.createElementVNode)('select',{class:'gc-input',value:e.settings.damageScenario,onChange:c[4]||(c[4]=e=>n.$emit('update:setting','damageScenario',e.target.value))},[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.damageScenarios,e=>((0,l.openBlock)(),(0,l.createElementBlock)('option',{key:e.id,value:e.id},(0,l.toDisplayString)(e.name)+' ('+(0,l.toDisplayString)(e.density.toLocaleString())+'人/km²) ',9,qi))),128))],40,Ui)]),(0,l.createElementVNode)('div',Gi,[c[20]||(c[20]=(0,l.createElementVNode)('label',null,[(0,l.createElementVNode)('span',null,'注入损害提示词'),(0,l.createElementVNode)('small',null,'在提示词中包含损害计算结果')],-1)),(0,l.createVNode)((0,l.unref)(xe),{size:'sm','model-value':e.settings.injectDamagePrompt,'onUpdate:modelValue':c[5]||(c[5]=e=>n.$emit('update:setting','injectDamagePrompt',e))},null,8,['model-value'])]),(0,l.createElementVNode)('div',Li,[c[21]||(c[21]=(0,l.createElementVNode)('label',null,[(0,l.createElementVNode)('span',null,'显示特殊效应'),(0,l.createElementVNode)('small',null,'地震、海啸等物理效应')],-1)),(0,l.createVNode)((0,l.unref)(xe),{size:'sm','model-value':e.settings.showSpecialEffects,'onUpdate:modelValue':c[6]||(c[6]=e=>n.$emit('update:setting','showSpecialEffects',e))},null,8,['model-value'])]),(0,l.createElementVNode)('div',Hi,[c[22]||(c[22]=(0,l.createElementVNode)('label',null,[(0,l.createElementVNode)('span',null,'按角色显示损害'),(0,l.createElementVNode)('small',null,'在角色卡片中显示损害数据')],-1)),(0,l.createVNode)((0,l.unref)(xe),{size:'sm','model-value':e.settings.showDamagePerCharacter,'onUpdate:modelValue':c[7]||(c[7]=e=>n.$emit('update:setting','showDamagePerCharacter',e))},null,8,['model-value'])]),(0,l.createElementVNode)('div',Qi,[c[23]||(c[23]=(0,l.createElementVNode)('label',null,[(0,l.createElementVNode)('span',null,'显示损害汇总'),(0,l.createElementVNode)('small',null,'所有角色的损害统计')],-1)),(0,l.createVNode)((0,l.unref)(xe),{size:'sm','model-value':e.settings.showDamageSummary,'onUpdate:modelValue':c[8]||(c[8]=e=>n.$emit('update:setting','showDamageSummary',e))},null,8,['model-value'])]),(0,l.createCommentVNode)(' 损害预览 '),e.damageSummary?((0,l.openBlock)(),(0,l.createElementBlock)('div',Zi,[c[27]||(c[27]=(0,l.createElementVNode)('div',{class:'gc-damage-preview-header'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-chart-bar'}),(0,l.createElementVNode)('span',null,'当前汇总')],-1)),(0,l.createElementVNode)('div',Xi,[(0,l.createElementVNode)('div',Ji,[c[24]||(c[24]=(0,l.createElementVNode)('span',{class:'gc-damage-label'},'巨大娘数量',-1)),(0,l.createElementVNode)('span',Ki,(0,l.toDisplayString)(e.damageSummary.giantCount),1)]),(0,l.createElementVNode)('div',ec,[c[25]||(c[25]=(0,l.createElementVNode)('span',{class:'gc-damage-label'},'预估单步伤亡',-1)),(0,l.createElementVNode)('span',nc,(0,l.toDisplayString)(i(e.damageSummary.totalCasualties)),1)]),(0,l.createElementVNode)('div',ac,[c[26]||(c[26]=(0,l.createElementVNode)('span',{class:'gc-damage-label'},'预估建筑损毁',-1)),(0,l.createElementVNode)('span',tc,(0,l.toDisplayString)(i(e.damageSummary.totalBuildings)),1)])])])):(0,l.createCommentVNode)('v-if',!0)])):(0,l.createCommentVNode)('v-if',!0)]),_:1})],512),[[l.vShow,!a.value]])]),_:1})]))}});o(587);const cc=(0,fe.A)(ic,[['__scopeId','data-v-4e3af112']]);const oc={class:'gc-result-header'},sc={class:'gc-result-icon-wrapper'},rc={class:'gc-result-title'},lc={class:'gc-result-height'},dc={class:'gc-result-meta'},gc={class:'gc-multiplier'},Ac={class:'gc-result-body'},pc={class:'gc-level-desc'},mc={class:'gc-result-desc'},Cc=(0,l.defineComponent)({__name:'Result',props:{result:{},isGiant:{type:Boolean}},emits:['close'],setup:e=>(n,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['gc-result',e.isGiant?'giant':'tiny'])},[(0,l.createElementVNode)('div',oc,[(0,l.createElementVNode)('div',sc,[(0,l.createElementVNode)('i',{class:(0,l.normalizeClass)(['fa-solid',e.isGiant?'fa-ruler-vertical':'fa-microscope'])},null,2)]),(0,l.createElementVNode)('div',rc,[(0,l.createElementVNode)('div',lc,(0,l.toDisplayString)(e.result.当前身高_格式化),1),(0,l.createElementVNode)('div',dc,[(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['gc-badge',e.isGiant?'giant':'tiny'])},(0,l.toDisplayString)(e.result.级别),3),(0,l.createElementVNode)('span',gc,[a[1]||(a[1]=(0,l.createElementVNode)('i',{class:'fa-solid fa-xmark'},null,-1)),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e.result.倍率),1)])])]),(0,l.createElementVNode)('button',{class:'gc-result-close',onClick:a[0]||(a[0]=e=>n.$emit('close')),title:'关闭'},[...a[2]||(a[2]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-times'},null,-1)])])]),(0,l.createElementVNode)('div',Ac,[(0,l.createElementVNode)('div',pc,[a[3]||(a[3]=(0,l.createElementVNode)('i',{class:'fa-solid fa-quote-left'},null,-1)),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e.result.级别描述),1)]),(0,l.createElementVNode)('div',mc,(0,l.toDisplayString)(e.result.描述),1)])],2))});o(526);const uc=(0,fe.A)(Cc,[['__scopeId','data-v-5651f202']]),bc={class:'gc-calc-section'},vc={class:'gc-calc-box'},fc={class:'gc-input-wrapper'},xc={class:'gc-input-wrapper'},hc=(0,l.defineComponent)({__name:'QuickCalc',setup(e){const{calcHeight:n,calcOriginal:a,calcResult:t,isGiant:i,doCalculate:c,clearCalcResult:o}=function(){const e=(0,l.ref)(void 0),n=(0,l.ref)(1.65),a=(0,l.ref)(null),t=(0,l.ref)(!0),i=(0,l.computed)(()=>null!==a.value);return{calcHeight:e,calcOriginal:n,calcResult:a,isGiant:t,hasResult:i,doCalculate:()=>{if(!e.value||e.value<=0)return void toastr.warning('请输入有效的身高');const i=e.value/n.value;t.value=i>=1,a.value=i>=1?V(e.value,n.value):N(e.value,n.value)},clearCalcResult:()=>{a.value=null},resetCalculator:()=>{e.value=void 0,n.value=1.65,a.value=null,t.value=!0}}}();return(e,s)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',bc,[(0,l.createElementVNode)('div',vc,[(0,l.createElementVNode)('div',fc,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':s[0]||(s[0]=e=>(0,l.isRef)(n)?n.value=e:null),type:'number',placeholder:'身高(m)',class:'gc-input',onKeypress:s[1]||(s[1]=(0,l.withKeys)((...e)=>(0,l.unref)(c)&&(0,l.unref)(c)(...e),['enter']))},null,544),[[l.vModelText,(0,l.unref)(n),void 0,{number:!0}]]),s[4]||(s[4]=(0,l.createElementVNode)('span',{class:'gc-unit'},'m',-1))]),s[7]||(s[7]=(0,l.createElementVNode)('span',{class:'gc-operator'},'/',-1)),(0,l.createElementVNode)('div',xc,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':s[2]||(s[2]=e=>(0,l.isRef)(a)?a.value=e:null),type:'number',placeholder:'原高(m)',class:'gc-input'},null,512),[[l.vModelText,(0,l.unref)(a),void 0,{number:!0}]]),s[5]||(s[5]=(0,l.createElementVNode)('span',{class:'gc-unit'},'m',-1))]),(0,l.createElementVNode)('button',{class:'gc-btn-icon primary',onClick:s[3]||(s[3]=(...e)=>(0,l.unref)(c)&&(0,l.unref)(c)(...e)),title:'计算'},[...s[6]||(s[6]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-calculator'},null,-1)])])]),(0,l.createCommentVNode)(' 计算结果 '),(0,l.createVNode)(l.Transition,{name:'fade'},{default:(0,l.withCtx)(()=>[(0,l.unref)(t)?((0,l.openBlock)(),(0,l.createBlock)(uc,{key:0,result:(0,l.unref)(t),'is-giant':(0,l.unref)(i),onClose:(0,l.unref)(o)},null,8,['result','is-giant','onClose'])):(0,l.createCommentVNode)('v-if',!0)]),_:1})]))}});o(175);const Bc=(0,fe.A)(hc,[['__scopeId','data-v-361696cc']]),Ec={class:'gc-char-header'},wc={class:'gc-char-info'},yc={class:'gc-char-name'},kc={class:'gc-char-stats'},Vc={key:0,class:'gc-stat-height'},Nc={key:1,class:'gc-stat-unknown'},Dc={key:2,class:'gc-stat-multiplier'},Fc=['title'],Sc={key:0,class:'gc-char-details'},zc={class:'gc-char-details-grid'},$c={class:'gc-detail-section'},_c={class:'gc-detail-row'},Tc={class:'gc-detail-value'},jc={class:'gc-detail-row'},Ic={class:'gc-detail-value'},Wc={class:'gc-detail-row'},Mc={class:'gc-detail-value'},Yc={class:'gc-detail-row'},Oc={class:'gc-detail-value'},Pc={key:0,class:'gc-detail-section'},Rc={key:0,class:'gc-detail-row'},Uc={class:'gc-detail-label'},qc={class:'gc-detail-value'},Gc={key:1,class:'gc-detail-section'},Lc={key:0,class:'gc-detail-row'},Hc={class:'gc-detail-label'},Qc={class:'gc-detail-value'},Zc={key:2,class:'gc-detail-section'},Xc={key:0,class:'gc-detail-row'},Jc={class:'gc-detail-label'},Kc={class:'gc-detail-value'},eo={key:3,class:'gc-detail-section full-width'},no={class:'gc-history-list'},ao={class:'gc-history-time'},to={class:'gc-history-content'},io={class:'gc-history-height'},co={key:0,class:'gc-history-reason'},oo=(0,l.defineComponent)({__name:'CharacterCard',props:{name:{},data:{},showDamage:{type:Boolean},expanded:{type:Boolean}},emits:['toggle'],setup(e,{emit:n}){const a=e,t=n,i=(0,l.computed)(()=>a.expanded),c=()=>{t('toggle',a.name)},o=(0,l.computed)(()=>a.data.calcData?a.data.calcData.倍率>=1?'giant':'tiny':''),s=(0,l.computed)(()=>a.data.calcData?a.data.calcData.倍率>=1?'fa-solid fa-shoe-prints':'fa-solid fa-bug':'fa-solid fa-user'),r=(0,l.computed)(()=>a.data.calcData?a.data.calcData.倍率>=1?'giant':'tiny':''),d=['眼睛高度','足长','手掌长','乳房高度'],g=['普通成年人','轿车长度','十层楼房'],A=['身高','足长','手掌长'];return(n,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['gc-char-item',{expanded:i.value,'has-damage':e.showDamage&&e.data.damageData}]),onClick:c},[(0,l.createElementVNode)('div',Ec,[(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['gc-char-avatar',o.value])},[(0,l.createElementVNode)('i',{class:(0,l.normalizeClass)(s.value)},null,2)],2),(0,l.createElementVNode)('div',wc,[(0,l.createElementVNode)('div',yc,[(0,l.createTextVNode)((0,l.toDisplayString)(e.name)+' ',1),a[0]||(a[0]=(0,l.createElementVNode)('i',{class:'fa-solid fa-chevron-right gc-char-expand-icon'},null,-1))]),(0,l.createElementVNode)('div',kc,[e.data.calcData?((0,l.openBlock)(),(0,l.createElementBlock)('span',Vc,(0,l.toDisplayString)(e.data.calcData.当前身高_格式化),1)):((0,l.openBlock)(),(0,l.createElementBlock)('span',Nc,'未设置')),e.data.calcData?((0,l.openBlock)(),(0,l.createElementBlock)('span',Dc,' ×'+(0,l.toDisplayString)(e.data.calcData.倍率),1)):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 损害等级指示器 '),e.showDamage&&e.data.damageData?((0,l.openBlock)(),(0,l.createElementBlock)('span',{key:3,class:'gc-damage-indicator',title:`破坏力: ${e.data.damageData.破坏力等级}`},[a[1]||(a[1]=(0,l.createElementVNode)('i',{class:'fa-solid fa-explosion'},null,-1)),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e.data.damageData.破坏力等级),1)],8,Fc)):(0,l.createCommentVNode)('v-if',!0)])]),e.data.calcData?((0,l.openBlock)(),(0,l.createElementBlock)('span',{key:0,class:(0,l.normalizeClass)(['gc-level-badge',r.value])},(0,l.toDisplayString)(e.data.calcData.级别),3)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' 展开详情 '),i.value&&e.data.calcData?((0,l.openBlock)(),(0,l.createElementBlock)('div',Sc,[(0,l.createElementVNode)('div',zc,[(0,l.createCommentVNode)(' 基础数据 '),(0,l.createElementVNode)('div',$c,[a[6]||(a[6]=(0,l.createElementVNode)('div',{class:'gc-detail-section-title'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-ruler-combined'}),(0,l.createTextVNode)(' 基础数据 ')],-1)),(0,l.createElementVNode)('div',_c,[a[2]||(a[2]=(0,l.createElementVNode)('span',{class:'gc-detail-label'},'原身高',-1)),(0,l.createElementVNode)('span',Tc,(0,l.toDisplayString)(e.data.calcData.原身高)+'m',1)]),(0,l.createElementVNode)('div',jc,[a[3]||(a[3]=(0,l.createElementVNode)('span',{class:'gc-detail-label'},'当前身高',-1)),(0,l.createElementVNode)('span',Ic,(0,l.toDisplayString)(e.data.calcData.当前身高_格式化),1)]),(0,l.createElementVNode)('div',Wc,[a[4]||(a[4]=(0,l.createElementVNode)('span',{class:'gc-detail-label'},'倍率',-1)),(0,l.createElementVNode)('span',Mc,'×'+(0,l.toDisplayString)(e.data.calcData.倍率),1)]),(0,l.createElementVNode)('div',Yc,[a[5]||(a[5]=(0,l.createElementVNode)('span',{class:'gc-detail-label'},'级别',-1)),(0,l.createElementVNode)('span',Oc,(0,l.toDisplayString)(e.data.calcData.级别),1)])]),(0,l.createCommentVNode)(' 身体部位（巨大娘） '),'身体部位_格式化'in e.data.calcData?((0,l.openBlock)(),(0,l.createElementBlock)('div',Pc,[a[7]||(a[7]=(0,l.createElementVNode)('div',{class:'gc-detail-section-title'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-person'}),(0,l.createTextVNode)(' 关键部位 ')],-1)),((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(d,n=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:n},[e.data.calcData.身体部位_格式化[n]?((0,l.openBlock)(),(0,l.createElementBlock)('div',Rc,[(0,l.createElementVNode)('span',Uc,(0,l.toDisplayString)(n),1),(0,l.createElementVNode)('span',qc,(0,l.toDisplayString)(e.data.calcData.身体部位_格式化[n]),1)])):(0,l.createCommentVNode)('v-if',!0)],64))),64))])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 眼中的世界（巨大娘） '),'眼中的世界_格式化'in e.data.calcData?((0,l.openBlock)(),(0,l.createElementBlock)('div',Gc,[a[8]||(a[8]=(0,l.createElementVNode)('div',{class:'gc-detail-section-title'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-eye'}),(0,l.createTextVNode)(' 她眼中的世界 ')],-1)),((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(g,n=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:n},[e.data.calcData.眼中的世界_格式化[n]?((0,l.openBlock)(),(0,l.createElementBlock)('div',Lc,[(0,l.createElementVNode)('span',Hc,(0,l.toDisplayString)(n),1),(0,l.createElementVNode)('span',Qc,(0,l.toDisplayString)(e.data.calcData.眼中的世界_格式化[n]),1)])):(0,l.createCommentVNode)('v-if',!0)],64))),64))])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 眼中的巨大娘（小人） '),'眼中的巨大娘_格式化'in e.data.calcData?((0,l.openBlock)(),(0,l.createElementBlock)('div',Zc,[a[9]||(a[9]=(0,l.createElementVNode)('div',{class:'gc-detail-section-title'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-eye'}),(0,l.createTextVNode)(' 眼中的巨大娘 ')],-1)),((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(A,n=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:n},[e.data.calcData.眼中的巨大娘_格式化[n]?((0,l.openBlock)(),(0,l.createElementBlock)('div',Xc,[(0,l.createElementVNode)('span',Jc,(0,l.toDisplayString)(n),1),(0,l.createElementVNode)('span',Kc,(0,l.toDisplayString)(e.data.calcData.眼中的巨大娘_格式化[n]),1)])):(0,l.createCommentVNode)('v-if',!0)],64))),64))])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 损害数据插槽 '),(0,l.renderSlot)(n.$slots,'damage',{damageData:e.data.damageData}),(0,l.createCommentVNode)(' 实际损害插槽 '),(0,l.renderSlot)(n.$slots,'actual-damage',{actualDamage:e.data.actualDamage}),(0,l.createCommentVNode)(' 身高历史 '),e.data.history&&e.data.history.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',eo,[a[10]||(a[10]=(0,l.createElementVNode)('div',{class:'gc-detail-section-title'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-clock-rotate-left'}),(0,l.createTextVNode)(' 最近变化 ')],-1)),(0,l.createElementVNode)('div',no,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.data.history.slice(-3).reverse(),(e,n)=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',{key:n,class:'gc-history-item'},[(0,l.createElementVNode)('div',ao,(0,l.toDisplayString)((a=e.time,a?a.includes(' ')?a.split(' ')[1]:a:'')),1),(0,l.createElementVNode)('div',to,[(0,l.createElementVNode)('span',io,(0,l.toDisplayString)(e.heightFormatted),1),e.reason?((0,l.openBlock)(),(0,l.createElementBlock)('span',co,(0,l.toDisplayString)(e.reason),1)):(0,l.createCommentVNode)('v-if',!0)])]);var a}),128))])])):(0,l.createCommentVNode)('v-if',!0)])])):(0,l.createCommentVNode)('v-if',!0)],2))}});o(372);const so=(0,fe.A)(oo,[['__scopeId','data-v-f94d7aac']]),ro={class:'gc-char-list'},lo={key:0,class:'gc-empty'},go={key:0,class:'gc-detail-section full-width gc-damage-section'},Ao={class:'gc-detail-section-title'},po={class:'gc-damage-level-badge'},mo={class:'gc-damage-grid'},Co={class:'gc-damage-item'},uo={class:'gc-damage-item-value'},bo={class:'gc-damage-item'},vo={class:'gc-damage-item-value casualties'},fo={class:'gc-damage-item'},xo={class:'gc-damage-item-value buildings'},ho={key:0,class:'gc-damage-item'},Bo={class:'gc-damage-item-value'},Eo={key:0,class:'gc-macro-damage'},wo={class:'gc-macro-damage-title'},yo={class:'gc-macro-damage-list'},ko={key:0},Vo={key:1},No={key:2},Do={key:3},Fo={key:4},So={key:5},zo={key:1,class:'gc-special-effects'},$o={class:'gc-special-effects-list'},_o={key:0,class:'gc-effect-more'},To={key:0,class:'gc-detail-section full-width gc-actual-damage-section'},jo={class:'gc-actual-damage-grid'},Io={key:0,class:'gc-actual-damage-item'},Wo={class:'gc-actual-damage-item-value casualties'},Mo={key:1,class:'gc-actual-damage-item'},Yo={class:'gc-actual-damage-item-value buildings'},Oo={key:2,class:'gc-actual-damage-item'},Po={class:'gc-actual-damage-item-value cities'},Ro={key:0,class:'gc-last-action'},Uo={class:'gc-last-action-content'},qo={class:'gc-last-action-desc'},Go={key:0,class:'gc-last-action-casualties'},Lo={key:1,class:'gc-major-events'},Ho={class:'gc-major-events-title'},Qo={class:'gc-major-events-list'},Zo={class:'gc-major-event-desc'},Xo={key:0,class:'gc-major-event-casualties'},Jo={key:2,class:'gc-actual-damage-note'},Ko=(0,l.defineComponent)({__name:'CharacterList',props:{characters:{},showDamage:{type:Boolean}},setup(e){const n=(0,l.ref)(null),a=e=>{n.value=n.value===e?null:e},t=e=>e>=1e8?`${(e/1e8).toFixed(1)}亿`:e>=1e4?`${(e/1e4).toFixed(1)}万`:e>=1e3?`${(e/1e3).toFixed(1)}千`:Math.round(e).toString();return(i,c)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',ro,[0===e.characters.size?((0,l.openBlock)(),(0,l.createElementBlock)('div',lo,[...c[0]||(c[0]=[(0,l.createElementVNode)('i',{class:'fa-regular fa-folder-open'},null,-1),(0,l.createElementVNode)('span',null,'暂无角色数据',-1)])])):(0,l.createCommentVNode)('v-if',!0),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.characters,([i,o])=>((0,l.openBlock)(),(0,l.createBlock)(so,{key:i,name:i,data:o,'show-damage':e.showDamage,expanded:n.value===i,onToggle:a},{damage:(0,l.withCtx)(({damageData:n})=>[e.showDamage&&n?((0,l.openBlock)(),(0,l.createElementBlock)('div',go,[(0,l.createElementVNode)('div',Ao,[c[1]||(c[1]=(0,l.createElementVNode)('i',{class:'fa-solid fa-explosion'},null,-1)),c[2]||(c[2]=(0,l.createTextVNode)(' 破坏力数据 ',-1)),(0,l.createElementVNode)('span',po,(0,l.toDisplayString)(n.破坏力等级),1)]),(0,l.createElementVNode)('div',mo,[(0,l.createElementVNode)('div',Co,[c[3]||(c[3]=(0,l.createElementVNode)('div',{class:'gc-damage-item-label'},'足迹面积',-1)),(0,l.createElementVNode)('div',uo,(0,l.toDisplayString)(n.足迹.足迹面积_格式化),1)]),(0,l.createElementVNode)('div',bo,[c[4]||(c[4]=(0,l.createElementVNode)('div',{class:'gc-damage-item-label'},'单步伤亡',-1)),(0,l.createElementVNode)('div',vo,(0,l.toDisplayString)(n.单步损害.小人伤亡.格式化),1)]),(0,l.createElementVNode)('div',fo,[c[5]||(c[5]=(0,l.createElementVNode)('div',{class:'gc-damage-item-label'},'建筑损毁',-1)),(0,l.createElementVNode)('div',xo,(0,l.toDisplayString)(n.单步损害.建筑损毁.格式化),1)]),n.单步损害.城区损毁.数量>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',ho,[c[6]||(c[6]=(0,l.createElementVNode)('div',{class:'gc-damage-item-label'},'城区损毁',-1)),(0,l.createElementVNode)('div',Bo,(0,l.toDisplayString)(n.单步损害.城区损毁.格式化),1)])):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' 宏观破坏 '),n.宏观破坏?((0,l.openBlock)(),(0,l.createElementBlock)('div',Eo,[(0,l.createElementVNode)('div',wo,[c[7]||(c[7]=(0,l.createElementVNode)('i',{class:'fa-solid fa-globe'},null,-1)),(0,l.createTextVNode)(' 宏观破坏力: '+(0,l.toDisplayString)(n.宏观破坏.等级名称),1)]),(0,l.createElementVNode)('div',yo,[n.宏观破坏.城市?((0,l.openBlock)(),(0,l.createElementBlock)('span',ko,(0,l.toDisplayString)(n.宏观破坏.城市.格式化),1)):(0,l.createCommentVNode)('v-if',!0),n.宏观破坏.国家?((0,l.openBlock)(),(0,l.createElementBlock)('span',Vo,(0,l.toDisplayString)(n.宏观破坏.国家.格式化),1)):(0,l.createCommentVNode)('v-if',!0),n.宏观破坏.大陆?((0,l.openBlock)(),(0,l.createElementBlock)('span',No,(0,l.toDisplayString)(n.宏观破坏.大陆.格式化),1)):(0,l.createCommentVNode)('v-if',!0),n.宏观破坏.行星?((0,l.openBlock)(),(0,l.createElementBlock)('span',Do,(0,l.toDisplayString)(n.宏观破坏.行星.格式化),1)):(0,l.createCommentVNode)('v-if',!0),n.宏观破坏.恒星?((0,l.openBlock)(),(0,l.createElementBlock)('span',Fo,(0,l.toDisplayString)(n.宏观破坏.恒星.格式化),1)):(0,l.createCommentVNode)('v-if',!0),n.宏观破坏.星系?((0,l.openBlock)(),(0,l.createElementBlock)('span',So,(0,l.toDisplayString)(n.宏观破坏.星系.格式化),1)):(0,l.createCommentVNode)('v-if',!0)])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 特殊效应 '),n.特殊效应.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',zo,[c[8]||(c[8]=(0,l.createElementVNode)('div',{class:'gc-special-effects-title'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-bolt'}),(0,l.createTextVNode)(' 物理效应 ')],-1)),(0,l.createElementVNode)('div',$o,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(n.特殊效应.slice(0,4),(e,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('span',{key:n,class:'gc-effect-tag'},(0,l.toDisplayString)(e),1))),128)),n.特殊效应.length>4?((0,l.openBlock)(),(0,l.createElementBlock)('span',_o,' +'+(0,l.toDisplayString)(n.特殊效应.length-4)+'更多 ',1)):(0,l.createCommentVNode)('v-if',!0)])])):(0,l.createCommentVNode)('v-if',!0)])):(0,l.createCommentVNode)('v-if',!0)]),'actual-damage':(0,l.withCtx)(({actualDamage:e})=>[e?((0,l.openBlock)(),(0,l.createElementBlock)('div',To,[c[15]||(c[15]=(0,l.createElementVNode)('div',{class:'gc-detail-section-title'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-skull'}),(0,l.createTextVNode)(' 实际损害记录 '),(0,l.createElementVNode)('span',{class:'gc-actual-damage-badge'},'剧情累计')],-1)),(0,l.createElementVNode)('div',jo,[e.总伤亡人数?((0,l.openBlock)(),(0,l.createElementBlock)('div',Io,[c[9]||(c[9]=(0,l.createElementVNode)('div',{class:'gc-actual-damage-item-label'},'累计伤亡',-1)),(0,l.createElementVNode)('div',Wo,(0,l.toDisplayString)(t(e.总伤亡人数))+'人',1)])):(0,l.createCommentVNode)('v-if',!0),e.总建筑损毁?((0,l.openBlock)(),(0,l.createElementBlock)('div',Mo,[c[10]||(c[10]=(0,l.createElementVNode)('div',{class:'gc-actual-damage-item-label'},'建筑损毁',-1)),(0,l.createElementVNode)('div',Yo,(0,l.toDisplayString)(e.总建筑损毁)+'栋',1)])):(0,l.createCommentVNode)('v-if',!0),e.总城市毁灭?((0,l.openBlock)(),(0,l.createElementBlock)('div',Oo,[c[11]||(c[11]=(0,l.createElementVNode)('div',{class:'gc-actual-damage-item-label'},'城市毁灭',-1)),(0,l.createElementVNode)('div',Po,(0,l.toDisplayString)(e.总城市毁灭)+'座',1)])):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' 最近行动 '),e.最近行动?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ro,[c[12]||(c[12]=(0,l.createElementVNode)('div',{class:'gc-last-action-title'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-shoe-prints'}),(0,l.createTextVNode)(' 最近行动 ')],-1)),(0,l.createElementVNode)('div',Uo,[(0,l.createElementVNode)('span',qo,(0,l.toDisplayString)(e.最近行动.描述),1),e.最近行动.伤亡人数?((0,l.openBlock)(),(0,l.createElementBlock)('span',Go,' 伤亡: '+(0,l.toDisplayString)(t(e.最近行动.伤亡人数))+'人 ',1)):(0,l.createCommentVNode)('v-if',!0)])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 重大事件 '),e.重大事件?.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',Lo,[(0,l.createElementVNode)('div',Ho,[c[13]||(c[13]=(0,l.createElementVNode)('i',{class:'fa-solid fa-star'},null,-1)),(0,l.createTextVNode)(' 重大事件 ('+(0,l.toDisplayString)(e.重大事件.length)+') ',1)]),(0,l.createElementVNode)('div',Qo,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.重大事件.slice(-3),(e,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:n,class:'gc-major-event-item'},[(0,l.createElementVNode)('span',Zo,(0,l.toDisplayString)(e.描述),1),e.伤亡人数?((0,l.openBlock)(),(0,l.createElementBlock)('span',Xo,(0,l.toDisplayString)(t(e.伤亡人数))+'人',1)):(0,l.createCommentVNode)('v-if',!0)]))),128))])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 备注 '),e.备注?((0,l.openBlock)(),(0,l.createElementBlock)('div',Jo,[c[14]||(c[14]=(0,l.createElementVNode)('i',{class:'fa-solid fa-comment'},null,-1)),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e.备注),1)])):(0,l.createCommentVNode)('v-if',!0)])):(0,l.createCommentVNode)('v-if',!0)]),_:1},8,['name','data','show-damage','expanded']))),128))]))}});o(928);const es=(0,fe.A)(Ko,[['__scopeId','data-v-142edb12']]),ns={class:'gc-header-actions'},as={key:0,class:'gc-status-badge disabled'},ts={class:'gc-control-bar'},is={class:'gc-master-icon'},cs={class:'gc-action-bar'},os={class:'gc-section'},ss={class:'gc-section-header'},rs={class:'gc-badge-count'},ls=(0,l.defineComponent)({__name:'Panel',setup(e){const n=p(),{settings:t,debugLogs:i}=a(n),{toggle:c,clearDebugLogs:o}=n,d=ue(),{characters:A}=a(d),{refresh:m,recalculateDamage:C,getDamageSummary:u}=d,b=X(),{templates:v}=a(b),{toggleTemplate:f,updateTemplate:x,addTemplate:h,removeTemplate:B,moveTemplate:E,resetToDefaults:w}=b,y=ne(),{worldviews:k,currentWorldviewId:V}=a(y),{setCurrentWorldview:N,addWorldview:D,updateWorldview:F,removeWorldview:S,resetToDefaults:T}=y,j=(0,l.computed)(()=>y.currentWorldview),I=(0,l.ref)(!1),W=(0,l.ref)(!1),M=(0,l.ref)(!1),Y=(0,l.ref)(!1),O=(0,l.ref)(!1),P=(0,l.ref)(!1),R=(0,l.computed)(()=>W.value||M.value||Y.value||O.value||P.value),U=e=>{e.target.closest('.gc-header-actions')||(I.value=!I.value)},q=(e,n)=>{t.value[e]=n},G=(0,l.computed)(()=>u()),L=(0,l.computed)(()=>g.map(e=>({id:e,name:e,density:H(e)})));function H(e){return{荒野:1,乡村:50,郊区:500,小城市:2e3,中等城市:5e3,大城市:1e4,超大城市中心:25e3,东京市中心:15e3,香港:26e3,马尼拉:43e3}[e]||5e3}const Q=e=>{t.value.enableDamageCalculation=e,e?(C(),toastr.success('损害计算已启用')):toastr.info('损害计算已禁用')},Z=e=>{x(e.id,e),toastr.success(`模板 "${e.name}" 已保存`)},J=e=>{h(e),toastr.success(`模板 "${e.name}" 已创建`)},K=(e,n)=>{confirm(`确定要删除模板 "${n}" 吗？`)&&(B(e),toastr.success(`模板 "${n}" 已删除`))},ee=(e,n)=>{e&&n&&confirm(`确定要删除世界观 "${n}" 吗？`)&&(S(e),toastr.success(`世界观 "${n}" 已删除`))},ae=(0,l.ref)(Ae()),te=(0,l.ref)('测试角色'),ie=(0,l.ref)(100),ce=(0,l.ref)(1.65),oe=()=>{ae.value=Ae(),n.debugLog('🔄 已刷新 MVU 状态')},se=(0,l.computed)(()=>Array.from(A.value.values())),re=()=>{if(!te.value)return void toastr.warning('请输入角色名');const e=pe(te.value,ie.value,ce.value);e.success?(toastr.success(`已注入测试数据: ${te.value}`),setTimeout(()=>{oe(),m()},500)):toastr.error(`注入失败: ${e.error}`)},le=e=>{const n=pe(e.name,e.height,e.original);n.success?(toastr.success(`已注入测试数据: ${e.name}`),setTimeout(()=>{oe(),m()},500)):toastr.error(`注入失败: ${n.error}`)},de=e=>{const n=me(e);n.success?(toastr.success(e?`已清除角色: ${e}`:'已清除所有测试数据'),setTimeout(()=>{oe(),m()},300)):toastr.error(`清除失败: ${n.error}`)},ge=e=>{try{const n=t.value.variablePrefix,a=getVariables({type:'message',message_id:'latest'});_.set(a,`stat_data.${n}.${e.name}._实际损害`,e.data),insertOrAssignVariables(a,{type:'message',message_id:'latest'}),toastr.success(`已保存 ${e.name} 的实际损害数据`),setTimeout(()=>{oe(),m()},300)}catch(e){toastr.error(`保存失败: ${e}`)}},Ce=e=>{try{const n=t.value.variablePrefix;deleteVariable(`stat_data.${n}.${e}._实际损害`,{type:'message',message_id:'latest'}),toastr.success(`已清除 ${e} 的实际损害数据`),setTimeout(()=>{oe(),m()},300)}catch(e){toastr.error(`清除失败: ${e}`)}};return(0,l.watch)(Y,e=>{e&&oe()}),(e,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['gc-panel',{collapsed:I.value}])},[(0,l.createCommentVNode)(' 面板头部 '),(0,l.createElementVNode)('div',{class:'gc-header',onClick:U},[n[15]||(n[15]=(0,l.createElementVNode)('div',{class:'gc-header-title'},[(0,l.createElementVNode)('div',{class:'gc-logo-wrapper'},[(0,l.createElementVNode)('i',{class:'fa-solid fa-person-rays gc-logo-icon'})]),(0,l.createElementVNode)('span',null,'巨大娘计算器')],-1)),(0,l.createElementVNode)('div',ns,[(0,l.unref)(t).enabled||I.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',as,'已禁用')),(0,l.createElementVNode)('i',{class:(0,l.normalizeClass)(['fa-solid gc-toggle-icon',I.value?'fa-chevron-right':'fa-chevron-down'])},null,2)])]),(0,l.createCommentVNode)(' 面板内容 '),(0,l.withDirectives)((0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['gc-content',{'has-overlay':R.value}])},[(0,l.createCommentVNode)(' 总开关 '),(0,l.createElementVNode)('div',ts,[(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['gc-btn gc-master-btn',(0,l.unref)(t).enabled?'active':'']),onClick:n[0]||(n[0]=(...e)=>(0,l.unref)(c)&&(0,l.unref)(c)(...e))},[(0,l.createElementVNode)('div',is,[(0,l.createElementVNode)('i',{class:(0,l.normalizeClass)(['fa-solid',(0,l.unref)(t).enabled?'fa-bolt':'fa-power-off'])},null,2)]),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)((0,l.unref)(t).enabled?'脚本已启用':'脚本已禁用'),1),n[16]||(n[16]=(0,l.createElementVNode)('div',{class:'gc-master-status-dot'},null,-1))],2)]),(0,l.createCommentVNode)(' 功能按钮栏 '),(0,l.createElementVNode)('div',cs,[(0,l.createElementVNode)('button',{class:'gc-icon-btn',onClick:n[1]||(n[1]=(...e)=>(0,l.unref)(m)&&(0,l.unref)(m)(...e)),title:'刷新数据'},[...n[17]||(n[17]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-rotate'},null,-1)])]),n[22]||(n[22]=(0,l.createElementVNode)('div',{class:'gc-divider'},null,-1)),(0,l.unref)(t).debug?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:(0,l.normalizeClass)(['gc-icon-btn debug',{active:Y.value}]),onClick:n[2]||(n[2]=e=>Y.value=!Y.value),title:'调试面板'},[...n[18]||(n[18]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-bug'},null,-1)])],2)):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['gc-icon-btn prompt',{active:O.value}]),onClick:n[3]||(n[3]=e=>O.value=!O.value),title:'提示词管理'},[...n[19]||(n[19]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-file-lines'},null,-1)])],2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['gc-icon-btn worldview',{active:P.value}]),onClick:n[4]||(n[4]=e=>P.value=!P.value),title:'世界观设定'},[(0,l.createElementVNode)('i',{class:(0,l.normalizeClass)(j.value?.icon||'fa-solid fa-globe')},null,2)],2),n[23]||(n[23]=(0,l.createElementVNode)('div',{class:'gc-divider'},null,-1)),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['gc-icon-btn',{active:W.value}]),onClick:n[5]||(n[5]=e=>W.value=!W.value),title:'设置'},[...n[20]||(n[20]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-gear'},null,-1)])],2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['gc-icon-btn',{active:M.value}]),onClick:n[6]||(n[6]=e=>M.value=!M.value),title:'帮助'},[...n[21]||(n[21]=[(0,l.createElementVNode)('i',{class:'fa-regular fa-circle-question'},null,-1)])],2)]),(0,l.createCommentVNode)(' 设置面板 '),(0,l.createVNode)((0,l.unref)(Ge),{visible:W.value,settings:(0,l.unref)(t),onClose:n[7]||(n[7]=e=>W.value=!1),'onUpdate:setting':q},null,8,['visible','settings']),(0,l.createCommentVNode)(' 帮助面板 '),(0,l.createVNode)((0,l.unref)(Xe),{visible:M.value,version:(0,l.unref)(s),changelog:(0,l.unref)(r),onClose:n[8]||(n[8]=e=>M.value=!1)},null,8,['visible','version','changelog']),(0,l.createCommentVNode)(' 世界观面板 '),(0,l.createVNode)((0,l.unref)(jn),{visible:P.value,worldviews:(0,l.unref)(k),'current-worldview':j.value,'current-worldview-id':(0,l.unref)(V),settings:(0,l.unref)(t),onClose:n[9]||(n[9]=e=>P.value=!1),onSelect:(0,l.unref)(N),onReset:(0,l.unref)(T),'onUpdate:setting':q,onCreate:(0,l.unref)(D),onUpdate:(0,l.unref)(F),onDelete:ee},null,8,['visible','worldviews','current-worldview','current-worldview-id','settings','onSelect','onReset','onCreate','onUpdate']),(0,l.createCommentVNode)(' 提示词面板 '),(0,l.createVNode)((0,l.unref)(ma),{visible:O.value,templates:(0,l.unref)(v),onClose:n[10]||(n[10]=e=>O.value=!1),onToggle:(0,l.unref)(f),onMove:(0,l.unref)(E),onDelete:K,onCreate:J,onSave:Z,onReset:(0,l.unref)(w)},null,8,['visible','templates','onToggle','onMove','onReset']),(0,l.createCommentVNode)(' 调试面板 '),(0,l.unref)(t).debug?((0,l.openBlock)(),(0,l.createBlock)((0,l.unref)(zi),{key:0,visible:Y.value,'mvu-info':ae.value,logs:(0,l.unref)(i),settings:(0,l.unref)(t),characters:se.value,'test-name':te.value,'test-height':ie.value,'test-original':ce.value,onClose:n[11]||(n[11]=e=>Y.value=!1),onRefresh:oe,onClearLogs:(0,l.unref)(o),'onUpdate:testName':n[12]||(n[12]=e=>te.value=e),'onUpdate:testHeight':n[13]||(n[13]=e=>ie.value=e),'onUpdate:testOriginal':n[14]||(n[14]=e=>ce.value=e),onInjectTest:re,onClearTest:de,onQuickTest:le,onSaveDamage:ge,onClearDamage:Ce},null,8,['visible','mvu-info','logs','settings','characters','test-name','test-height','test-original','onClearLogs'])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 主要内容区 '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['gc-main-area',{disabled:!(0,l.unref)(t).enabled}])},[(0,l.createCommentVNode)(' 快速计算器 '),(0,l.createVNode)(Bc),(0,l.createCommentVNode)(' 角色列表 '),(0,l.createElementVNode)('div',os,[(0,l.createElementVNode)('div',ss,[n[24]||(n[24]=(0,l.createElementVNode)('span',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-users'}),(0,l.createTextVNode)(' 角色列表')],-1)),(0,l.createElementVNode)('span',rs,(0,l.toDisplayString)((0,l.unref)(A).size),1)]),(0,l.createVNode)(es,{characters:(0,l.unref)(A),'show-damage':(0,l.unref)(t).enableDamageCalculation},null,8,['characters','show-damage'])]),(0,l.createCommentVNode)(' 扩展计算系统 '),(0,l.createVNode)((0,l.unref)(cc),{settings:(0,l.unref)(t),'damage-summary':G.value,'damage-scenarios':L.value,onToggleDamage:Q,'onUpdate:setting':q},null,8,['settings','damage-summary','damage-scenarios'])],2)],2),[[l.vShow,!I.value]])],2))}});o(374);const ds=(0,fe.A)(ls,[['__scopeId','data-v-2fd76fdc']]);$(()=>{const n=e(),a=(0,l.createApp)(ds).use(n),t=$('<div>').attr('script_id',getScriptId()).appendTo('#extensions_settings2');a.mount(t[0]),re(),function(){const e=p();if(e.debugLog('🚀 开始初始化 MVU 集成...'),'undefined'!=typeof Mvu){e.debugLog('✅ MVU 全局对象已找到:',{version:Mvu.version||'未知',events:Object.keys(Mvu.events||{})});try{eventOn(Mvu.events.VARIABLE_UPDATE_ENDED,le),e.debugLog('✅ 已监听 MVU 变量更新事件 (VARIABLE_UPDATE_ENDED)')}catch(n){e.debugError('❌ 监听 MVU 事件失败:',n)}}else e.debugWarn('⚠️ MVU 全局对象未找到')}(),function(){const e=p(),n={calculate:V,calculateTiny:N,checkInteraction:(e,n)=>F(e,n,B),formatLength:B,formatWeight:E,formatVolume:w,determineLevel:k,BASE_BODY_PARTS:C,REFERENCE_OBJECTS:u,SIZE_LEVELS:v,INTERACTION_RULES:D,VERSION:s,get CONFIG(){return e.settings},debug:{getMvuInfo:Ae,injectTestData:pe,clearTestData:me,get logs(){return e.debugLogs},clearLogs:()=>e.clearDebugLogs()}};window.GiantessCalc=n}();const{destroy:i}=function(e='head'){const n=$('<div>').attr('script_id',getScriptId()).append($('head > style',document).clone()).appendTo(e);return{destroy:()=>n.remove()}}();$(window).on('pagehide',()=>{a.unmount(),t.remove(),i()})});
//# sourceMappingURL=index.js.map